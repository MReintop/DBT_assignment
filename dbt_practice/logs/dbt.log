2021-10-04 16:58:14.045453 (MainThread): Running with dbt=0.19.0
2021-10-04 16:58:14.163005 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 16:58:14.169906 (MainThread): Tracking: tracking
2021-10-04 16:58:14.173100 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb6d748e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eba3763a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb6d87070>]}
2021-10-04 16:58:14.200129 (MainThread): Partial parsing not enabled
2021-10-04 16:58:14.203598 (MainThread): Parsing macros/adapters.sql
2021-10-04 16:58:14.236204 (MainThread): Parsing macros/catalog.sql
2021-10-04 16:58:14.242910 (MainThread): Parsing macros/relations.sql
2021-10-04 16:58:14.246345 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 16:58:14.250957 (MainThread): Parsing macros/core.sql
2021-10-04 16:58:14.257199 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 16:58:14.273383 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 16:58:14.286037 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 16:58:14.319893 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 16:58:14.330742 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 16:58:14.338671 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 16:58:14.361241 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 16:58:14.370530 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 16:58:14.374155 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 16:58:14.399440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 16:58:14.403820 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 16:58:14.456352 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 16:58:14.526800 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 16:58:14.530345 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 16:58:14.533838 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 16:58:14.536693 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 16:58:14.541357 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 16:58:14.544586 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 16:58:14.546836 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 16:58:14.550046 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 16:58:14.564395 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 16:58:14.567970 (MainThread): Parsing macros/etc/query.sql
2021-10-04 16:58:14.577432 (MainThread): Partial parsing not enabled
2021-10-04 16:58:14.622190 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:14.776701 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-04 16:58:14.779240 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c8859cc-9586-4afa-959e-8924ec82b6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb6c1b6d0>]}
2021-10-04 16:58:14.822135 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 16:58:14.823612 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-04 16:58:14.825367 (MainThread): 
2021-10-04 16:58:14.826773 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:58:14.829437 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-04 16:58:14.844457 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-04 16:58:14.845922 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-04 16:58:14.846902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 16:58:14.852812 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-04 16:58:14.859617 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-04 16:58:14.863507 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-04 16:58:14.871635 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 16:58:14.872688 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-04 16:58:14.873571 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-04 16:58:14.877892 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:58:14.879034 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 16:58:14.880072 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 16:58:14.883186 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-10-04 16:58:14.887091 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-04 16:58:14.888307 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-04 16:58:14.894640 (MainThread): Using postgres connection "master".
2021-10-04 16:58:14.895791 (MainThread): On master: BEGIN
2021-10-04 16:58:14.896621 (MainThread): Opening a new connection, currently in state init
2021-10-04 16:58:14.900721 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:58:14.901930 (MainThread): Using postgres connection "master".
2021-10-04 16:58:14.902992 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 16:58:14.910051 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-04 16:58:14.911464 (MainThread): On master: ROLLBACK
2021-10-04 16:58:14.912610 (MainThread): Using postgres connection "master".
2021-10-04 16:58:14.913370 (MainThread): On master: BEGIN
2021-10-04 16:58:14.914491 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:58:14.915242 (MainThread): On master: COMMIT
2021-10-04 16:58:14.916025 (MainThread): Using postgres connection "master".
2021-10-04 16:58:14.916763 (MainThread): On master: COMMIT
2021-10-04 16:58:14.917827 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:58:14.918685 (MainThread): On master: Close
2021-10-04 16:58:14.919846 (MainThread): 16:58:14 | Concurrency: 2 threads (target='dev')
2021-10-04 16:58:14.920840 (MainThread): 16:58:14 | 
2021-10-04 16:58:14.929290 (Thread-1): Began running node model.my_new_project.languagespeakers
2021-10-04 16:58:14.931401 (Thread-1): 16:58:14 | 1 of 1 START view model public.languagespeakers...................... [RUN]
2021-10-04 16:58:14.932739 (Thread-1): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:14.933848 (Thread-1): Compiling model.my_new_project.languagespeakers
2021-10-04 16:58:14.951697 (Thread-1): Writing injected SQL for node "model.my_new_project.languagespeakers"
2021-10-04 16:58:14.961808 (Thread-1): finished collecting timing info
2021-10-04 16:58:14.990710 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:14.992106 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_tmp" cascade
2021-10-04 16:58:14.993089 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 16:58:14.997537 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:58:15.000994 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:15.002044 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-04 16:58:15.003185 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:58:15.008551 (Thread-1): Writing runtime SQL for node "model.my_new_project.languagespeakers"
2021-10-04 16:58:15.017795 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:15.018635 (Thread-1): On model.my_new_project.languagespeakers: BEGIN
2021-10-04 16:58:15.019889 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:58:15.020821 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:15.021898 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */

  create view "world"."public"."languagespeakers__dbt_tmp" as (
    SELECT cl.language, ROUND(sum(co.population*cl.percentage/100)::decimal, 0) as speakers FROM (
SELECT code, population FROM country
	) co JOIN (
SELECT countrycode, language, percentage FROM countrylanguage ) cl
ON co.code = cl.countrycode
GROUP BY cl.language
ORDER BY speakers desc
  );

2021-10-04 16:58:15.025596 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-04 16:58:15.032512 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:15.033606 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers__dbt_tmp" rename to "languagespeakers"
2021-10-04 16:58:15.035014 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:58:15.043930 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-04 16:58:15.044940 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:15.045941 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-04 16:58:15.049368 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:58:15.053516 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 16:58:15.054441 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-04 16:58:15.055595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:58:15.058860 (Thread-1): finished collecting timing info
2021-10-04 16:58:15.060040 (Thread-1): On model.my_new_project.languagespeakers: Close
2021-10-04 16:58:15.061945 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c8859cc-9586-4afa-959e-8924ec82b6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb61bad30>]}
2021-10-04 16:58:15.064630 (Thread-1): 16:58:15 | 1 of 1 OK created view model public.languagespeakers................. [CREATE VIEW in 0.13s]
2021-10-04 16:58:15.065917 (Thread-1): Finished running node model.my_new_project.languagespeakers
2021-10-04 16:58:15.068707 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:58:15.069788 (MainThread): Using postgres connection "master".
2021-10-04 16:58:15.070702 (MainThread): On master: BEGIN
2021-10-04 16:58:15.071506 (MainThread): Opening a new connection, currently in state closed
2021-10-04 16:58:15.075794 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:58:15.076948 (MainThread): On master: COMMIT
2021-10-04 16:58:15.077859 (MainThread): Using postgres connection "master".
2021-10-04 16:58:15.078865 (MainThread): On master: COMMIT
2021-10-04 16:58:15.079936 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:58:15.080808 (MainThread): On master: Close
2021-10-04 16:58:15.082257 (MainThread): 16:58:15 | 
2021-10-04 16:58:15.083268 (MainThread): 16:58:15 | Finished running 1 view model in 0.26s.
2021-10-04 16:58:15.084159 (MainThread): Connection 'master' was properly closed.
2021-10-04 16:58:15.085020 (MainThread): Connection 'list_world' was properly closed.
2021-10-04 16:58:15.085998 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 16:58:15.121066 (MainThread): 
2021-10-04 16:58:15.122110 (MainThread): Completed successfully
2021-10-04 16:58:15.123090 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-04 16:58:15.124178 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb6c26940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb61e84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb61e8490>]}
2021-10-04 16:58:15.125857 (MainThread): Flushing usage events
2021-10-04 17:27:35.912051 (MainThread): Running with dbt=0.19.0
2021-10-04 17:27:36.043637 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:27:36.048694 (MainThread): Tracking: tracking
2021-10-04 17:27:36.052379 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebc65fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebfc65400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebc6700d0>]}
2021-10-04 17:27:36.078855 (MainThread): Partial parsing not enabled
2021-10-04 17:27:36.080946 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:27:36.113264 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:27:36.118325 (MainThread): Parsing macros/relations.sql
2021-10-04 17:27:36.121654 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:27:36.126088 (MainThread): Parsing macros/core.sql
2021-10-04 17:27:36.134180 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:27:36.148177 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:27:36.159824 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:27:36.192808 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:27:36.202765 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:27:36.210541 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:27:36.233739 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:27:36.243390 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:27:36.247037 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:27:36.272735 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:27:36.276490 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:27:36.330542 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:27:36.402249 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:27:36.406578 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:27:36.410509 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:27:36.413436 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:27:36.419518 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:27:36.423379 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:27:36.426090 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:27:36.429670 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:27:36.447258 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:27:36.452947 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:27:36.464756 (MainThread): Partial parsing not enabled
2021-10-04 17:27:36.514711 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:27:36.668194 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-04 17:27:36.671861 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45d5e41d-d7cb-405f-a233-8d558ea77479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebc42af10>]}
2021-10-04 17:27:36.708476 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 17:27:36.710022 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-04 17:27:36.712073 (MainThread): 
2021-10-04 17:27:36.713600 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:27:36.716888 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-04 17:27:36.729433 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-04 17:27:36.730996 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-04 17:27:36.732067 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 17:27:36.737607 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-04 17:27:36.740925 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-04 17:27:36.744222 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-04 17:27:36.751943 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:27:36.753240 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-04 17:27:36.754148 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 17:27:36.758268 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:27:36.759524 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:27:36.760570 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 17:27:36.764104 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-10-04 17:27:36.770284 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-04 17:27:36.772017 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-04 17:27:36.778894 (MainThread): Using postgres connection "master".
2021-10-04 17:27:36.780112 (MainThread): On master: BEGIN
2021-10-04 17:27:36.781225 (MainThread): Opening a new connection, currently in state init
2021-10-04 17:27:36.786821 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 17:27:36.787977 (MainThread): Using postgres connection "master".
2021-10-04 17:27:36.789014 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 17:27:36.796122 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-04 17:27:36.800525 (MainThread): On master: ROLLBACK
2021-10-04 17:27:36.801788 (MainThread): Using postgres connection "master".
2021-10-04 17:27:36.802872 (MainThread): On master: BEGIN
2021-10-04 17:27:36.804382 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:27:36.805421 (MainThread): On master: COMMIT
2021-10-04 17:27:36.806379 (MainThread): Using postgres connection "master".
2021-10-04 17:27:36.807344 (MainThread): On master: COMMIT
2021-10-04 17:27:36.808513 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:27:36.809410 (MainThread): On master: Close
2021-10-04 17:27:36.810645 (MainThread): 17:27:36 | Concurrency: 2 threads (target='dev')
2021-10-04 17:27:36.811607 (MainThread): 17:27:36 | 
2021-10-04 17:27:36.816360 (Thread-1): Began running node model.my_new_project.languagespeakers
2021-10-04 17:27:36.818906 (Thread-1): 17:27:36 | 1 of 1 START view model public.languagespeakers...................... [RUN]
2021-10-04 17:27:36.820466 (Thread-1): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:27:36.821631 (Thread-1): Compiling model.my_new_project.languagespeakers
2021-10-04 17:27:36.839489 (Thread-1): Writing injected SQL for node "model.my_new_project.languagespeakers"
2021-10-04 17:27:36.843412 (Thread-1): finished collecting timing info
2021-10-04 17:27:36.880270 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:27:36.882231 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_tmp" cascade
2021-10-04 17:27:36.884359 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 17:27:36.890655 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-04 17:27:36.895461 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:27:36.897029 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-04 17:27:36.898896 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 17:27:36.906009 (Thread-1): Writing runtime SQL for node "model.my_new_project.languagespeakers"
2021-10-04 17:27:36.911061 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:27:36.912450 (Thread-1): On model.my_new_project.languagespeakers: BEGIN
2021-10-04 17:27:36.914046 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:27:36.915478 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:27:36.918244 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */

  create view "world"."public"."languagespeakers__dbt_tmp" as (
    SELECT RANK() OVER(ORDER BY speakers) as ranking,
language,
amount
FROM(
SELECT cl.language, ROUND(sum(co.population*cl.percentage/100)::decimal, 0) as speakers FROM (
SELECT code, population FROM country
	) co JOIN (
SELECT countrycode, language, percentage FROM countrylanguage ) cl
ON co.code = cl.countrycode
GROUP BY cl.language) T
ORDER BY speakers desc
  );

2021-10-04 17:27:36.921115 (Thread-1): Postgres error: column "amount" does not exist
LINE 6: amount
        ^

2021-10-04 17:27:36.922433 (Thread-1): On model.my_new_project.languagespeakers: ROLLBACK
2021-10-04 17:27:36.923935 (Thread-1): finished collecting timing info
2021-10-04 17:27:36.925337 (Thread-1): On model.my_new_project.languagespeakers: Close
2021-10-04 17:27:36.926788 (Thread-1): Database Error in model languagespeakers (models/languagespeakers.sql)
  column "amount" does not exist
  LINE 6: amount
          ^
  compiled SQL at target/run/my_new_project/models/languagespeakers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "amount" does not exist
LINE 6: amount
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model languagespeakers (models/languagespeakers.sql)
  column "amount" does not exist
  LINE 6: amount
          ^
  compiled SQL at target/run/my_new_project/models/languagespeakers.sql
2021-10-04 17:27:36.930437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d5e41d-d7cb-405f-a233-8d558ea77479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebc4bb790>]}
2021-10-04 17:27:36.933038 (Thread-1): 17:27:36 | 1 of 1 ERROR creating view model public.languagespeakers............. [ERROR in 0.11s]
2021-10-04 17:27:36.934316 (Thread-1): Finished running node model.my_new_project.languagespeakers
2021-10-04 17:27:36.938620 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:27:36.940328 (MainThread): Using postgres connection "master".
2021-10-04 17:27:36.941798 (MainThread): On master: BEGIN
2021-10-04 17:27:36.943194 (MainThread): Opening a new connection, currently in state closed
2021-10-04 17:27:36.949443 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 17:27:36.951486 (MainThread): On master: COMMIT
2021-10-04 17:27:36.953178 (MainThread): Using postgres connection "master".
2021-10-04 17:27:36.954909 (MainThread): On master: COMMIT
2021-10-04 17:27:36.957098 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:27:36.958567 (MainThread): On master: Close
2021-10-04 17:27:36.960365 (MainThread): 17:27:36 | 
2021-10-04 17:27:36.961577 (MainThread): 17:27:36 | Finished running 1 view model in 0.25s.
2021-10-04 17:27:36.962874 (MainThread): Connection 'master' was properly closed.
2021-10-04 17:27:36.964110 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:27:37.001163 (MainThread): 
2021-10-04 17:27:37.002178 (MainThread): Completed with 1 error and 0 warnings:
2021-10-04 17:27:37.003425 (MainThread): 
2021-10-04 17:27:37.004612 (MainThread): Database Error in model languagespeakers (models/languagespeakers.sql)
2021-10-04 17:27:37.005841 (MainThread):   column "amount" does not exist
2021-10-04 17:27:37.006931 (MainThread):   LINE 6: amount
2021-10-04 17:27:37.008205 (MainThread):           ^
2021-10-04 17:27:37.009308 (MainThread):   compiled SQL at target/run/my_new_project/models/languagespeakers.sql
2021-10-04 17:27:37.010397 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-04 17:27:37.011570 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebc4319a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebbbaef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ebbbaedc0>]}
2021-10-04 17:27:37.012573 (MainThread): Flushing usage events
2021-10-04 17:28:00.922308 (MainThread): Running with dbt=0.19.0
2021-10-04 17:28:01.038091 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:28:01.043150 (MainThread): Tracking: tracking
2021-10-04 17:28:01.046262 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea16afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ed7703a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea17b070>]}
2021-10-04 17:28:01.072218 (MainThread): Partial parsing not enabled
2021-10-04 17:28:01.074305 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:28:01.105803 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:28:01.110521 (MainThread): Parsing macros/relations.sql
2021-10-04 17:28:01.113448 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:28:01.117478 (MainThread): Parsing macros/core.sql
2021-10-04 17:28:01.123406 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:28:01.136923 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:28:01.147539 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:28:01.178966 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:28:01.188803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:28:01.196524 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:28:01.219190 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:28:01.228349 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:28:01.231735 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:28:01.256523 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:28:01.259989 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:28:01.310961 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:28:01.380648 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:28:01.383966 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:28:01.387280 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:28:01.390116 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:28:01.394599 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:28:01.397571 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:28:01.399762 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:28:01.402946 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:28:01.416496 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:28:01.419948 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:28:01.429943 (MainThread): Partial parsing not enabled
2021-10-04 17:28:01.478703 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.631114 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-04 17:28:01.633290 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39695d81-a28c-4600-865d-9c0f9a8fcf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e9f35fd0>]}
2021-10-04 17:28:01.665839 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 17:28:01.667227 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-04 17:28:01.669305 (MainThread): 
2021-10-04 17:28:01.670699 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:28:01.673169 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-04 17:28:01.684794 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-04 17:28:01.689053 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-04 17:28:01.690012 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 17:28:01.694985 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-04 17:28:01.698242 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-04 17:28:01.701793 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-04 17:28:01.709305 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:28:01.710300 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-04 17:28:01.711268 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 17:28:01.715387 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:28:01.716323 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:28:01.717282 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 17:28:01.720086 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-10-04 17:28:01.724981 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-04 17:28:01.726478 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-04 17:28:01.732975 (MainThread): Using postgres connection "master".
2021-10-04 17:28:01.734213 (MainThread): On master: BEGIN
2021-10-04 17:28:01.735423 (MainThread): Opening a new connection, currently in state init
2021-10-04 17:28:01.739599 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:28:01.740612 (MainThread): Using postgres connection "master".
2021-10-04 17:28:01.741573 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 17:28:01.747375 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2021-10-04 17:28:01.751254 (MainThread): On master: ROLLBACK
2021-10-04 17:28:01.752400 (MainThread): Using postgres connection "master".
2021-10-04 17:28:01.753306 (MainThread): On master: BEGIN
2021-10-04 17:28:01.754767 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:28:01.755603 (MainThread): On master: COMMIT
2021-10-04 17:28:01.756396 (MainThread): Using postgres connection "master".
2021-10-04 17:28:01.757216 (MainThread): On master: COMMIT
2021-10-04 17:28:01.758187 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:28:01.758961 (MainThread): On master: Close
2021-10-04 17:28:01.760070 (MainThread): 17:28:01 | Concurrency: 2 threads (target='dev')
2021-10-04 17:28:01.761122 (MainThread): 17:28:01 | 
2021-10-04 17:28:01.764924 (Thread-1): Began running node model.my_new_project.languagespeakers
2021-10-04 17:28:01.767525 (Thread-1): 17:28:01 | 1 of 1 START view model public.languagespeakers...................... [RUN]
2021-10-04 17:28:01.769142 (Thread-1): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.770106 (Thread-1): Compiling model.my_new_project.languagespeakers
2021-10-04 17:28:01.787327 (Thread-1): Writing injected SQL for node "model.my_new_project.languagespeakers"
2021-10-04 17:28:01.791074 (Thread-1): finished collecting timing info
2021-10-04 17:28:01.820585 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.821869 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_tmp" cascade
2021-10-04 17:28:01.823009 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 17:28:01.827257 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 17:28:01.830580 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.831462 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-04 17:28:01.832520 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 17:28:01.837884 (Thread-1): Writing runtime SQL for node "model.my_new_project.languagespeakers"
2021-10-04 17:28:01.841005 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.842272 (Thread-1): On model.my_new_project.languagespeakers: BEGIN
2021-10-04 17:28:01.846345 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:28:01.847698 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.848969 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */

  create view "world"."public"."languagespeakers__dbt_tmp" as (
    SELECT RANK() OVER(ORDER BY speakers) as ranking,
language,
speakers
FROM(
SELECT cl.language, ROUND(sum(co.population*cl.percentage/100)::decimal, 0) as speakers FROM (
SELECT code, population FROM country
	) co JOIN (
SELECT countrycode, language, percentage FROM countrylanguage ) cl
ON co.code = cl.countrycode
GROUP BY cl.language) T
ORDER BY speakers desc
  );

2021-10-04 17:28:01.853444 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-04 17:28:01.862862 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.864439 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers" rename to "languagespeakers__dbt_backup"
2021-10-04 17:28:01.866428 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 17:28:01.870696 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.872001 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers__dbt_tmp" rename to "languagespeakers"
2021-10-04 17:28:01.873792 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 17:28:01.883638 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-04 17:28:01.885096 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.886179 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-04 17:28:01.887953 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:28:01.892690 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:28:01.894020 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-04 17:28:01.896460 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 17:28:01.900653 (Thread-1): finished collecting timing info
2021-10-04 17:28:01.902058 (Thread-1): On model.my_new_project.languagespeakers: Close
2021-10-04 17:28:01.903736 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39695d81-a28c-4600-865d-9c0f9a8fcf80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e9f41e50>]}
2021-10-04 17:28:01.905864 (Thread-1): 17:28:01 | 1 of 1 OK created view model public.languagespeakers................. [CREATE VIEW in 0.13s]
2021-10-04 17:28:01.907166 (Thread-1): Finished running node model.my_new_project.languagespeakers
2021-10-04 17:28:01.910039 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:28:01.911218 (MainThread): Using postgres connection "master".
2021-10-04 17:28:01.912251 (MainThread): On master: BEGIN
2021-10-04 17:28:01.913332 (MainThread): Opening a new connection, currently in state closed
2021-10-04 17:28:01.917756 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:28:01.919029 (MainThread): On master: COMMIT
2021-10-04 17:28:01.920003 (MainThread): Using postgres connection "master".
2021-10-04 17:28:01.920940 (MainThread): On master: COMMIT
2021-10-04 17:28:01.922148 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:28:01.923054 (MainThread): On master: Close
2021-10-04 17:28:01.924755 (MainThread): 17:28:01 | 
2021-10-04 17:28:01.925855 (MainThread): 17:28:01 | Finished running 1 view model in 0.25s.
2021-10-04 17:28:01.926978 (MainThread): Connection 'master' was properly closed.
2021-10-04 17:28:01.928268 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:28:01.962192 (MainThread): 
2021-10-04 17:28:01.963260 (MainThread): Completed successfully
2021-10-04 17:28:01.964302 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-04 17:28:01.965586 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e865bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea044eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea03b6a0>]}
2021-10-04 17:28:01.966599 (MainThread): Flushing usage events
2021-10-04 17:29:54.016271 (MainThread): Running with dbt=0.19.0
2021-10-04 17:29:54.132904 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:29:54.137436 (MainThread): Tracking: tracking
2021-10-04 17:29:54.140823 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5454e8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe548aef460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5454f9130>]}
2021-10-04 17:29:54.166711 (MainThread): Partial parsing not enabled
2021-10-04 17:29:54.168718 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:29:54.200950 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:29:54.205541 (MainThread): Parsing macros/relations.sql
2021-10-04 17:29:54.209311 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:29:54.213828 (MainThread): Parsing macros/core.sql
2021-10-04 17:29:54.220024 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:29:54.234046 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:29:54.245113 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:29:54.277973 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:29:54.288222 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:29:54.296018 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:29:54.319406 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:29:54.328996 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:29:54.332810 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:29:54.358551 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:29:54.362252 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:29:54.414438 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:29:54.485164 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:29:54.488688 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:29:54.492138 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:29:54.494970 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:29:54.499385 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:29:54.502387 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:29:54.504669 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:29:54.508361 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:29:54.522674 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:29:54.526518 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:29:54.537441 (MainThread): Partial parsing not enabled
2021-10-04 17:29:54.586566 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.733726 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-04 17:29:54.736226 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2326e492-15b4-40e4-bb3f-11b0d0b76c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5452b3f70>]}
2021-10-04 17:29:54.773145 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 17:29:54.775403 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-04 17:29:54.777516 (MainThread): 
2021-10-04 17:29:54.779069 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:29:54.781821 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-04 17:29:54.793561 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-04 17:29:54.794884 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-04 17:29:54.796070 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 17:29:54.801351 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-04 17:29:54.804679 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-04 17:29:54.808646 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-04 17:29:54.816511 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:29:54.817799 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-04 17:29:54.819037 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 17:29:54.823175 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:29:54.824350 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:29:54.825273 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 17:29:54.828141 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-10-04 17:29:54.833059 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-04 17:29:54.834293 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-04 17:29:54.844219 (MainThread): Using postgres connection "master".
2021-10-04 17:29:54.845633 (MainThread): On master: BEGIN
2021-10-04 17:29:54.846875 (MainThread): Opening a new connection, currently in state init
2021-10-04 17:29:54.851674 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:29:54.853121 (MainThread): Using postgres connection "master".
2021-10-04 17:29:54.854210 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 17:29:54.860852 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2021-10-04 17:29:54.865634 (MainThread): On master: ROLLBACK
2021-10-04 17:29:54.867234 (MainThread): Using postgres connection "master".
2021-10-04 17:29:54.868437 (MainThread): On master: BEGIN
2021-10-04 17:29:54.869842 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:29:54.870854 (MainThread): On master: COMMIT
2021-10-04 17:29:54.871789 (MainThread): Using postgres connection "master".
2021-10-04 17:29:54.872722 (MainThread): On master: COMMIT
2021-10-04 17:29:54.874090 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:29:54.875341 (MainThread): On master: Close
2021-10-04 17:29:54.877170 (MainThread): 17:29:54 | Concurrency: 2 threads (target='dev')
2021-10-04 17:29:54.878926 (MainThread): 17:29:54 | 
2021-10-04 17:29:54.882888 (Thread-1): Began running node model.my_new_project.languagespeakers
2021-10-04 17:29:54.884988 (Thread-1): 17:29:54 | 1 of 1 START view model public.languagespeakers...................... [RUN]
2021-10-04 17:29:54.886326 (Thread-1): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.887398 (Thread-1): Compiling model.my_new_project.languagespeakers
2021-10-04 17:29:54.904316 (Thread-1): Writing injected SQL for node "model.my_new_project.languagespeakers"
2021-10-04 17:29:54.908863 (Thread-1): finished collecting timing info
2021-10-04 17:29:54.939863 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.941771 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_tmp" cascade
2021-10-04 17:29:54.942824 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 17:29:54.947408 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 17:29:54.951009 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.951936 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-04 17:29:54.953541 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 17:29:54.958923 (Thread-1): Writing runtime SQL for node "model.my_new_project.languagespeakers"
2021-10-04 17:29:54.961971 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.962929 (Thread-1): On model.my_new_project.languagespeakers: BEGIN
2021-10-04 17:29:54.964126 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:29:54.965016 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.965912 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */

  create view "world"."public"."languagespeakers__dbt_tmp" as (
    SELECT RANK() OVER(ORDER BY speakers desc) as ranking,
language,
speakers
FROM(
SELECT cl.language, ROUND(sum(co.population*cl.percentage/100)::decimal, 0) as speakers FROM (
SELECT code, population FROM country
	) co JOIN (
SELECT countrycode, language, percentage FROM countrylanguage ) cl
ON co.code = cl.countrycode
GROUP BY cl.language) T
ORDER BY speakers desc
  );

2021-10-04 17:29:54.968856 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-04 17:29:54.978192 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.979494 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers" rename to "languagespeakers__dbt_backup"
2021-10-04 17:29:54.981002 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 17:29:54.985139 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.986170 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers__dbt_tmp" rename to "languagespeakers"
2021-10-04 17:29:54.987622 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 17:29:54.995610 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-04 17:29:54.996534 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:54.997584 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-04 17:29:54.999957 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:29:55.004291 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:29:55.005470 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-04 17:29:55.007741 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 17:29:55.011423 (Thread-1): finished collecting timing info
2021-10-04 17:29:55.012541 (Thread-1): On model.my_new_project.languagespeakers: Close
2021-10-04 17:29:55.013966 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2326e492-15b4-40e4-bb3f-11b0d0b76c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe545345580>]}
2021-10-04 17:29:55.016051 (Thread-1): 17:29:55 | 1 of 1 OK created view model public.languagespeakers................. [CREATE VIEW in 0.13s]
2021-10-04 17:29:55.017146 (Thread-1): Finished running node model.my_new_project.languagespeakers
2021-10-04 17:29:55.019565 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:29:55.020675 (MainThread): Using postgres connection "master".
2021-10-04 17:29:55.021539 (MainThread): On master: BEGIN
2021-10-04 17:29:55.022752 (MainThread): Opening a new connection, currently in state closed
2021-10-04 17:29:55.026538 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:29:55.027768 (MainThread): On master: COMMIT
2021-10-04 17:29:55.028744 (MainThread): Using postgres connection "master".
2021-10-04 17:29:55.029743 (MainThread): On master: COMMIT
2021-10-04 17:29:55.030829 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:29:55.031891 (MainThread): On master: Close
2021-10-04 17:29:55.033990 (MainThread): 17:29:55 | 
2021-10-04 17:29:55.035073 (MainThread): 17:29:55 | Finished running 1 view model in 0.26s.
2021-10-04 17:29:55.036322 (MainThread): Connection 'master' was properly closed.
2021-10-04 17:29:55.037297 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:29:55.069623 (MainThread): 
2021-10-04 17:29:55.070542 (MainThread): Completed successfully
2021-10-04 17:29:55.071642 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-04 17:29:55.072784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5452baa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5453e68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5453e61c0>]}
2021-10-04 17:29:55.074255 (MainThread): Flushing usage events
2021-10-04 17:34:13.287434 (MainThread): Running with dbt=0.19.0
2021-10-04 17:34:13.410340 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:34:13.415655 (MainThread): Tracking: tracking
2021-10-04 17:34:13.418954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c6cf940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0fcd6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c6e2130>]}
2021-10-04 17:34:13.447004 (MainThread): Partial parsing not enabled
2021-10-04 17:34:13.449471 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:34:13.484076 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:34:13.488703 (MainThread): Parsing macros/relations.sql
2021-10-04 17:34:13.491777 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:34:13.496050 (MainThread): Parsing macros/core.sql
2021-10-04 17:34:13.502618 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:34:13.516969 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:34:13.527540 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:34:13.560271 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:34:13.570465 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:34:13.578340 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:34:13.601813 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:34:13.611778 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:34:13.615433 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:34:13.640382 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:34:13.644603 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:34:13.698237 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:34:13.774350 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:34:13.778634 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:34:13.782224 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:34:13.785396 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:34:13.790015 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:34:13.793331 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:34:13.795595 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:34:13.798769 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:34:13.815188 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:34:13.819137 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:34:13.828943 (MainThread): Partial parsing not enabled
2021-10-04 17:34:13.874737 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:34:13.900284 (MainThread): A future version of dbt will parse files with both .yml and .yaml file extensions. dbt found 1 files with .yaml extensions in your dbt project. To avoid errors when upgrading to a future release, either remove these files from your dbt project, or change their extensions.
2021-10-04 17:34:14.031163 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-04 17:34:14.033804 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1493b575-56f2-47a7-a709-100e5abbf70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c495e80>]}
2021-10-04 17:34:14.067603 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 17:34:14.069230 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-04 17:34:14.071045 (MainThread): 
2021-10-04 17:34:14.072274 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:34:14.074930 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-04 17:34:14.086729 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-04 17:34:14.087907 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-04 17:34:14.088969 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 17:34:14.094045 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-04 17:34:14.097329 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-04 17:34:14.100664 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-04 17:34:14.107842 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:34:14.109700 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-04 17:34:14.111060 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 17:34:14.115937 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:34:14.117107 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-04 17:34:14.118067 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 17:34:14.121258 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-10-04 17:34:14.125924 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-04 17:34:14.127188 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-04 17:34:14.134167 (MainThread): Using postgres connection "master".
2021-10-04 17:34:14.135565 (MainThread): On master: BEGIN
2021-10-04 17:34:14.136836 (MainThread): Opening a new connection, currently in state init
2021-10-04 17:34:14.141206 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:34:14.142956 (MainThread): Using postgres connection "master".
2021-10-04 17:34:14.144147 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 17:34:14.149722 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2021-10-04 17:34:14.153620 (MainThread): On master: ROLLBACK
2021-10-04 17:34:14.154988 (MainThread): Using postgres connection "master".
2021-10-04 17:34:14.156096 (MainThread): On master: BEGIN
2021-10-04 17:34:14.157463 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:34:14.158511 (MainThread): On master: COMMIT
2021-10-04 17:34:14.159532 (MainThread): Using postgres connection "master".
2021-10-04 17:34:14.160528 (MainThread): On master: COMMIT
2021-10-04 17:34:14.161717 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:34:14.162609 (MainThread): On master: Close
2021-10-04 17:34:14.163917 (MainThread): 17:34:14 | Concurrency: 2 threads (target='dev')
2021-10-04 17:34:14.164931 (MainThread): 17:34:14 | 
2021-10-04 17:34:14.169192 (Thread-1): Began running node model.my_new_project.languagespeakers
2021-10-04 17:34:14.171270 (Thread-1): 17:34:14 | 1 of 1 START view model public.languagespeakers...................... [RUN]
2021-10-04 17:34:14.172415 (Thread-1): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:34:14.173853 (Thread-1): Compiling model.my_new_project.languagespeakers
2021-10-04 17:34:14.191528 (Thread-1): finished collecting timing info
2021-10-04 17:34:14.193228 (Thread-1): Compilation Error in model languagespeakers (models/languagespeakers.sql)
  'sources' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 8, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'sources' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model languagespeakers (models/languagespeakers.sql)
  'sources' is undefined
2021-10-04 17:34:14.195819 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1493b575-56f2-47a7-a709-100e5abbf70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c58c460>]}
2021-10-04 17:34:14.197687 (Thread-1): 17:34:14 | 1 of 1 ERROR creating view model public.languagespeakers............. [ERROR in 0.02s]
2021-10-04 17:34:14.198767 (Thread-1): Finished running node model.my_new_project.languagespeakers
2021-10-04 17:34:14.201087 (MainThread): Acquiring new postgres connection "master".
2021-10-04 17:34:14.202356 (MainThread): Using postgres connection "master".
2021-10-04 17:34:14.203468 (MainThread): On master: BEGIN
2021-10-04 17:34:14.204405 (MainThread): Opening a new connection, currently in state closed
2021-10-04 17:34:14.209485 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 17:34:14.211087 (MainThread): On master: COMMIT
2021-10-04 17:34:14.212506 (MainThread): Using postgres connection "master".
2021-10-04 17:34:14.213658 (MainThread): On master: COMMIT
2021-10-04 17:34:14.215293 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 17:34:14.216813 (MainThread): On master: Close
2021-10-04 17:34:14.218334 (MainThread): 17:34:14 | 
2021-10-04 17:34:14.219387 (MainThread): 17:34:14 | Finished running 1 view model in 0.15s.
2021-10-04 17:34:14.220733 (MainThread): Connection 'master' was properly closed.
2021-10-04 17:34:14.221959 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:34:14.256521 (MainThread): 
2021-10-04 17:34:14.257673 (MainThread): Completed with 1 error and 0 warnings:
2021-10-04 17:34:14.258859 (MainThread): 
2021-10-04 17:34:14.260088 (MainThread): Compilation Error in model languagespeakers (models/languagespeakers.sql)
2021-10-04 17:34:14.261076 (MainThread):   'sources' is undefined
2021-10-04 17:34:14.262152 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-04 17:34:14.263255 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c4a1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c5d2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c5d21f0>]}
2021-10-04 17:34:14.264354 (MainThread): Flushing usage events
2021-10-04 17:34:29.078361 (MainThread): Running with dbt=0.19.0
2021-10-04 17:34:29.200856 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:34:29.223397 (MainThread): Tracking: tracking
2021-10-04 17:34:29.226893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177856c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177a017310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177857d1c0>]}
2021-10-04 17:34:29.253657 (MainThread): Partial parsing not enabled
2021-10-04 17:34:29.256491 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:34:29.289010 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:34:29.294217 (MainThread): Parsing macros/relations.sql
2021-10-04 17:34:29.297436 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:34:29.301702 (MainThread): Parsing macros/core.sql
2021-10-04 17:34:29.308045 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:34:29.323046 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:34:29.335051 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:34:29.369404 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:34:29.379924 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:34:29.388452 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:34:29.413417 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:34:29.424086 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:34:29.428209 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:34:29.453673 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:34:29.457339 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:34:29.512624 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:34:29.588823 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:34:29.593028 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:34:29.597023 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:34:29.599756 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:34:29.604224 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:34:29.607523 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:34:29.609974 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:34:29.613809 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:34:29.629452 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:34:29.633610 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:34:29.643370 (MainThread): Partial parsing not enabled
2021-10-04 17:34:29.691310 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:34:29.716220 (MainThread): A future version of dbt will parse files with both .yml and .yaml file extensions. dbt found 1 files with .yaml extensions in your dbt project. To avoid errors when upgrading to a future release, either remove these files from your dbt project, or change their extensions.
2021-10-04 17:34:29.839644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778446f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778416970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17784bcca0>]}
2021-10-04 17:34:29.840851 (MainThread): Flushing usage events
2021-10-04 17:34:30.397012 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:34:30.399221 (MainThread): Encountered an error:
2021-10-04 17:34:30.400823 (MainThread): Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found
2021-10-04 17:34:30.403893 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found

2021-10-04 17:35:12.089685 (MainThread): Running with dbt=0.19.0
2021-10-04 17:35:12.210952 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:35:12.215523 (MainThread): Tracking: tracking
2021-10-04 17:35:12.218786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94336dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9436ce4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94336ef100>]}
2021-10-04 17:35:12.246153 (MainThread): Partial parsing not enabled
2021-10-04 17:35:12.248447 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:35:12.281306 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:35:12.286253 (MainThread): Parsing macros/relations.sql
2021-10-04 17:35:12.289619 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:35:12.294275 (MainThread): Parsing macros/core.sql
2021-10-04 17:35:12.300795 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:35:12.315991 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:35:12.327232 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:35:12.360607 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:35:12.371137 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:35:12.378876 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:35:12.402409 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:35:12.411856 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:35:12.415681 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:35:12.441341 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:35:12.445270 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:35:12.500002 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:35:12.568981 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:35:12.572341 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:35:12.575639 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:35:12.578376 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:35:12.582780 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:35:12.586212 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:35:12.588726 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:35:12.591927 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:35:12.605577 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:35:12.609368 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:35:12.619851 (MainThread): Partial parsing not enabled
2021-10-04 17:35:12.669923 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:35:12.695864 (MainThread): A future version of dbt will parse files with both .yml and .yaml file extensions. dbt found 1 files with .yaml extensions in your dbt project. To avoid errors when upgrading to a future release, either remove these files from your dbt project, or change their extensions.
2021-10-04 17:35:12.796499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94335993a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9433587340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94335872b0>]}
2021-10-04 17:35:12.797965 (MainThread): Flushing usage events
2021-10-04 17:35:13.332819 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:35:13.335983 (MainThread): Encountered an error:
2021-10-04 17:35:13.339178 (MainThread): Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found
2021-10-04 17:35:13.345866 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found

2021-10-04 17:37:36.156892 (MainThread): Running with dbt=0.19.0
2021-10-04 17:37:36.277934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:37:36.282408 (MainThread): Tracking: tracking
2021-10-04 17:37:36.285455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9533ff29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9535a9d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9534003190>]}
2021-10-04 17:37:36.312935 (MainThread): Partial parsing not enabled
2021-10-04 17:37:36.315248 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:37:36.347785 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:37:36.352632 (MainThread): Parsing macros/relations.sql
2021-10-04 17:37:36.355736 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:37:36.359947 (MainThread): Parsing macros/core.sql
2021-10-04 17:37:36.365914 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:37:36.380360 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:37:36.391140 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:37:36.423667 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:37:36.433803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:37:36.441512 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:37:36.466026 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:37:36.475673 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:37:36.479834 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:37:36.505506 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:37:36.509921 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:37:36.561943 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:37:36.632137 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:37:36.635662 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:37:36.639149 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:37:36.642075 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:37:36.647648 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:37:36.651349 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:37:36.653844 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:37:36.657062 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:37:36.670943 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:37:36.674884 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:37:36.685737 (MainThread): Partial parsing not enabled
2021-10-04 17:37:36.732191 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:37:36.759276 (MainThread): A future version of dbt will parse files with both .yml and .yaml file extensions. dbt found 1 files with .yaml extensions in your dbt project. To avoid errors when upgrading to a future release, either remove these files from your dbt project, or change their extensions.
2021-10-04 17:37:36.859732 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9533ec10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9533ec1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9533ec1820>]}
2021-10-04 17:37:36.861402 (MainThread): Flushing usage events
2021-10-04 17:37:37.463959 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:37:37.466725 (MainThread): Encountered an error:
2021-10-04 17:37:37.469193 (MainThread): Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found
2021-10-04 17:37:37.472614 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found

2021-10-04 17:39:25.187143 (MainThread): Running with dbt=0.19.0
2021-10-04 17:39:25.309741 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:39:25.314884 (MainThread): Tracking: tracking
2021-10-04 17:39:25.318209 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c77797b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7ad9e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c777a80d0>]}
2021-10-04 17:39:25.344751 (MainThread): Partial parsing not enabled
2021-10-04 17:39:25.346911 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:39:25.378330 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:39:25.382961 (MainThread): Parsing macros/relations.sql
2021-10-04 17:39:25.385912 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:39:25.389977 (MainThread): Parsing macros/core.sql
2021-10-04 17:39:25.395976 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:39:25.409766 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:39:25.420046 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:39:25.451391 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:39:25.461101 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:39:25.469349 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:39:25.492196 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:39:25.501771 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:39:25.505222 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:39:25.529911 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:39:25.533492 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:39:25.583967 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:39:25.653028 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:39:25.656265 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:39:25.659726 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:39:25.662431 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:39:25.666934 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:39:25.670053 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:39:25.672184 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:39:25.675085 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:39:25.688547 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:39:25.691993 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:39:25.701536 (MainThread): Partial parsing not enabled
2021-10-04 17:39:25.747216 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:39:25.774098 (MainThread): A future version of dbt will parse files with both .yml and .yaml file extensions. dbt found 1 files with .yaml extensions in your dbt project. To avoid errors when upgrading to a future release, either remove these files from your dbt project, or change their extensions.
2021-10-04 17:39:25.869765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c77666040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c77666280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c77666880>]}
2021-10-04 17:39:25.870879 (MainThread): Flushing usage events
2021-10-04 17:39:26.463721 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:39:26.466337 (MainThread): Encountered an error:
2021-10-04 17:39:26.468613 (MainThread): Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world.countrylanguage' which was not found
2021-10-04 17:39:26.472141 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world.countrylanguage' which was not found

2021-10-04 17:39:57.145090 (MainThread): Running with dbt=0.19.0
2021-10-04 17:39:57.263030 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:39:57.266834 (MainThread): Tracking: tracking
2021-10-04 17:39:57.270215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799fe0cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799e366f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799e366fd0>]}
2021-10-04 17:39:57.295930 (MainThread): Partial parsing not enabled
2021-10-04 17:39:57.298221 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:39:57.329921 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:39:57.335131 (MainThread): Parsing macros/relations.sql
2021-10-04 17:39:57.338206 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:39:57.342313 (MainThread): Parsing macros/core.sql
2021-10-04 17:39:57.348380 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:39:57.362068 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:39:57.374268 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:39:57.405583 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:39:57.415801 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:39:57.423427 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:39:57.445871 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:39:57.455130 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:39:57.458512 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:39:57.483061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:39:57.486615 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:39:57.537583 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:39:57.606705 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:39:57.610099 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:39:57.613313 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:39:57.616150 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:39:57.620571 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:39:57.623563 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:39:57.625642 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:39:57.628716 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:39:57.642238 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:39:57.645939 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:39:57.655359 (MainThread): Partial parsing not enabled
2021-10-04 17:39:57.699983 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:39:57.726160 (MainThread): A future version of dbt will parse files with both .yml and .yaml file extensions. dbt found 1 files with .yaml extensions in your dbt project. To avoid errors when upgrading to a future release, either remove these files from your dbt project, or change their extensions.
2021-10-04 17:39:57.822952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799e234790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799e2341f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799e234130>]}
2021-10-04 17:39:57.824370 (MainThread): Flushing usage events
2021-10-04 17:39:58.367538 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:39:58.370220 (MainThread): Encountered an error:
2021-10-04 17:39:58.372380 (MainThread): Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found
2021-10-04 17:39:58.375273 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model languagespeakers (models/languagespeakers.sql)
  Model 'model.my_new_project.languagespeakers' (models/languagespeakers.sql) depends on a source named 'world_dataset.countrylanguage' which was not found

2021-10-04 17:41:31.334785 (MainThread): Running with dbt=0.19.0
2021-10-04 17:41:31.464029 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:41:31.470049 (MainThread): Tracking: tracking
2021-10-04 17:41:31.474020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d4b7b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d6624280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d4b8b160>]}
2021-10-04 17:41:31.508047 (MainThread): Partial parsing not enabled
2021-10-04 17:41:31.511184 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:41:31.547547 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:41:31.553113 (MainThread): Parsing macros/relations.sql
2021-10-04 17:41:31.556821 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:41:31.561171 (MainThread): Parsing macros/core.sql
2021-10-04 17:41:31.568752 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:41:31.584000 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:41:31.594619 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:41:31.626550 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:41:31.637400 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:41:31.646196 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:41:31.669441 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:41:31.678839 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:41:31.682517 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:41:31.707865 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:41:31.711504 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:41:31.764338 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:41:31.835765 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:41:31.839634 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:41:31.843210 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:41:31.846098 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:41:31.850568 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:41:31.853640 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:41:31.856000 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:41:31.859407 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:41:31.873743 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:41:31.877840 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:41:31.887658 (MainThread): Partial parsing not enabled
2021-10-04 17:41:31.936783 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:41:31.970680 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d4b47070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d4a0c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d4a0ce80>]}
2021-10-04 17:41:31.972133 (MainThread): Flushing usage events
2021-10-04 17:41:32.567886 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:41:32.570685 (MainThread): Encountered an error:
2021-10-04 17:41:32.572350 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
2021-10-04 17:41:32.580604 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources:
  4  |   -name: world_dataset
  5  |     database: world
  6  |     schema: public
  7  |     tables:
  8  |       - name: city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13

2021-10-04 17:44:14.042737 (MainThread): Running with dbt=0.19.0
2021-10-04 17:44:14.160808 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:44:14.165972 (MainThread): Tracking: tracking
2021-10-04 17:44:14.169323 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1621d93910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162539a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1621da6100>]}
2021-10-04 17:44:14.195261 (MainThread): Partial parsing not enabled
2021-10-04 17:44:14.197540 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:44:14.228813 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:44:14.233315 (MainThread): Parsing macros/relations.sql
2021-10-04 17:44:14.236477 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:44:14.240609 (MainThread): Parsing macros/core.sql
2021-10-04 17:44:14.246772 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:44:14.260320 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:44:14.270717 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:44:14.302045 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:44:14.311946 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:44:14.320048 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:44:14.342828 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:44:14.352292 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:44:14.355611 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:44:14.380277 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:44:14.383757 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:44:14.434089 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:44:14.502783 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:44:14.506282 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:44:14.509618 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:44:14.512394 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:44:14.516951 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:44:14.520044 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:44:14.522240 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:44:14.525247 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:44:14.539014 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:44:14.542687 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:44:14.552319 (MainThread): Partial parsing not enabled
2021-10-04 17:44:14.598373 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:44:14.626837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1621d603d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1621c23250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1621c23df0>]}
2021-10-04 17:44:14.627863 (MainThread): Flushing usage events
2021-10-04 17:44:15.197284 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:44:15.200048 (MainThread): Encountered an error:
2021-10-04 17:44:15.201941 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: my_new_project
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
2021-10-04 17:44:15.210909 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources:
  4  |   -name: my_new_project
  5  |     database: world
  6  |     schema: public
  7  |     tables:
  8  |       - name: city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: my_new_project
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13

2021-10-04 17:46:32.170006 (MainThread): Running with dbt=0.19.0
2021-10-04 17:46:32.295544 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 17:46:32.300262 (MainThread): Tracking: tracking
2021-10-04 17:46:32.303287 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f32722910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f35d29430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f32733100>]}
2021-10-04 17:46:32.330817 (MainThread): Partial parsing not enabled
2021-10-04 17:46:32.333270 (MainThread): Parsing macros/adapters.sql
2021-10-04 17:46:32.366357 (MainThread): Parsing macros/catalog.sql
2021-10-04 17:46:32.371239 (MainThread): Parsing macros/relations.sql
2021-10-04 17:46:32.374304 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 17:46:32.379111 (MainThread): Parsing macros/core.sql
2021-10-04 17:46:32.385248 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 17:46:32.399100 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 17:46:32.410174 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 17:46:32.442851 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 17:46:32.453320 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 17:46:32.461063 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 17:46:32.484041 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 17:46:32.493529 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 17:46:32.496864 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 17:46:32.523903 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 17:46:32.527929 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 17:46:32.579897 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 17:46:32.650851 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 17:46:32.654312 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 17:46:32.657746 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 17:46:32.660517 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 17:46:32.664713 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 17:46:32.667703 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 17:46:32.669684 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 17:46:32.672874 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 17:46:32.687056 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 17:46:32.690845 (MainThread): Parsing macros/etc/query.sql
2021-10-04 17:46:32.700403 (MainThread): Partial parsing not enabled
2021-10-04 17:46:32.747361 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-04 17:46:32.777566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f326ef3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f325b2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f325b2df0>]}
2021-10-04 17:46:32.778839 (MainThread): Flushing usage events
2021-10-04 17:46:33.345243 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-04 17:46:33.347615 (MainThread): Encountered an error:
2021-10-04 17:46:33.349111 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | source:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
2021-10-04 17:46:33.357006 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | source:
  4  |   -name: world_dataset
  5  |     database: world
  6  |     schema: public
  7  |     tables:
  8  |       - name: city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | source:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13

2021-10-05 07:30:26.570759 (MainThread): Running with dbt=0.19.0
2021-10-05 07:30:26.755872 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:30:26.765102 (MainThread): Tracking: tracking
2021-10-05 07:30:26.768659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b6c44c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ba24a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b6c550d0>]}
2021-10-05 07:30:26.798936 (MainThread): Partial parsing not enabled
2021-10-05 07:30:26.803102 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:30:26.839089 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:30:26.845277 (MainThread): Parsing macros/relations.sql
2021-10-05 07:30:26.849778 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:30:26.855173 (MainThread): Parsing macros/core.sql
2021-10-05 07:30:26.862351 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:30:26.877142 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:30:26.888744 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:30:26.923364 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:30:26.934442 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:30:26.943215 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:30:26.967513 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:30:26.977744 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:30:26.982457 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:30:27.008704 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:30:27.014312 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:30:27.068464 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:30:27.141864 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:30:27.146156 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:30:27.150266 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:30:27.153517 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:30:27.158582 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:30:27.163358 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:30:27.166295 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:30:27.170045 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:30:27.185767 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:30:27.189974 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:30:27.201174 (MainThread): Partial parsing not enabled
2021-10-05 07:30:27.251121 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:30:27.287084 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b6c11a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b6ad4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b6ad4dc0>]}
2021-10-05 07:30:27.288719 (MainThread): Flushing usage events
2021-10-05 07:30:27.896334 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:30:27.898869 (MainThread): Encountered an error:
2021-10-05 07:30:27.900476 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | source:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
2021-10-05 07:30:27.913258 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | source:
  4  |   -name: world_dataset
  5  |     database: world
  6  |     schema: public
  7  |     tables:
  8  |       - name: city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | source:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13

2021-10-05 07:34:39.752303 (MainThread): Running with dbt=0.19.0
2021-10-05 07:34:39.900075 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:34:39.906267 (MainThread): Tracking: tracking
2021-10-05 07:34:39.910364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59683c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5982e7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59684d1c0>]}
2021-10-05 07:34:39.940094 (MainThread): Partial parsing not enabled
2021-10-05 07:34:39.943443 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:34:39.977825 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:34:39.982919 (MainThread): Parsing macros/relations.sql
2021-10-05 07:34:39.986379 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:34:39.991101 (MainThread): Parsing macros/core.sql
2021-10-05 07:34:39.997776 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:34:40.012387 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:34:40.023425 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:34:40.056519 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:34:40.067066 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:34:40.079653 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:34:40.107874 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:34:40.122272 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:34:40.129189 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:34:40.155998 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:34:40.159865 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:34:40.211953 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:34:40.283609 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:34:40.287814 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:34:40.291935 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:34:40.295445 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:34:40.300565 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:34:40.304308 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:34:40.306792 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:34:40.310306 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:34:40.325284 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:34:40.329430 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:34:40.340088 (MainThread): Partial parsing not enabled
2021-10-05 07:34:40.386145 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:34:40.417666 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc596813880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5966cc9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5966cce20>]}
2021-10-05 07:34:40.419063 (MainThread): Flushing usage events
2021-10-05 07:34:41.043115 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:34:41.046496 (MainThread): Encountered an error:
2021-10-05 07:34:41.049317 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
2021-10-05 07:34:41.061124 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources:
  4  |   -name: world_dataset
  5  |     database: world
  6  |     schema: public
  7  |     tables:
  8  |       - name: city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13

2021-10-05 07:34:47.709513 (MainThread): Running with dbt=0.19.0
2021-10-05 07:34:47.860894 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:34:47.867189 (MainThread): Tracking: tracking
2021-10-05 07:34:47.871622 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5323a8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5359ab430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5323b5100>]}
2021-10-05 07:34:47.903629 (MainThread): Partial parsing not enabled
2021-10-05 07:34:47.907181 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:34:47.942165 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:34:47.948472 (MainThread): Parsing macros/relations.sql
2021-10-05 07:34:47.952418 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:34:47.956857 (MainThread): Parsing macros/core.sql
2021-10-05 07:34:47.963252 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:34:47.977485 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:34:47.988273 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:34:48.021536 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:34:48.032197 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:34:48.041343 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:34:48.065193 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:34:48.075983 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:34:48.080066 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:34:48.107200 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:34:48.111487 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:34:48.164619 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:34:48.237286 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:34:48.241187 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:34:48.245109 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:34:48.248544 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:34:48.254097 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:34:48.257886 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:34:48.260811 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:34:48.264783 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:34:48.279712 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:34:48.284353 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:34:48.300043 (MainThread): Partial parsing not enabled
2021-10-05 07:34:48.346392 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:34:48.376411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5323723d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb532238250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb532238df0>]}
2021-10-05 07:34:48.378542 (MainThread): Flushing usage events
2021-10-05 07:34:48.956362 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:34:48.959722 (MainThread): Encountered an error:
2021-10-05 07:34:48.962203 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
2021-10-05 07:34:48.973109 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources:
  4  |   -name: world_dataset
  5  |     database: world
  6  |     schema: public
  7  |     tables:
  8  |       - name: city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |     database: world
    6  |     schema: public
    7  |     tables:
    8  |       - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13

2021-10-05 07:35:15.382244 (MainThread): Running with dbt=0.19.0
2021-10-05 07:35:15.532776 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:35:15.541029 (MainThread): Tracking: tracking
2021-10-05 07:35:15.544500 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d5da69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d77d12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d5db6190>]}
2021-10-05 07:35:15.571533 (MainThread): Partial parsing not enabled
2021-10-05 07:35:15.574062 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:35:15.606391 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:35:15.611365 (MainThread): Parsing macros/relations.sql
2021-10-05 07:35:15.614853 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:35:15.620092 (MainThread): Parsing macros/core.sql
2021-10-05 07:35:15.626843 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:35:15.640939 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:35:15.651779 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:35:15.684688 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:35:15.695393 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:35:15.703667 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:35:15.726924 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:35:15.736643 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:35:15.740749 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:35:15.767900 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:35:15.772968 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:35:15.825528 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:35:15.896694 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:35:15.900639 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:35:15.904486 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:35:15.907910 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:35:15.912797 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:35:15.916005 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:35:15.918305 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:35:15.921642 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:35:15.935991 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:35:15.940235 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:35:15.951074 (MainThread): Partial parsing not enabled
2021-10-05 07:35:15.998107 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:35:16.032878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d5d023a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d5c35580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d5c359d0>]}
2021-10-05 07:35:16.034468 (MainThread): Flushing usage events
2021-10-05 07:35:16.594442 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:35:16.597707 (MainThread): Encountered an error:
2021-10-05 07:35:16.599562 (MainThread): Compilation Error
  sources must be a list, got <class 'dict'> instead: ({'-name': 'world_dataset', 'database': 'worl...}]})
2021-10-05 07:35:16.602982 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 594, in parse_file
    for test_block in parser.parse():
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 675, in parse
    for data in self.get_key_dicts():
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 640, in get_key_dicts
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  sources must be a list, got <class 'dict'> instead: ({'-name': 'world_dataset', 'database': 'worl...}]})

2021-10-05 07:35:53.531613 (MainThread): Running with dbt=0.19.0
2021-10-05 07:35:53.668446 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:35:53.674580 (MainThread): Tracking: tracking
2021-10-05 07:35:53.678284 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673e8d3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674037e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673e8e41f0>]}
2021-10-05 07:35:53.712448 (MainThread): Partial parsing not enabled
2021-10-05 07:35:53.715489 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:35:53.750324 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:35:53.756381 (MainThread): Parsing macros/relations.sql
2021-10-05 07:35:53.759892 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:35:53.764473 (MainThread): Parsing macros/core.sql
2021-10-05 07:35:53.770974 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:35:53.785214 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:35:53.796138 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:35:53.828903 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:35:53.839133 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:35:53.847009 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:35:53.870531 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:35:53.880661 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:35:53.884446 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:35:53.910665 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:35:53.914588 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:35:53.967264 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:35:54.040131 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:35:54.044218 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:35:54.048117 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:35:54.051364 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:35:54.056149 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:35:54.059550 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:35:54.062216 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:35:54.065713 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:35:54.080123 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:35:54.084083 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:35:54.094367 (MainThread): Partial parsing not enabled
2021-10-05 07:35:54.140519 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:35:54.171408 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673e8ac730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673e7645e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673e764d30>]}
2021-10-05 07:35:54.173315 (MainThread): Flushing usage events
2021-10-05 07:35:55.096867 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:35:55.099690 (MainThread): Encountered an error:
2021-10-05 07:35:55.101642 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |    database: world
    6  |    schema: public
    7  |    tables:
    8  |      - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 12
2021-10-05 07:35:55.112045 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources:
  4  |   -name: world_dataset
  5  |    database: world
  6  |    schema: public
  7  |    tables:
  8  |      - name: city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   -name: world_dataset
    5  |    database: world
    6  |    schema: public
    7  |    tables:
    8  |      - name: city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 12

2021-10-05 07:39:22.981483 (MainThread): Running with dbt=0.19.0
2021-10-05 07:39:23.124869 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:39:23.131738 (MainThread): Tracking: tracking
2021-10-05 07:39:23.135587 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0226d90970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f022883b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0226da2160>]}
2021-10-05 07:39:23.164637 (MainThread): Partial parsing not enabled
2021-10-05 07:39:23.167411 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:39:23.200122 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:39:23.205062 (MainThread): Parsing macros/relations.sql
2021-10-05 07:39:23.208217 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:39:23.212635 (MainThread): Parsing macros/core.sql
2021-10-05 07:39:23.218865 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:39:23.233005 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:39:23.244252 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:39:23.276943 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:39:23.287292 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:39:23.295070 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:39:23.318304 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:39:23.327743 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:39:23.331435 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:39:23.357130 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:39:23.361181 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:39:23.413977 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:39:23.484934 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:39:23.488992 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:39:23.493010 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:39:23.496319 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:39:23.501311 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:39:23.504719 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:39:23.507317 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:39:23.510755 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:39:23.525043 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:39:23.529526 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:39:23.541503 (MainThread): Partial parsing not enabled
2021-10-05 07:39:23.587268 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:39:23.620106 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0226d5d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0226c242b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0226c24e80>]}
2021-10-05 07:39:23.621455 (MainThread): Flushing usage events
2021-10-05 07:39:24.219566 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:39:24.222377 (MainThread): Encountered an error:
2021-10-05 07:39:24.224389 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources :
    4  |   -name : world_dataset
    5  |    database : world
    6  |    schema : public
    7  |    tables :
    8  |      - name : city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
2021-10-05 07:39:24.234035 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources :
  4  |   -name : world_dataset
  5  |    database : world
  6  |    schema : public
  7  |    tables :
  8  |      - name : city
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 13

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources :
    4  |   -name : world_dataset
    5  |    database : world
    6  |    schema : public
    7  |    tables :
    8  |      - name : city
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13

2021-10-05 07:40:37.366205 (MainThread): Running with dbt=0.19.0
2021-10-05 07:40:37.505782 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:40:37.511666 (MainThread): Tracking: tracking
2021-10-05 07:40:37.517573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479b051940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479e656460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479b061130>]}
2021-10-05 07:40:37.546715 (MainThread): Partial parsing not enabled
2021-10-05 07:40:37.549461 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:40:37.582786 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:40:37.588144 (MainThread): Parsing macros/relations.sql
2021-10-05 07:40:37.591587 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:40:37.596189 (MainThread): Parsing macros/core.sql
2021-10-05 07:40:37.602678 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:40:37.617135 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:40:37.628233 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:40:37.661021 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:40:37.671555 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:40:37.679500 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:40:37.703301 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:40:37.712956 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:40:37.716764 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:40:37.742254 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:40:37.746147 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:40:37.798250 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:40:37.868909 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:40:37.873041 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:40:37.877128 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:40:37.880506 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:40:37.885795 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:40:37.889904 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:40:37.892919 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:40:37.896700 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:40:37.911489 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:40:37.915851 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:40:37.927578 (MainThread): Partial parsing not enabled
2021-10-05 07:40:37.973776 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:40:38.004798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479b00ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479aee24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479aee2e50>]}
2021-10-05 07:40:38.006234 (MainThread): Flushing usage events
2021-10-05 07:40:38.567506 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:40:38.570577 (MainThread): Encountered an error:
2021-10-05 07:40:38.573265 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources :
    4  |   - name : world_dataset
    5  |    database : world
    6  |    schema : public
    7  |    tables :
    8  |      - name : city
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 5, column 4
2021-10-05 07:40:38.584786 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 3
did not find expected '-' indicator
  in "<unicode string>", line 5, column 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources :
  4  |   - name : world_dataset
  5  |    database : world
  6  |    schema : public
  7  |    tables :
  8  |      - name : city
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 3
  did not find expected '-' indicator
    in "<unicode string>", line 5, column 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources :
    4  |   - name : world_dataset
    5  |    database : world
    6  |    schema : public
    7  |    tables :
    8  |      - name : city
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 5, column 4

2021-10-05 07:40:45.848466 (MainThread): Running with dbt=0.19.0
2021-10-05 07:40:45.989250 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:40:45.993667 (MainThread): Tracking: tracking
2021-10-05 07:40:45.997279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa1ab4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa50ba3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa1ac5070>]}
2021-10-05 07:40:46.025327 (MainThread): Partial parsing not enabled
2021-10-05 07:40:46.027655 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:40:46.060222 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:40:46.065949 (MainThread): Parsing macros/relations.sql
2021-10-05 07:40:46.069525 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:40:46.074712 (MainThread): Parsing macros/core.sql
2021-10-05 07:40:46.081379 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:40:46.095780 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:40:46.106802 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:40:46.139722 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:40:46.150362 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:40:46.158515 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:40:46.181880 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:40:46.191665 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:40:46.195703 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:40:46.221352 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:40:46.225156 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:40:46.277843 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:40:46.349525 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:40:46.353690 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:40:46.357906 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:40:46.361737 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:40:46.367282 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:40:46.371326 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:40:46.374367 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:40:46.378222 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:40:46.392341 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:40:46.396817 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:40:46.408339 (MainThread): Partial parsing not enabled
2021-10-05 07:40:46.452668 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:40:46.481976 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa1a32040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa19431c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa1943d60>]}
2021-10-05 07:40:46.483908 (MainThread): Flushing usage events
2021-10-05 07:40:47.103791 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:40:47.106871 (MainThread): Encountered an error:
2021-10-05 07:40:47.109024 (MainThread): Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources :
    4  |   - name : world_dataset
    5  |    database : world
    6  |    schema : public
    7  |    tables :
    8  |      - name : city
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 5, column 4
2021-10-05 07:40:47.119199 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 3
did not find expected '-' indicator
  in "<unicode string>", line 5, column 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 233, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources :
  4  |   - name : world_dataset
  5  |    database : world
  6  |    schema : public
  7  |    tables :
  8  |      - name : city
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 3
  did not find expected '-' indicator
    in "<unicode string>", line 5, column 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 563, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 236, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources :
    4  |   - name : world_dataset
    5  |    database : world
    6  |    schema : public
    7  |    tables :
    8  |      - name : city
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 5, column 4

2021-10-05 07:41:58.651472 (MainThread): Running with dbt=0.19.0
2021-10-05 07:41:58.795445 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:41:58.805083 (MainThread): Tracking: tracking
2021-10-05 07:41:58.809072 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa284a4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2baab3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa284b7070>]}
2021-10-05 07:41:58.837767 (MainThread): Partial parsing not enabled
2021-10-05 07:41:58.840614 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:41:58.873555 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:41:58.878584 (MainThread): Parsing macros/relations.sql
2021-10-05 07:41:58.882107 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:41:58.887064 (MainThread): Parsing macros/core.sql
2021-10-05 07:41:58.893726 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:41:58.908192 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:41:58.919504 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:41:58.952781 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:41:58.963216 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:41:58.971162 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:41:58.994960 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:41:59.004683 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:41:59.009279 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:41:59.035230 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:41:59.039127 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:41:59.091791 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:41:59.164606 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:41:59.168232 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:41:59.172048 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:41:59.175151 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:41:59.179987 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:41:59.183500 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:41:59.185998 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:41:59.189492 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:41:59.203965 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:41:59.208581 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:41:59.219141 (MainThread): Partial parsing not enabled
2021-10-05 07:41:59.265082 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.451010 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 07:41:59.457559 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a68a8dfe-12a4-4e3b-8019-ac8d46f4dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2834c7c0>]}
2021-10-05 07:41:59.499950 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 07:41:59.502001 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 07:41:59.504044 (MainThread): 
2021-10-05 07:41:59.506161 (MainThread): Acquiring new postgres connection "master".
2021-10-05 07:41:59.510669 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-05 07:41:59.522670 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-05 07:41:59.524189 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-05 07:41:59.525664 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 07:41:59.533167 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 07:41:59.536884 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-05 07:41:59.540515 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-05 07:41:59.547964 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 07:41:59.549202 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-05 07:41:59.550420 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-05 07:41:59.556208 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 07:41:59.557722 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 07:41:59.559034 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 07:41:59.563771 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-10-05 07:41:59.569212 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-05 07:41:59.570847 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-05 07:41:59.577599 (MainThread): Using postgres connection "master".
2021-10-05 07:41:59.578847 (MainThread): On master: BEGIN
2021-10-05 07:41:59.579955 (MainThread): Opening a new connection, currently in state init
2021-10-05 07:41:59.585039 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 07:41:59.586178 (MainThread): Using postgres connection "master".
2021-10-05 07:41:59.587395 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 07:41:59.601709 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-05 07:41:59.606959 (MainThread): On master: ROLLBACK
2021-10-05 07:41:59.609083 (MainThread): Using postgres connection "master".
2021-10-05 07:41:59.610519 (MainThread): On master: BEGIN
2021-10-05 07:41:59.612206 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 07:41:59.613449 (MainThread): On master: COMMIT
2021-10-05 07:41:59.614421 (MainThread): Using postgres connection "master".
2021-10-05 07:41:59.615675 (MainThread): On master: COMMIT
2021-10-05 07:41:59.617146 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 07:41:59.618244 (MainThread): On master: Close
2021-10-05 07:41:59.619659 (MainThread): 07:41:59 | Concurrency: 2 threads (target='dev')
2021-10-05 07:41:59.620974 (MainThread): 07:41:59 | 
2021-10-05 07:41:59.625000 (Thread-1): Began running node model.my_new_project.languagespeakers
2021-10-05 07:41:59.627622 (Thread-1): 07:41:59 | 1 of 1 START table model public.languagespeakers..................... [RUN]
2021-10-05 07:41:59.629107 (Thread-1): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.631180 (Thread-1): Compiling model.my_new_project.languagespeakers
2021-10-05 07:41:59.652342 (Thread-1): Writing injected SQL for node "model.my_new_project.languagespeakers"
2021-10-05 07:41:59.659688 (Thread-1): finished collecting timing info
2021-10-05 07:41:59.685009 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.686575 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop table if exists "world"."public"."languagespeakers__dbt_tmp" cascade
2021-10-05 07:41:59.687962 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 07:41:59.694725 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 07:41:59.698439 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.699594 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-05 07:41:59.701049 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 07:41:59.712897 (Thread-1): Writing runtime SQL for node "model.my_new_project.languagespeakers"
2021-10-05 07:41:59.719648 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.720749 (Thread-1): On model.my_new_project.languagespeakers: BEGIN
2021-10-05 07:41:59.722506 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 07:41:59.723815 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.725006 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */


  create  table "world"."public"."languagespeakers__dbt_tmp"
  as (
    

SELECT RANK() OVER(ORDER BY speakers desc) as ranking,
language,
speakers
FROM(
SELECT cl.language, ROUND(sum(co.population*cl.percentage/100)::decimal, 0) as speakers FROM (
SELECT code, population FROM country
	) co JOIN (
SELECT countrycode, language, percentage FROM "world"."public"."countrylanguage" ) cl
ON co.code = cl.countrycode
GROUP BY cl.language) T
ORDER BY speakers desc
  );
2021-10-05 07:41:59.744922 (Thread-1): SQL status: SELECT 457 in 0.02 seconds
2021-10-05 07:41:59.754672 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.756361 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers" rename to "languagespeakers__dbt_backup"
2021-10-05 07:41:59.758484 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 07:41:59.762135 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.763638 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers__dbt_tmp" rename to "languagespeakers"
2021-10-05 07:41:59.765507 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 07:41:59.773642 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-05 07:41:59.775335 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.777308 (Thread-1): On model.my_new_project.languagespeakers: COMMIT
2021-10-05 07:41:59.780247 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 07:41:59.785136 (Thread-1): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:41:59.787493 (Thread-1): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop view if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-05 07:41:59.791565 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 07:41:59.795230 (Thread-1): finished collecting timing info
2021-10-05 07:41:59.796582 (Thread-1): On model.my_new_project.languagespeakers: Close
2021-10-05 07:41:59.798316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a68a8dfe-12a4-4e3b-8019-ac8d46f4dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28302bb0>]}
2021-10-05 07:41:59.800614 (Thread-1): 07:41:59 | 1 of 1 OK created table model public.languagespeakers................ [SELECT 457 in 0.17s]
2021-10-05 07:41:59.802029 (Thread-1): Finished running node model.my_new_project.languagespeakers
2021-10-05 07:41:59.805590 (MainThread): Acquiring new postgres connection "master".
2021-10-05 07:41:59.806749 (MainThread): Using postgres connection "master".
2021-10-05 07:41:59.807979 (MainThread): On master: BEGIN
2021-10-05 07:41:59.809134 (MainThread): Opening a new connection, currently in state closed
2021-10-05 07:41:59.814244 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 07:41:59.815684 (MainThread): On master: COMMIT
2021-10-05 07:41:59.816872 (MainThread): Using postgres connection "master".
2021-10-05 07:41:59.818175 (MainThread): On master: COMMIT
2021-10-05 07:41:59.819716 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 07:41:59.820889 (MainThread): On master: Close
2021-10-05 07:41:59.822489 (MainThread): 07:41:59 | 
2021-10-05 07:41:59.824027 (MainThread): 07:41:59 | Finished running 1 table model in 0.32s.
2021-10-05 07:41:59.825481 (MainThread): Connection 'master' was properly closed.
2021-10-05 07:41:59.826665 (MainThread): Connection 'list_world' was properly closed.
2021-10-05 07:41:59.827852 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:41:59.864494 (MainThread): 
2021-10-05 07:41:59.865824 (MainThread): Completed successfully
2021-10-05 07:41:59.867248 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 07:41:59.869062 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa283e9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28321d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa283099a0>]}
2021-10-05 07:41:59.870882 (MainThread): Flushing usage events
2021-10-05 07:53:23.690995 (MainThread): Running with dbt=0.19.0
2021-10-05 07:53:23.844157 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 07:53:23.849756 (MainThread): Tracking: tracking
2021-10-05 07:53:23.853214 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e469fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e614a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e46b11f0>]}
2021-10-05 07:53:23.882716 (MainThread): Partial parsing not enabled
2021-10-05 07:53:23.885621 (MainThread): Parsing macros/adapters.sql
2021-10-05 07:53:23.920550 (MainThread): Parsing macros/catalog.sql
2021-10-05 07:53:23.925548 (MainThread): Parsing macros/relations.sql
2021-10-05 07:53:23.929075 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 07:53:23.933599 (MainThread): Parsing macros/core.sql
2021-10-05 07:53:23.940456 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 07:53:23.954785 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 07:53:23.965782 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 07:53:23.999505 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 07:53:24.011015 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 07:53:24.019526 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 07:53:24.043876 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 07:53:24.054062 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 07:53:24.057860 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 07:53:24.084645 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 07:53:24.088585 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 07:53:24.142354 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 07:53:24.217153 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 07:53:24.220952 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 07:53:24.224792 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 07:53:24.227973 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 07:53:24.232671 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 07:53:24.236025 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 07:53:24.238615 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 07:53:24.242927 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 07:53:24.257477 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 07:53:24.261760 (MainThread): Parsing macros/etc/query.sql
2021-10-05 07:53:24.272567 (MainThread): Partial parsing not enabled
2021-10-05 07:53:24.321977 (MainThread): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.347564 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.527010 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 07:53:24.532202 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68f6b358-cffc-4a1b-8db4-6d92ac501d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e45c9430>]}
2021-10-05 07:53:24.574969 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 07:53:24.578394 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 07:53:24.580931 (MainThread): 
2021-10-05 07:53:24.582591 (MainThread): Acquiring new postgres connection "master".
2021-10-05 07:53:24.586820 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-05 07:53:24.600646 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-05 07:53:24.602375 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-05 07:53:24.603884 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 07:53:24.610642 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 07:53:24.615543 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-05 07:53:24.621734 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-05 07:53:24.629964 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 07:53:24.631456 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-05 07:53:24.632823 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 07:53:24.639500 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 07:53:24.641975 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 07:53:24.644418 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 07:53:24.648744 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-10-05 07:53:24.656352 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-05 07:53:24.658670 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-05 07:53:24.667425 (MainThread): Using postgres connection "master".
2021-10-05 07:53:24.668854 (MainThread): On master: BEGIN
2021-10-05 07:53:24.670219 (MainThread): Opening a new connection, currently in state init
2021-10-05 07:53:24.676339 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 07:53:24.677826 (MainThread): Using postgres connection "master".
2021-10-05 07:53:24.679169 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 07:53:24.685485 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 07:53:24.687245 (MainThread): On master: ROLLBACK
2021-10-05 07:53:24.688985 (MainThread): Using postgres connection "master".
2021-10-05 07:53:24.690297 (MainThread): On master: BEGIN
2021-10-05 07:53:24.692373 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 07:53:24.693648 (MainThread): On master: COMMIT
2021-10-05 07:53:24.695108 (MainThread): Using postgres connection "master".
2021-10-05 07:53:24.696638 (MainThread): On master: COMMIT
2021-10-05 07:53:24.698456 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 07:53:24.699817 (MainThread): On master: Close
2021-10-05 07:53:24.701693 (MainThread): 07:53:24 | Concurrency: 2 threads (target='dev')
2021-10-05 07:53:24.703028 (MainThread): 07:53:24 | 
2021-10-05 07:53:24.707577 (Thread-1): Began running node model.my_new_project.citypopulations
2021-10-05 07:53:24.707969 (Thread-2): Began running node model.my_new_project.languagespeakers
2021-10-05 07:53:24.710413 (Thread-1): 07:53:24 | 1 of 2 START view model public.citypopulations....................... [RUN]
2021-10-05 07:53:24.714181 (Thread-2): 07:53:24 | 2 of 2 START table model public.languagespeakers..................... [RUN]
2021-10-05 07:53:24.716017 (Thread-1): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.718056 (Thread-2): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.718888 (Thread-1): Compiling model.my_new_project.citypopulations
2021-10-05 07:53:24.720071 (Thread-2): Compiling model.my_new_project.languagespeakers
2021-10-05 07:53:24.745380 (Thread-1): Writing injected SQL for node "model.my_new_project.citypopulations"
2021-10-05 07:53:24.749711 (Thread-2): Writing injected SQL for node "model.my_new_project.languagespeakers"
2021-10-05 07:53:24.754349 (Thread-1): finished collecting timing info
2021-10-05 07:53:24.755499 (Thread-2): finished collecting timing info
2021-10-05 07:53:24.804696 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.810809 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.811963 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
drop view if exists "world"."public"."citypopulations__dbt_tmp" cascade
2021-10-05 07:53:24.813474 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop table if exists "world"."public"."languagespeakers__dbt_tmp" cascade
2021-10-05 07:53:24.814951 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 07:53:24.816343 (Thread-2): Opening a new connection, currently in state init
2021-10-05 07:53:24.822713 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-05 07:53:24.827383 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.827674 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 07:53:24.828625 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
drop view if exists "world"."public"."citypopulations__dbt_backup" cascade
2021-10-05 07:53:24.832053 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.833903 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 07:53:24.834848 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop table if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-05 07:53:24.841081 (Thread-1): Writing runtime SQL for node "model.my_new_project.citypopulations"
2021-10-05 07:53:24.843725 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 07:53:24.852054 (Thread-2): Writing runtime SQL for node "model.my_new_project.languagespeakers"
2021-10-05 07:53:24.853195 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.855700 (Thread-1): On model.my_new_project.citypopulations: BEGIN
2021-10-05 07:53:24.857038 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.857798 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 07:53:24.859316 (Thread-2): On model.my_new_project.languagespeakers: BEGIN
2021-10-05 07:53:24.860796 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.863035 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-05 07:53:24.864441 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */

  create view "world"."public"."citypopulations__dbt_tmp" as (
    SELECT country_name
, city_name
, ROUND(city_pop/country_pop::decimal, 3)*100 percent_of_country_pop
, RANK() OVER (PARTITION BY country_name ORDER BY city_pop DESC) city_rank_in_country FROM
(
SELECT name city_name, countrycode, population city_pop from city
) c1
JOIN
(
SELECT name country_name, code, population country_pop from country
) co
ON c1.countrycode = co.code
  );

2021-10-05 07:53:24.866224 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.870252 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */


  create  table "world"."public"."languagespeakers__dbt_tmp"
  as (
    

SELECT RANK() OVER(ORDER BY speakers desc) as ranking,
language,
speakers
FROM(
SELECT cl.language, ROUND(sum(co.population*cl.percentage/100)::decimal, 0) as speakers FROM (
SELECT code, population FROM country
	) co JOIN (
SELECT countrycode, language, percentage FROM "world"."public"."countrylanguage" ) cl
ON co.code = cl.countrycode
GROUP BY cl.language) T
ORDER BY speakers desc
  );
2021-10-05 07:53:24.872720 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-05 07:53:24.882757 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.883063 (Thread-2): SQL status: SELECT 457 in 0.01 seconds
2021-10-05 07:53:24.884920 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
alter table "world"."public"."citypopulations__dbt_tmp" rename to "citypopulations"
2021-10-05 07:53:24.890516 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.892645 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 07:53:24.893456 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers" rename to "languagespeakers__dbt_backup"
2021-10-05 07:53:24.902791 (Thread-1): On model.my_new_project.citypopulations: COMMIT
2021-10-05 07:53:24.905389 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.904430 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 07:53:24.907197 (Thread-1): On model.my_new_project.citypopulations: COMMIT
2021-10-05 07:53:24.911210 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.914089 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers__dbt_tmp" rename to "languagespeakers"
2021-10-05 07:53:24.914514 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 07:53:24.916804 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 07:53:24.920834 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 07:53:24.923265 (Thread-2): On model.my_new_project.languagespeakers: COMMIT
2021-10-05 07:53:24.924702 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
drop view if exists "world"."public"."citypopulations__dbt_backup" cascade
2021-10-05 07:53:24.926112 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.928200 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 07:53:24.929026 (Thread-2): On model.my_new_project.languagespeakers: COMMIT
2021-10-05 07:53:24.933156 (Thread-1): finished collecting timing info
2021-10-05 07:53:24.935804 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-05 07:53:24.936014 (Thread-1): On model.my_new_project.citypopulations: Close
2021-10-05 07:53:24.940556 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 07:53:24.942876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68f6b358-cffc-4a1b-8db4-6d92ac501d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e1baae20>]}
2021-10-05 07:53:24.943692 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop table if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-05 07:53:24.946191 (Thread-1): 07:53:24 | 1 of 2 OK created view model public.citypopulations.................. [CREATE VIEW in 0.23s]
2021-10-05 07:53:24.948981 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 07:53:24.949346 (Thread-1): Finished running node model.my_new_project.citypopulations
2021-10-05 07:53:24.952893 (Thread-2): finished collecting timing info
2021-10-05 07:53:24.955555 (Thread-2): On model.my_new_project.languagespeakers: Close
2021-10-05 07:53:24.957228 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68f6b358-cffc-4a1b-8db4-6d92ac501d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e1b86670>]}
2021-10-05 07:53:24.959457 (Thread-2): 07:53:24 | 2 of 2 OK created table model public.languagespeakers................ [SELECT 457 in 0.24s]
2021-10-05 07:53:24.960720 (Thread-2): Finished running node model.my_new_project.languagespeakers
2021-10-05 07:53:24.963894 (MainThread): Acquiring new postgres connection "master".
2021-10-05 07:53:24.965218 (MainThread): Using postgres connection "master".
2021-10-05 07:53:24.966341 (MainThread): On master: BEGIN
2021-10-05 07:53:24.967536 (MainThread): Opening a new connection, currently in state closed
2021-10-05 07:53:24.972894 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 07:53:24.974785 (MainThread): On master: COMMIT
2021-10-05 07:53:24.976272 (MainThread): Using postgres connection "master".
2021-10-05 07:53:24.977662 (MainThread): On master: COMMIT
2021-10-05 07:53:24.979355 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 07:53:24.980803 (MainThread): On master: Close
2021-10-05 07:53:24.982431 (MainThread): 07:53:24 | 
2021-10-05 07:53:24.983789 (MainThread): 07:53:24 | Finished running 1 view model, 1 table model in 0.40s.
2021-10-05 07:53:24.985270 (MainThread): Connection 'master' was properly closed.
2021-10-05 07:53:24.986634 (MainThread): Connection 'model.my_new_project.citypopulations' was properly closed.
2021-10-05 07:53:24.987804 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 07:53:25.026740 (MainThread): 
2021-10-05 07:53:25.028410 (MainThread): Completed successfully
2021-10-05 07:53:25.030059 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-05 07:53:25.031835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e1b86400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e4533430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e1b88f40>]}
2021-10-05 07:53:25.033412 (MainThread): Flushing usage events
2021-10-05 08:53:17.111961 (MainThread): Running with dbt=0.19.0
2021-10-05 08:53:17.267869 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 08:53:17.274210 (MainThread): Tracking: tracking
2021-10-05 08:53:17.277782 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b08e2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b230e280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b08f42b0>]}
2021-10-05 08:53:17.306932 (MainThread): Partial parsing not enabled
2021-10-05 08:53:17.310308 (MainThread): Parsing macros/adapters.sql
2021-10-05 08:53:17.343817 (MainThread): Parsing macros/catalog.sql
2021-10-05 08:53:17.349583 (MainThread): Parsing macros/relations.sql
2021-10-05 08:53:17.353472 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 08:53:17.357866 (MainThread): Parsing macros/core.sql
2021-10-05 08:53:17.364738 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 08:53:17.379324 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 08:53:17.391184 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 08:53:17.425791 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 08:53:17.436705 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 08:53:17.444983 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 08:53:17.468858 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 08:53:17.479097 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 08:53:17.483476 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 08:53:17.510184 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 08:53:17.514964 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 08:53:17.571256 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 08:53:17.644980 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 08:53:17.649608 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 08:53:17.654129 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 08:53:17.657854 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 08:53:17.662786 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 08:53:17.666039 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 08:53:17.668884 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 08:53:17.672361 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 08:53:17.687283 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 08:53:17.691704 (MainThread): Parsing macros/etc/query.sql
2021-10-05 08:53:17.705538 (MainThread): Partial parsing not enabled
2021-10-05 08:53:17.765756 (MainThread): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:53:17.796519 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:53:17.825113 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:53:17.830366 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b084e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b077ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b070fee0>]}
2021-10-05 08:53:17.831967 (MainThread): Flushing usage events
2021-10-05 08:53:18.431786 (MainThread): Connection 'snapshot.my_new_project.citypopulations_snapshot' was properly closed.
2021-10-05 08:53:18.434742 (MainThread): Encountered an error:
2021-10-05 08:53:18.437104 (MainThread): Compilation Error in snapshot citypopulations_snapshot (snapshots/citypopulations.sql)
  expected token ',', got 'check_cols'
    line 9
      check_cols=["percentage_of_country_pop", "city_rank_in_country"]
2021-10-05 08:53:18.441985 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 9, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'check_cols'
  line 9
    check_cols=["percentage_of_country_pop", "city_rank_in_country"]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 82, in parse_file
    self.parse_node(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in snapshot citypopulations_snapshot (snapshots/citypopulations.sql)
  expected token ',', got 'check_cols'
    line 9
      check_cols=["percentage_of_country_pop", "city_rank_in_country"]

2021-10-05 08:54:09.920563 (MainThread): Running with dbt=0.19.0
2021-10-05 08:54:10.066608 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 08:54:10.073758 (MainThread): Tracking: tracking
2021-10-05 08:54:10.077829 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f004c7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f03acd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f004d8250>]}
2021-10-05 08:54:10.107154 (MainThread): Partial parsing not enabled
2021-10-05 08:54:10.110785 (MainThread): Parsing macros/adapters.sql
2021-10-05 08:54:10.143478 (MainThread): Parsing macros/catalog.sql
2021-10-05 08:54:10.148863 (MainThread): Parsing macros/relations.sql
2021-10-05 08:54:10.152575 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 08:54:10.157925 (MainThread): Parsing macros/core.sql
2021-10-05 08:54:10.164537 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 08:54:10.179113 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 08:54:10.189938 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 08:54:10.222920 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 08:54:10.233446 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 08:54:10.241755 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 08:54:10.265620 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 08:54:10.275729 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 08:54:10.279587 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 08:54:10.305781 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 08:54:10.309917 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 08:54:10.362837 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 08:54:10.434836 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 08:54:10.439585 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 08:54:10.443376 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 08:54:10.446683 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 08:54:10.451421 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 08:54:10.455317 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 08:54:10.458238 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 08:54:10.461616 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 08:54:10.476498 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 08:54:10.480731 (MainThread): Parsing macros/etc/query.sql
2021-10-05 08:54:10.491454 (MainThread): Partial parsing not enabled
2021-10-05 08:54:10.537316 (MainThread): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:10.562182 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:10.589831 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:10.595383 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0042aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0035ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f002f4e80>]}
2021-10-05 08:54:10.596875 (MainThread): Flushing usage events
2021-10-05 08:54:11.151255 (MainThread): Connection 'snapshot.my_new_project.citypopulations_snapshot' was properly closed.
2021-10-05 08:54:11.154142 (MainThread): Encountered an error:
2021-10-05 08:54:11.156755 (MainThread): Compilation Error in snapshot citypopulations_snapshot (snapshots/citypopulations.sql)
  expected token ',', got 'check_cols'
    line 9
      check_cols=['percentage_of_country_pop', 'city_rank_in_country']
2021-10-05 08:54:11.161294 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 9, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'check_cols'
  line 9
    check_cols=['percentage_of_country_pop', 'city_rank_in_country']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 82, in parse_file
    self.parse_node(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in snapshot citypopulations_snapshot (snapshots/citypopulations.sql)
  expected token ',', got 'check_cols'
    line 9
      check_cols=['percentage_of_country_pop', 'city_rank_in_country']

2021-10-05 08:54:19.132938 (MainThread): Running with dbt=0.19.0
2021-10-05 08:54:19.275144 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 08:54:19.280783 (MainThread): Tracking: tracking
2021-10-05 08:54:19.285148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed17f1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed4df8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed1803100>]}
2021-10-05 08:54:19.313978 (MainThread): Partial parsing not enabled
2021-10-05 08:54:19.317152 (MainThread): Parsing macros/adapters.sql
2021-10-05 08:54:19.349768 (MainThread): Parsing macros/catalog.sql
2021-10-05 08:54:19.354704 (MainThread): Parsing macros/relations.sql
2021-10-05 08:54:19.358873 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 08:54:19.365905 (MainThread): Parsing macros/core.sql
2021-10-05 08:54:19.374945 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 08:54:19.389404 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 08:54:19.400430 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 08:54:19.433913 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 08:54:19.444376 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 08:54:19.452571 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 08:54:19.475951 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 08:54:19.485591 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 08:54:19.489560 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 08:54:19.515318 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 08:54:19.519161 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 08:54:19.571584 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 08:54:19.642564 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 08:54:19.646600 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 08:54:19.650741 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 08:54:19.654204 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 08:54:19.659244 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 08:54:19.662710 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 08:54:19.665418 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 08:54:19.669131 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 08:54:19.683812 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 08:54:19.688055 (MainThread): Parsing macros/etc/query.sql
2021-10-05 08:54:19.700370 (MainThread): Partial parsing not enabled
2021-10-05 08:54:19.749748 (MainThread): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:19.777163 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:19.804727 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:20.008766 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 08:54:20.014910 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43f4fd92-5f8f-44b0-9253-a5fea8eb4f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed1641640>]}
2021-10-05 08:54:20.061846 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 08:54:20.063907 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-05 08:54:20.066312 (MainThread): 
2021-10-05 08:54:20.067873 (MainThread): Acquiring new postgres connection "master".
2021-10-05 08:54:20.072014 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-05 08:54:20.084877 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-05 08:54:20.086452 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-05 08:54:20.087884 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 08:54:20.094136 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 08:54:20.097659 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-05 08:54:20.103832 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-05 08:54:20.111420 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 08:54:20.113076 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-05 08:54:20.114333 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 08:54:20.119629 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 08:54:20.121592 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 08:54:20.122855 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 08:54:20.125890 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.00 seconds
2021-10-05 08:54:20.131711 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-05 08:54:20.133755 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-05 08:54:20.143907 (MainThread): Using postgres connection "master".
2021-10-05 08:54:20.145439 (MainThread): On master: BEGIN
2021-10-05 08:54:20.146743 (MainThread): Opening a new connection, currently in state init
2021-10-05 08:54:20.152173 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 08:54:20.153391 (MainThread): Using postgres connection "master".
2021-10-05 08:54:20.154712 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 08:54:20.162726 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-05 08:54:20.166896 (MainThread): On master: ROLLBACK
2021-10-05 08:54:20.168484 (MainThread): Using postgres connection "master".
2021-10-05 08:54:20.169720 (MainThread): On master: BEGIN
2021-10-05 08:54:20.171571 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 08:54:20.172669 (MainThread): On master: COMMIT
2021-10-05 08:54:20.174208 (MainThread): Using postgres connection "master".
2021-10-05 08:54:20.175218 (MainThread): On master: COMMIT
2021-10-05 08:54:20.176585 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 08:54:20.177771 (MainThread): On master: Close
2021-10-05 08:54:20.179032 (MainThread): 08:54:20 | Concurrency: 2 threads (target='dev')
2021-10-05 08:54:20.180238 (MainThread): 08:54:20 | 
2021-10-05 08:54:20.184251 (Thread-1): Began running node model.my_new_project.citypopulations
2021-10-05 08:54:20.184467 (Thread-2): Began running node model.my_new_project.languagespeakers
2021-10-05 08:54:20.186613 (Thread-1): 08:54:20 | 1 of 2 START view model public.citypopulations....................... [RUN]
2021-10-05 08:54:20.188616 (Thread-2): 08:54:20 | 2 of 2 START table model public.languagespeakers..................... [RUN]
2021-10-05 08:54:20.190141 (Thread-1): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.192647 (Thread-2): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.193625 (Thread-1): Compiling model.my_new_project.citypopulations
2021-10-05 08:54:20.195125 (Thread-2): Compiling model.my_new_project.languagespeakers
2021-10-05 08:54:20.209373 (Thread-1): Writing injected SQL for node "model.my_new_project.citypopulations"
2021-10-05 08:54:20.217900 (Thread-2): Writing injected SQL for node "model.my_new_project.languagespeakers"
2021-10-05 08:54:20.224143 (Thread-1): finished collecting timing info
2021-10-05 08:54:20.224698 (Thread-2): finished collecting timing info
2021-10-05 08:54:20.272450 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.276944 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.277974 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
drop view if exists "world"."public"."citypopulations__dbt_tmp" cascade
2021-10-05 08:54:20.279478 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop table if exists "world"."public"."languagespeakers__dbt_tmp" cascade
2021-10-05 08:54:20.280941 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 08:54:20.282101 (Thread-2): Opening a new connection, currently in state init
2021-10-05 08:54:20.289264 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 08:54:20.293137 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.293303 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-05 08:54:20.294597 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop table if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-05 08:54:20.298319 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.299990 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 08:54:20.300716 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
drop view if exists "world"."public"."citypopulations__dbt_backup" cascade
2021-10-05 08:54:20.308268 (Thread-2): Writing runtime SQL for node "model.my_new_project.languagespeakers"
2021-10-05 08:54:20.309559 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 08:54:20.316426 (Thread-1): Writing runtime SQL for node "model.my_new_project.citypopulations"
2021-10-05 08:54:20.320056 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.321154 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.321301 (Thread-2): On model.my_new_project.languagespeakers: BEGIN
2021-10-05 08:54:20.323113 (Thread-1): On model.my_new_project.citypopulations: BEGIN
2021-10-05 08:54:20.325008 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-05 08:54:20.326458 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 08:54:20.327133 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.328441 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.329698 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */


  create  table "world"."public"."languagespeakers__dbt_tmp"
  as (
    

SELECT RANK() OVER(ORDER BY speakers desc) as ranking,
language,
speakers
FROM(
SELECT cl.language, ROUND(sum(co.population*cl.percentage/100)::decimal, 0) as speakers FROM (
SELECT code, population FROM country
	) co JOIN (
SELECT countrycode, language, percentage FROM "world"."public"."countrylanguage" ) cl
ON co.code = cl.countrycode
GROUP BY cl.language) T
ORDER BY speakers desc
  );
2021-10-05 08:54:20.330807 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */

  create view "world"."public"."citypopulations__dbt_tmp" as (
    SELECT CONCAT(country_name, '|', city_name) id , country_name
, city_name
, ROUND(city_pop/country_pop::decimal, 3)*100 percent_of_country_pop
, RANK() OVER (PARTITION BY country_name ORDER BY city_pop DESC) city_rank_in_country FROM
(
SELECT name city_name, countrycode, population city_pop from city
) c1
JOIN
(
SELECT name country_name, code, population country_pop from country
) co
ON c1.countrycode = co.code
  );

2021-10-05 08:54:20.337735 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-05 08:54:20.347243 (Thread-2): SQL status: SELECT 457 in 0.02 seconds
2021-10-05 08:54:20.348543 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.352947 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.354276 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
alter table "world"."public"."citypopulations" rename to "citypopulations__dbt_backup"
2021-10-05 08:54:20.355662 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers" rename to "languagespeakers__dbt_backup"
2021-10-05 08:54:20.357743 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 08:54:20.358627 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 08:54:20.361634 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.364867 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.366157 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
alter table "world"."public"."citypopulations__dbt_tmp" rename to "citypopulations"
2021-10-05 08:54:20.367521 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
alter table "world"."public"."languagespeakers__dbt_tmp" rename to "languagespeakers"
2021-10-05 08:54:20.370154 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 08:54:20.370910 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 08:54:20.378907 (Thread-1): On model.my_new_project.citypopulations: COMMIT
2021-10-05 08:54:20.381325 (Thread-2): On model.my_new_project.languagespeakers: COMMIT
2021-10-05 08:54:20.382657 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.383947 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.385234 (Thread-1): On model.my_new_project.citypopulations: COMMIT
2021-10-05 08:54:20.386553 (Thread-2): On model.my_new_project.languagespeakers: COMMIT
2021-10-05 08:54:20.390100 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 08:54:20.390816 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-05 08:54:20.394823 (Thread-1): Using postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:20.397888 (Thread-2): Using postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:20.399459 (Thread-1): On model.my_new_project.citypopulations: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.citypopulations"} */
drop view if exists "world"."public"."citypopulations__dbt_backup" cascade
2021-10-05 08:54:20.400912 (Thread-2): On model.my_new_project.languagespeakers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.languagespeakers"} */
drop table if exists "world"."public"."languagespeakers__dbt_backup" cascade
2021-10-05 08:54:20.404320 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 08:54:20.405742 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 08:54:20.408340 (Thread-1): finished collecting timing info
2021-10-05 08:54:20.412320 (Thread-2): finished collecting timing info
2021-10-05 08:54:20.413887 (Thread-1): On model.my_new_project.citypopulations: Close
2021-10-05 08:54:20.415102 (Thread-2): On model.my_new_project.languagespeakers: Close
2021-10-05 08:54:20.416907 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f4fd92-5f8f-44b0-9253-a5fea8eb4f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed04d99d0>]}
2021-10-05 08:54:20.418125 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f4fd92-5f8f-44b0-9253-a5fea8eb4f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed0d59280>]}
2021-10-05 08:54:20.420605 (Thread-1): 08:54:20 | 1 of 2 OK created view model public.citypopulations.................. [CREATE VIEW in 0.23s]
2021-10-05 08:54:20.422853 (Thread-2): 08:54:20 | 2 of 2 OK created table model public.languagespeakers................ [SELECT 457 in 0.23s]
2021-10-05 08:54:20.424228 (Thread-1): Finished running node model.my_new_project.citypopulations
2021-10-05 08:54:20.425321 (Thread-2): Finished running node model.my_new_project.languagespeakers
2021-10-05 08:54:20.429236 (MainThread): Acquiring new postgres connection "master".
2021-10-05 08:54:20.430435 (MainThread): Using postgres connection "master".
2021-10-05 08:54:20.431551 (MainThread): On master: BEGIN
2021-10-05 08:54:20.432682 (MainThread): Opening a new connection, currently in state closed
2021-10-05 08:54:20.438102 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 08:54:20.439621 (MainThread): On master: COMMIT
2021-10-05 08:54:20.441179 (MainThread): Using postgres connection "master".
2021-10-05 08:54:20.442678 (MainThread): On master: COMMIT
2021-10-05 08:54:20.444372 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 08:54:20.445683 (MainThread): On master: Close
2021-10-05 08:54:20.447317 (MainThread): 08:54:20 | 
2021-10-05 08:54:20.448518 (MainThread): 08:54:20 | Finished running 1 view model, 1 table model in 0.38s.
2021-10-05 08:54:20.450010 (MainThread): Connection 'master' was properly closed.
2021-10-05 08:54:20.451287 (MainThread): Connection 'model.my_new_project.citypopulations' was properly closed.
2021-10-05 08:54:20.452985 (MainThread): Connection 'model.my_new_project.languagespeakers' was properly closed.
2021-10-05 08:54:20.496525 (MainThread): 
2021-10-05 08:54:20.497868 (MainThread): Completed successfully
2021-10-05 08:54:20.499243 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-05 08:54:20.500791 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed170d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed15a0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed15cbca0>]}
2021-10-05 08:54:20.502659 (MainThread): Flushing usage events
2021-10-05 08:54:23.084033 (MainThread): Running with dbt=0.19.0
2021-10-05 08:54:23.227314 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 08:54:23.232315 (MainThread): Tracking: tracking
2021-10-05 08:54:23.235786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8adec7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b14ce460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8aded9280>]}
2021-10-05 08:54:23.262268 (MainThread): Partial parsing not enabled
2021-10-05 08:54:23.264874 (MainThread): Parsing macros/adapters.sql
2021-10-05 08:54:23.297791 (MainThread): Parsing macros/catalog.sql
2021-10-05 08:54:23.303099 (MainThread): Parsing macros/relations.sql
2021-10-05 08:54:23.306689 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 08:54:23.311586 (MainThread): Parsing macros/core.sql
2021-10-05 08:54:23.318553 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 08:54:23.333215 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 08:54:23.344424 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 08:54:23.377120 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 08:54:23.387380 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 08:54:23.395356 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 08:54:23.418307 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 08:54:23.428719 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 08:54:23.432411 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 08:54:23.458375 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 08:54:23.462254 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 08:54:23.515020 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 08:54:23.585781 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 08:54:23.589643 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 08:54:23.593671 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 08:54:23.596915 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 08:54:23.601905 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 08:54:23.605474 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 08:54:23.608269 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 08:54:23.611726 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 08:54:23.626135 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 08:54:23.630882 (MainThread): Parsing macros/etc/query.sql
2021-10-05 08:54:23.641341 (MainThread): Partial parsing not enabled
2021-10-05 08:54:23.686289 (MainThread): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 08:54:23.711979 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 08:54:23.738652 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:23.941073 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 08:54:23.947273 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e9898e0-ef99-4ea0-8eb5-191c35616731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8add1a5b0>]}
2021-10-05 08:54:23.992149 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 08:54:23.994381 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-05 08:54:23.997433 (MainThread): 
2021-10-05 08:54:23.999334 (MainThread): Acquiring new postgres connection "master".
2021-10-05 08:54:24.002408 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-05 08:54:24.015827 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-05 08:54:24.017667 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-05 08:54:24.019387 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 08:54:24.026086 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 08:54:24.030325 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-05 08:54:24.036508 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-05 08:54:24.044302 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 08:54:24.045921 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-05 08:54:24.047415 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 08:54:24.052988 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 08:54:24.054170 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 08:54:24.055202 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 08:54:24.058335 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.00 seconds
2021-10-05 08:54:24.064043 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-05 08:54:24.065566 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-05 08:54:24.075212 (MainThread): Using postgres connection "master".
2021-10-05 08:54:24.076741 (MainThread): On master: BEGIN
2021-10-05 08:54:24.077898 (MainThread): Opening a new connection, currently in state init
2021-10-05 08:54:24.083192 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 08:54:24.084528 (MainThread): Using postgres connection "master".
2021-10-05 08:54:24.085947 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 08:54:24.092390 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2021-10-05 08:54:24.096416 (MainThread): On master: ROLLBACK
2021-10-05 08:54:24.098046 (MainThread): Using postgres connection "master".
2021-10-05 08:54:24.099485 (MainThread): On master: BEGIN
2021-10-05 08:54:24.101508 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 08:54:24.102711 (MainThread): On master: COMMIT
2021-10-05 08:54:24.103953 (MainThread): Using postgres connection "master".
2021-10-05 08:54:24.105151 (MainThread): On master: COMMIT
2021-10-05 08:54:24.106725 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 08:54:24.108042 (MainThread): On master: Close
2021-10-05 08:54:24.109749 (MainThread): 08:54:24 | Concurrency: 2 threads (target='dev')
2021-10-05 08:54:24.111193 (MainThread): 08:54:24 | 
2021-10-05 08:54:24.115295 (Thread-1): Began running node snapshot.my_new_project.citypopulations_snapshot
2021-10-05 08:54:24.117675 (Thread-1): 08:54:24 | 1 of 1 START snapshot public.citypopulations_snapshot................ [RUN]
2021-10-05 08:54:24.119104 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:24.120463 (Thread-1): Compiling snapshot.my_new_project.citypopulations_snapshot
2021-10-05 08:54:24.135460 (Thread-1): finished collecting timing info
2021-10-05 08:54:24.172991 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:24.174744 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.citypopulations_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-05 08:54:24.176074 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 08:54:24.183308 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 08:54:24.221380 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:24.223578 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.citypopulations_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-05 08:54:24.226568 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 08:54:24.240613 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.citypopulations_snapshot"
2021-10-05 08:54:24.248139 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:24.249601 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: BEGIN
2021-10-05 08:54:24.251544 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 08:54:24.252812 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:24.254009 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.citypopulations_snapshot"} */

      

  create  table "world"."public"."citypopulations_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast('2021-10-05 08:54:24.181281'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        '2021-10-05 08:54:24.181281'::timestamp without time zone as dbt_updated_at,
        '2021-10-05 08:54:24.181281'::timestamp without time zone as dbt_valid_from,
        nullif('2021-10-05 08:54:24.181281'::timestamp without time zone, '2021-10-05 08:54:24.181281'::timestamp without time zone) as dbt_valid_to
    from (
        



SELECT * FROM citypopulations

    ) sbq


  );
  
2021-10-05 08:54:24.286100 (Thread-1): SQL status: SELECT 4079 in 0.03 seconds
2021-10-05 08:54:24.295083 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: COMMIT
2021-10-05 08:54:24.296658 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 08:54:24.298172 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: COMMIT
2021-10-05 08:54:24.302492 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 08:54:24.305809 (Thread-1): finished collecting timing info
2021-10-05 08:54:24.307645 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: Close
2021-10-05 08:54:24.309708 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e9898e0-ef99-4ea0-8eb5-191c35616731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8add80490>]}
2021-10-05 08:54:24.312435 (Thread-1): 08:54:24 | 1 of 1 OK snapshotted public.citypopulations_snapshot................ [SELECT 4079 in 0.19s]
2021-10-05 08:54:24.313936 (Thread-1): Finished running node snapshot.my_new_project.citypopulations_snapshot
2021-10-05 08:54:24.316958 (MainThread): Acquiring new postgres connection "master".
2021-10-05 08:54:24.318406 (MainThread): Using postgres connection "master".
2021-10-05 08:54:24.319578 (MainThread): On master: BEGIN
2021-10-05 08:54:24.320626 (MainThread): Opening a new connection, currently in state closed
2021-10-05 08:54:24.326222 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 08:54:24.327762 (MainThread): On master: COMMIT
2021-10-05 08:54:24.329258 (MainThread): Using postgres connection "master".
2021-10-05 08:54:24.330642 (MainThread): On master: COMMIT
2021-10-05 08:54:24.332263 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 08:54:24.333896 (MainThread): On master: Close
2021-10-05 08:54:24.335591 (MainThread): 08:54:24 | 
2021-10-05 08:54:24.337194 (MainThread): 08:54:24 | Finished running 1 snapshot in 0.34s.
2021-10-05 08:54:24.339100 (MainThread): Connection 'master' was properly closed.
2021-10-05 08:54:24.340810 (MainThread): Connection 'snapshot.my_new_project.citypopulations_snapshot' was properly closed.
2021-10-05 08:54:24.385117 (MainThread): 
2021-10-05 08:54:24.386370 (MainThread): Completed successfully
2021-10-05 08:54:24.387816 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 08:54:24.389311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8adc9ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8addab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8add80490>]}
2021-10-05 08:54:24.390922 (MainThread): Flushing usage events
2021-10-05 09:05:29.437451 (MainThread): Running with dbt=0.19.0
2021-10-05 09:05:29.588372 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 09:05:29.594945 (MainThread): Tracking: tracking
2021-10-05 09:05:29.598529 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce47b03820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4b10a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce47b14250>]}
2021-10-05 09:05:29.625572 (MainThread): Partial parsing not enabled
2021-10-05 09:05:29.629068 (MainThread): Parsing macros/adapters.sql
2021-10-05 09:05:29.663053 (MainThread): Parsing macros/catalog.sql
2021-10-05 09:05:29.668251 (MainThread): Parsing macros/relations.sql
2021-10-05 09:05:29.671969 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 09:05:29.676824 (MainThread): Parsing macros/core.sql
2021-10-05 09:05:29.683851 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 09:05:29.699915 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 09:05:29.712332 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 09:05:29.747329 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 09:05:29.758715 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 09:05:29.769576 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 09:05:29.800796 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 09:05:29.812122 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 09:05:29.816280 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 09:05:29.843062 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 09:05:29.847066 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 09:05:29.901178 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 09:05:29.974451 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 09:05:29.978564 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 09:05:29.982436 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 09:05:29.985540 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 09:05:29.990645 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 09:05:29.994816 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 09:05:29.997529 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 09:05:30.001021 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 09:05:30.015333 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 09:05:30.019664 (MainThread): Parsing macros/etc/query.sql
2021-10-05 09:05:30.032229 (MainThread): Partial parsing not enabled
2021-10-05 09:05:30.077113 (MainThread): Acquiring new postgres connection "model.my_new_project.citypopulations".
2021-10-05 09:05:30.104007 (MainThread): Acquiring new postgres connection "model.my_new_project.languagespeakers".
2021-10-05 09:05:30.130070 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 09:05:30.335872 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 09:05:30.342291 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41a92935-09c7-4702-a208-4915af8f02c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce47956310>]}
2021-10-05 09:05:30.388611 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 09:05:30.390690 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-05 09:05:30.393523 (MainThread): 
2021-10-05 09:05:30.395681 (MainThread): Acquiring new postgres connection "master".
2021-10-05 09:05:30.399054 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-05 09:05:30.411606 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-05 09:05:30.413486 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-05 09:05:30.414833 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 09:05:30.421052 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 09:05:30.425542 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-05 09:05:30.432624 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-05 09:05:30.440537 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 09:05:30.442058 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-05 09:05:30.443307 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 09:05:30.449104 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 09:05:30.450579 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 09:05:30.451949 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 09:05:30.455271 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 09:05:30.462313 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-05 09:05:30.464402 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-05 09:05:30.478724 (MainThread): Using postgres connection "master".
2021-10-05 09:05:30.480544 (MainThread): On master: BEGIN
2021-10-05 09:05:30.482051 (MainThread): Opening a new connection, currently in state init
2021-10-05 09:05:30.487405 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 09:05:30.488799 (MainThread): Using postgres connection "master".
2021-10-05 09:05:30.490104 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 09:05:30.497215 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-05 09:05:30.501745 (MainThread): On master: ROLLBACK
2021-10-05 09:05:30.503633 (MainThread): Using postgres connection "master".
2021-10-05 09:05:30.505366 (MainThread): On master: BEGIN
2021-10-05 09:05:30.507261 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 09:05:30.508654 (MainThread): On master: COMMIT
2021-10-05 09:05:30.510065 (MainThread): Using postgres connection "master".
2021-10-05 09:05:30.511339 (MainThread): On master: COMMIT
2021-10-05 09:05:30.512851 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 09:05:30.513995 (MainThread): On master: Close
2021-10-05 09:05:30.515556 (MainThread): 09:05:30 | Concurrency: 2 threads (target='dev')
2021-10-05 09:05:30.516948 (MainThread): 09:05:30 | 
2021-10-05 09:05:30.520909 (Thread-1): Began running node snapshot.my_new_project.citypopulations_snapshot
2021-10-05 09:05:30.523288 (Thread-1): 09:05:30 | 1 of 1 START snapshot public.citypopulations_snapshot................ [RUN]
2021-10-05 09:05:30.524822 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 09:05:30.526192 (Thread-1): Compiling snapshot.my_new_project.citypopulations_snapshot
2021-10-05 09:05:30.541566 (Thread-1): finished collecting timing info
2021-10-05 09:05:30.581234 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 09:05:30.583163 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.citypopulations_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-05 09:05:30.584754 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 09:05:30.590920 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 09:05:30.629935 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 09:05:30.632350 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.citypopulations_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-05 09:05:30.634144 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 09:05:30.649337 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 09:05:30.650993 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: BEGIN
2021-10-05 09:05:30.652794 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 09:05:30.654194 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 09:05:30.655940 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.citypopulations_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "world".INFORMATION_SCHEMA.columns
      where table_name = 'citypopulations_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-05 09:05:30.666142 (Thread-1): SQL status: SELECT 9 in 0.01 seconds
2021-10-05 09:05:30.700254 (Thread-1): Using postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 09:05:30.702209 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.citypopulations_snapshot"} */

        

  create temporary table "citypopulations_snapshot__dbt_tmp090530687229"
  as (
    with snapshot_query as (

        



SELECT * FROM citypopulations


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "world"."public"."citypopulations_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-05 09:05:30.590003'::timestamp without time zone as dbt_updated_at,
            '2021-10-05 09:05:30.590003'::timestamp without time zone as dbt_valid_from,
            nullif('2021-10-05 09:05:30.590003'::timestamp without time zone, '2021-10-05 09:05:30.590003'::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast('2021-10-05 09:05:30.590003'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-05 09:05:30.590003'::timestamp without time zone as dbt_updated_at,
            '2021-10-05 09:05:30.590003'::timestamp without time zone as dbt_valid_from,
            '2021-10-05 09:05:30.590003'::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.percentage_of_country_pop != source_data.percentage_of_country_pop
        or
        (
            ((snapshotted_data.percentage_of_country_pop is null) and not (source_data.percentage_of_country_pop is null))
            or
            ((not snapshotted_data.percentage_of_country_pop is null) and (source_data.percentage_of_country_pop is null))
        ) or snapshotted_data.city_rank_in_country != source_data.city_rank_in_country
        or
        (
            ((snapshotted_data.city_rank_in_country is null) and not (source_data.city_rank_in_country is null))
            or
            ((not snapshotted_data.city_rank_in_country is null) and (source_data.city_rank_in_country is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.percentage_of_country_pop != source_data.percentage_of_country_pop
        or
        (
            ((snapshotted_data.percentage_of_country_pop is null) and not (source_data.percentage_of_country_pop is null))
            or
            ((not snapshotted_data.percentage_of_country_pop is null) and (source_data.percentage_of_country_pop is null))
        ) or snapshotted_data.city_rank_in_country != source_data.city_rank_in_country
        or
        (
            ((snapshotted_data.city_rank_in_country is null) and not (source_data.city_rank_in_country is null))
            or
            ((not snapshotted_data.city_rank_in_country is null) and (source_data.city_rank_in_country is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2021-10-05 09:05:30.705807 (Thread-1): Postgres error: column snapshotted_data.percentage_of_country_pop does not exist
LINE 67:                 (snapshotted_data.percentage_of_country_pop ...
                          ^
HINT:  Perhaps you meant to reference the column "snapshotted_data.percent_of_country_pop".

2021-10-05 09:05:30.707447 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: ROLLBACK
2021-10-05 09:05:30.709897 (Thread-1): finished collecting timing info
2021-10-05 09:05:30.711548 (Thread-1): On snapshot.my_new_project.citypopulations_snapshot: Close
2021-10-05 09:05:30.713274 (Thread-1): Database Error in snapshot citypopulations_snapshot (snapshots/citypopulations.sql)
  column snapshotted_data.percentage_of_country_pop does not exist
  LINE 67:                 (snapshotted_data.percentage_of_country_pop ...
                            ^
  HINT:  Perhaps you meant to reference the column "snapshotted_data.percent_of_country_pop".
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column snapshotted_data.percentage_of_country_pop does not exist
LINE 67:                 (snapshotted_data.percentage_of_country_pop ...
                          ^
HINT:  Perhaps you meant to reference the column "snapshotted_data.percent_of_country_pop".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 101, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 48, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in snapshot citypopulations_snapshot (snapshots/citypopulations.sql)
  column snapshotted_data.percentage_of_country_pop does not exist
  LINE 67:                 (snapshotted_data.percentage_of_country_pop ...
                            ^
  HINT:  Perhaps you meant to reference the column "snapshotted_data.percent_of_country_pop".
2021-10-05 09:05:30.717632 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41a92935-09c7-4702-a208-4915af8f02c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4707ddc0>]}
2021-10-05 09:05:30.720548 (Thread-1): 09:05:30 | 1 of 1 ERROR snapshotting public.citypopulations_snapshot............ [ERROR in 0.19s]
2021-10-05 09:05:30.722128 (Thread-1): Finished running node snapshot.my_new_project.citypopulations_snapshot
2021-10-05 09:05:30.728698 (MainThread): Acquiring new postgres connection "master".
2021-10-05 09:05:30.730999 (MainThread): Using postgres connection "master".
2021-10-05 09:05:30.735213 (MainThread): On master: BEGIN
2021-10-05 09:05:30.736933 (MainThread): Opening a new connection, currently in state closed
2021-10-05 09:05:30.743547 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 09:05:30.745284 (MainThread): On master: COMMIT
2021-10-05 09:05:30.746625 (MainThread): Using postgres connection "master".
2021-10-05 09:05:30.748389 (MainThread): On master: COMMIT
2021-10-05 09:05:30.750627 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 09:05:30.751979 (MainThread): On master: Close
2021-10-05 09:05:30.754092 (MainThread): 09:05:30 | 
2021-10-05 09:05:30.755664 (MainThread): 09:05:30 | Finished running 1 snapshot in 0.36s.
2021-10-05 09:05:30.757200 (MainThread): Connection 'master' was properly closed.
2021-10-05 09:05:30.758650 (MainThread): Connection 'snapshot.my_new_project.citypopulations_snapshot' was properly closed.
2021-10-05 09:05:30.803818 (MainThread): 
2021-10-05 09:05:30.805433 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 09:05:30.807126 (MainThread): 
2021-10-05 09:05:30.809325 (MainThread): Database Error in snapshot citypopulations_snapshot (snapshots/citypopulations.sql)
2021-10-05 09:05:30.811327 (MainThread):   column snapshotted_data.percentage_of_country_pop does not exist
2021-10-05 09:05:30.813212 (MainThread):   LINE 67:                 (snapshotted_data.percentage_of_country_pop ...
2021-10-05 09:05:30.814778 (MainThread):                             ^
2021-10-05 09:05:30.816627 (MainThread):   HINT:  Perhaps you meant to reference the column "snapshotted_data.percent_of_country_pop".
2021-10-05 09:05:30.818251 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 09:05:30.820177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce47a05160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce478da1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce47a18550>]}
2021-10-05 09:05:30.821815 (MainThread): Flushing usage events
2021-10-05 14:48:54.763322 (MainThread): Running with dbt=0.19.0
2021-10-05 14:48:54.915609 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 14:48:54.921707 (MainThread): Tracking: tracking
2021-10-05 14:48:54.925419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57574affa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575aab53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57574c1070>]}
2021-10-05 14:48:54.954577 (MainThread): Partial parsing not enabled
2021-10-05 14:48:54.958263 (MainThread): Parsing macros/adapters.sql
2021-10-05 14:48:54.991112 (MainThread): Parsing macros/catalog.sql
2021-10-05 14:48:54.996255 (MainThread): Parsing macros/relations.sql
2021-10-05 14:48:54.999767 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 14:48:55.004723 (MainThread): Parsing macros/core.sql
2021-10-05 14:48:55.011253 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 14:48:55.025712 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 14:48:55.036968 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 14:48:55.069621 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 14:48:55.080383 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 14:48:55.088664 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 14:48:55.112628 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 14:48:55.123191 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 14:48:55.127744 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 14:48:55.153845 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 14:48:55.157718 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 14:48:55.211399 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 14:48:55.283532 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 14:48:55.287579 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 14:48:55.291610 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 14:48:55.294788 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 14:48:55.299790 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 14:48:55.303226 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 14:48:55.305999 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 14:48:55.310044 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 14:48:55.324202 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 14:48:55.328010 (MainThread): Parsing macros/etc/query.sql
2021-10-05 14:48:55.339065 (MainThread): Partial parsing not enabled
2021-10-05 14:48:55.390362 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:48:55.427045 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 14:48:55.643015 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 14:48:55.650216 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '190568b5-6930-4157-9356-bbec238094ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57572f6550>]}
2021-10-05 14:48:55.699936 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 14:48:55.701834 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 8 sources, 0 exposures
2021-10-05 14:48:55.703801 (MainThread): 
2021-10-05 14:48:55.705427 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:48:55.708505 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_world".
2021-10-05 14:48:55.720594 (ThreadPoolExecutor-0_0): Using postgres connection "list_world".
2021-10-05 14:48:55.722339 (ThreadPoolExecutor-0_0): On list_world: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world"} */

    select distinct nspname from pg_namespace
  
2021-10-05 14:48:55.723859 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 14:48:55.730717 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 14:48:55.734425 (ThreadPoolExecutor-0_0): On list_world: Close
2021-10-05 14:48:55.740039 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-05 14:48:55.748267 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 14:48:55.749790 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-05 14:48:55.751261 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 14:48:55.756195 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:48:55.757617 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 14:48:55.758934 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:48:55.762996 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 14:48:55.769431 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-05 14:48:55.770959 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-05 14:48:55.779341 (MainThread): Using postgres connection "master".
2021-10-05 14:48:55.781059 (MainThread): On master: BEGIN
2021-10-05 14:48:55.782461 (MainThread): Opening a new connection, currently in state init
2021-10-05 14:48:55.787807 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:48:55.789199 (MainThread): Using postgres connection "master".
2021-10-05 14:48:55.790322 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 14:48:55.797835 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-05 14:48:55.802036 (MainThread): On master: ROLLBACK
2021-10-05 14:48:55.803813 (MainThread): Using postgres connection "master".
2021-10-05 14:48:55.804997 (MainThread): On master: BEGIN
2021-10-05 14:48:55.807236 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:48:55.808701 (MainThread): On master: COMMIT
2021-10-05 14:48:55.810242 (MainThread): Using postgres connection "master".
2021-10-05 14:48:55.811365 (MainThread): On master: COMMIT
2021-10-05 14:48:55.813050 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:48:55.814459 (MainThread): On master: Close
2021-10-05 14:48:55.816004 (MainThread): 14:48:55 | Concurrency: 2 threads (target='dev')
2021-10-05 14:48:55.817516 (MainThread): 14:48:55 | 
2021-10-05 14:48:55.823031 (Thread-1): Began running node model.my_new_project.first_name_count_price
2021-10-05 14:48:55.825658 (Thread-1): 14:48:55 | 1 of 1 START table model public.first_name_count_price............... [RUN]
2021-10-05 14:48:55.828177 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:48:55.829427 (Thread-1): Compiling model.my_new_project.first_name_count_price
2021-10-05 14:48:55.843680 (Thread-1): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:48:55.850988 (Thread-1): finished collecting timing info
2021-10-05 14:48:55.876771 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:48:55.878590 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "world"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 14:48:55.880035 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 14:48:55.885671 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 14:48:55.889582 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:48:55.890940 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "world"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 14:48:55.892684 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 14:48:55.905018 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:48:55.911465 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:48:55.912896 (Thread-1): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 14:48:55.914824 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:48:55.916257 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:48:55.917490 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "world"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM products GROUP BY firstname
  );
2021-10-05 14:48:55.919666 (Thread-1): Postgres error: relation "products" does not exist
LINE 8: ...firstname, sum(price), count(*) no_of_movies FROM products G...
                                                             ^

2021-10-05 14:48:55.920898 (Thread-1): On model.my_new_project.first_name_count_price: ROLLBACK
2021-10-05 14:48:55.922460 (Thread-1): finished collecting timing info
2021-10-05 14:48:55.923892 (Thread-1): On model.my_new_project.first_name_count_price: Close
2021-10-05 14:48:55.925538 (Thread-1): Database Error in model first_name_count_price (models/first_name_count_price.sql)
  relation "products" does not exist
  LINE 8: ...firstname, sum(price), count(*) no_of_movies FROM products G...
                                                               ^
  compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "products" does not exist
LINE 8: ...firstname, sum(price), count(*) no_of_movies FROM products G...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model first_name_count_price (models/first_name_count_price.sql)
  relation "products" does not exist
  LINE 8: ...firstname, sum(price), count(*) no_of_movies FROM products G...
                                                               ^
  compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
2021-10-05 14:48:55.928981 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190568b5-6930-4157-9356-bbec238094ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57573fa880>]}
2021-10-05 14:48:55.931251 (Thread-1): 14:48:55 | 1 of 1 ERROR creating table model public.first_name_count_price...... [ERROR in 0.10s]
2021-10-05 14:48:55.932551 (Thread-1): Finished running node model.my_new_project.first_name_count_price
2021-10-05 14:48:55.935501 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:48:55.936674 (MainThread): Using postgres connection "master".
2021-10-05 14:48:55.937853 (MainThread): On master: BEGIN
2021-10-05 14:48:55.938946 (MainThread): Opening a new connection, currently in state closed
2021-10-05 14:48:55.944378 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:48:55.946376 (MainThread): On master: COMMIT
2021-10-05 14:48:55.947504 (MainThread): Using postgres connection "master".
2021-10-05 14:48:55.948669 (MainThread): On master: COMMIT
2021-10-05 14:48:55.949918 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:48:55.951010 (MainThread): On master: Close
2021-10-05 14:48:55.952284 (MainThread): 14:48:55 | 
2021-10-05 14:48:55.953474 (MainThread): 14:48:55 | Finished running 1 table model in 0.25s.
2021-10-05 14:48:55.954892 (MainThread): Connection 'master' was properly closed.
2021-10-05 14:48:55.956383 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 14:48:55.998958 (MainThread): 
2021-10-05 14:48:56.000341 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 14:48:56.001671 (MainThread): 
2021-10-05 14:48:56.003218 (MainThread): Database Error in model first_name_count_price (models/first_name_count_price.sql)
2021-10-05 14:48:56.004560 (MainThread):   relation "products" does not exist
2021-10-05 14:48:56.006006 (MainThread):   LINE 8: ...firstname, sum(price), count(*) no_of_movies FROM products G...
2021-10-05 14:48:56.007542 (MainThread):                                                                ^
2021-10-05 14:48:56.008919 (MainThread):   compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
2021-10-05 14:48:56.010391 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 14:48:56.011789 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575747cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5757396a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57573ef8b0>]}
2021-10-05 14:48:56.013282 (MainThread): Flushing usage events
2021-10-05 14:50:29.149005 (MainThread): Running with dbt=0.19.0
2021-10-05 14:50:29.293316 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 14:50:29.298598 (MainThread): Tracking: tracking
2021-10-05 14:50:29.302102 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc138b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc4991460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc139d130>]}
2021-10-05 14:50:29.329558 (MainThread): Partial parsing not enabled
2021-10-05 14:50:29.331893 (MainThread): Parsing macros/adapters.sql
2021-10-05 14:50:29.364850 (MainThread): Parsing macros/catalog.sql
2021-10-05 14:50:29.369370 (MainThread): Parsing macros/relations.sql
2021-10-05 14:50:29.373027 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 14:50:29.377461 (MainThread): Parsing macros/core.sql
2021-10-05 14:50:29.383990 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 14:50:29.398518 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 14:50:29.409598 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 14:50:29.442490 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 14:50:29.453284 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 14:50:29.461628 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 14:50:29.485323 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 14:50:29.495872 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 14:50:29.499759 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 14:50:29.526139 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 14:50:29.530536 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 14:50:29.582944 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 14:50:29.660697 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 14:50:29.664771 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 14:50:29.668992 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 14:50:29.672415 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 14:50:29.677339 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 14:50:29.680863 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 14:50:29.683457 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 14:50:29.686842 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 14:50:29.701455 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 14:50:29.705389 (MainThread): Parsing macros/etc/query.sql
2021-10-05 14:50:29.715429 (MainThread): Partial parsing not enabled
2021-10-05 14:50:29.761957 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:50:29.796505 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.citypopulations_snapshot".
2021-10-05 14:50:30.005695 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 14:50:30.013068 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a207c769-2f31-4844-ac6b-ec46baaf04a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc11b1610>]}
2021-10-05 14:50:30.058144 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 14:50:30.060011 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 8 sources, 0 exposures
2021-10-05 14:50:30.062646 (MainThread): 
2021-10-05 14:50:30.064324 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:50:30.067424 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 14:50:30.079740 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 14:50:30.081212 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 14:50:30.082577 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 14:50:30.089113 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 14:50:30.092815 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 14:50:30.097583 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_world_public".
2021-10-05 14:50:30.098301 (ThreadPoolExecutor-1_1): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 14:50:30.106305 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 14:50:30.108797 (ThreadPoolExecutor-1_1): Using postgres connection "list_dellstore_public".
2021-10-05 14:50:30.110388 (ThreadPoolExecutor-1_0): On list_world_public: BEGIN
2021-10-05 14:50:30.111703 (ThreadPoolExecutor-1_1): On list_dellstore_public: BEGIN
2021-10-05 14:50:30.112809 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 14:50:30.113935 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-10-05 14:50:30.119601 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:50:30.121771 (ThreadPoolExecutor-1_0): Using postgres connection "list_world_public".
2021-10-05 14:50:30.123143 (ThreadPoolExecutor-1_0): On list_world_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_world_public"} */
select
      'world' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'world' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:50:30.122839 (ThreadPoolExecutor-1_1): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:50:30.126966 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-05 14:50:30.127084 (ThreadPoolExecutor-1_1): Using postgres connection "list_dellstore_public".
2021-10-05 14:50:30.135625 (ThreadPoolExecutor-1_0): On list_world_public: ROLLBACK
2021-10-05 14:50:30.136674 (ThreadPoolExecutor-1_1): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:50:30.138607 (ThreadPoolExecutor-1_0): On list_world_public: Close
2021-10-05 14:50:30.143228 (ThreadPoolExecutor-1_1): SQL status: SELECT 8 in 0.00 seconds
2021-10-05 14:50:30.151665 (ThreadPoolExecutor-1_1): On list_dellstore_public: ROLLBACK
2021-10-05 14:50:30.153880 (ThreadPoolExecutor-1_1): On list_dellstore_public: Close
2021-10-05 14:50:30.158282 (MainThread): Connection 'master' was properly closed.
2021-10-05 14:50:30.159492 (MainThread): Connection 'list_world_public' was properly closed.
2021-10-05 14:50:30.160649 (MainThread): Connection 'list_dellstore_public' was properly closed.
2021-10-05 14:50:30.161665 (MainThread): ERROR: Cross-db references not allowed in postgres (world vs dellstore)
2021-10-05 14:50:30.163010 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc1270e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc12f0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc1201970>]}
2021-10-05 14:50:30.164296 (MainThread): Flushing usage events
2021-10-05 14:51:10.549381 (MainThread): Running with dbt=0.19.0
2021-10-05 14:51:10.694747 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 14:51:10.704289 (MainThread): Tracking: tracking
2021-10-05 14:51:10.708020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8890e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a3b9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8891f1c0>]}
2021-10-05 14:51:10.735668 (MainThread): Partial parsing not enabled
2021-10-05 14:51:10.737995 (MainThread): Parsing macros/adapters.sql
2021-10-05 14:51:10.771224 (MainThread): Parsing macros/catalog.sql
2021-10-05 14:51:10.776799 (MainThread): Parsing macros/relations.sql
2021-10-05 14:51:10.780211 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 14:51:10.784667 (MainThread): Parsing macros/core.sql
2021-10-05 14:51:10.791282 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 14:51:10.805729 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 14:51:10.816690 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 14:51:10.849185 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 14:51:10.859727 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 14:51:10.867874 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 14:51:10.896660 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 14:51:10.907801 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 14:51:10.911697 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 14:51:10.937663 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 14:51:10.941516 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 14:51:10.993862 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 14:51:11.064631 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 14:51:11.068537 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 14:51:11.072502 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 14:51:11.075942 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 14:51:11.080892 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 14:51:11.084471 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 14:51:11.087020 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 14:51:11.090549 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 14:51:11.105273 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 14:51:11.109341 (MainThread): Parsing macros/etc/query.sql
2021-10-05 14:51:11.119984 (MainThread): Partial parsing not enabled
2021-10-05 14:51:11.164145 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.368361 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 14:51:11.374686 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba87971-0ddd-4be2-9079-14868f01375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8879c430>]}
2021-10-05 14:51:11.415786 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 14:51:11.417793 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 8 sources, 0 exposures
2021-10-05 14:51:11.419969 (MainThread): 
2021-10-05 14:51:11.421391 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:51:11.424282 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 14:51:11.436147 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 14:51:11.437959 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 14:51:11.439408 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 14:51:11.446094 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 14:51:11.449999 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 14:51:11.453724 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 14:51:11.461917 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:51:11.464022 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 14:51:11.465379 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 14:51:11.471375 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:51:11.473046 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:51:11.474631 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:51:11.478401 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-05 14:51:11.486310 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 14:51:11.487841 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 14:51:11.495799 (MainThread): Using postgres connection "master".
2021-10-05 14:51:11.497238 (MainThread): On master: BEGIN
2021-10-05 14:51:11.498304 (MainThread): Opening a new connection, currently in state init
2021-10-05 14:51:11.503509 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:51:11.504839 (MainThread): Using postgres connection "master".
2021-10-05 14:51:11.505907 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 14:51:11.524227 (MainThread): SQL status: SELECT 0 in 0.02 seconds
2021-10-05 14:51:11.526892 (MainThread): On master: ROLLBACK
2021-10-05 14:51:11.528613 (MainThread): Using postgres connection "master".
2021-10-05 14:51:11.529871 (MainThread): On master: BEGIN
2021-10-05 14:51:11.531685 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:51:11.533050 (MainThread): On master: COMMIT
2021-10-05 14:51:11.534242 (MainThread): Using postgres connection "master".
2021-10-05 14:51:11.535408 (MainThread): On master: COMMIT
2021-10-05 14:51:11.536914 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:51:11.538217 (MainThread): On master: Close
2021-10-05 14:51:11.539700 (MainThread): 14:51:11 | Concurrency: 2 threads (target='dev')
2021-10-05 14:51:11.541064 (MainThread): 14:51:11 | 
2021-10-05 14:51:11.545260 (Thread-1): Began running node model.my_new_project.first_name_count_price
2021-10-05 14:51:11.548370 (Thread-1): 14:51:11 | 1 of 1 START table model public.first_name_count_price............... [RUN]
2021-10-05 14:51:11.550362 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.551861 (Thread-1): Compiling model.my_new_project.first_name_count_price
2021-10-05 14:51:11.570846 (Thread-1): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:51:11.578170 (Thread-1): finished collecting timing info
2021-10-05 14:51:11.604275 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.606101 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 14:51:11.607640 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 14:51:11.613582 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 14:51:11.617470 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.618772 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 14:51:11.620532 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 14:51:11.637106 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:51:11.642332 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.643874 (Thread-1): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 14:51:11.645914 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:51:11.647557 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.648963 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM products GROUP BY firstname
  );
2021-10-05 14:51:11.666124 (Thread-1): SQL status: SELECT 200 in 0.02 seconds
2021-10-05 14:51:11.673991 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.675640 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price__dbt_tmp" rename to "first_name_count_price"
2021-10-05 14:51:11.677571 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 14:51:11.685478 (Thread-1): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 14:51:11.687560 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.689150 (Thread-1): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 14:51:11.692194 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:51:11.697250 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:51:11.698676 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 14:51:11.700372 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 14:51:11.704167 (Thread-1): finished collecting timing info
2021-10-05 14:51:11.705767 (Thread-1): On model.my_new_project.first_name_count_price: Close
2021-10-05 14:51:11.709094 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba87971-0ddd-4be2-9079-14868f01375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e887e78e0>]}
2021-10-05 14:51:11.711775 (Thread-1): 14:51:11 | 1 of 1 OK created table model public.first_name_count_price.......... [SELECT 200 in 0.16s]
2021-10-05 14:51:11.713345 (Thread-1): Finished running node model.my_new_project.first_name_count_price
2021-10-05 14:51:11.716404 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:51:11.717894 (MainThread): Using postgres connection "master".
2021-10-05 14:51:11.719141 (MainThread): On master: BEGIN
2021-10-05 14:51:11.720331 (MainThread): Opening a new connection, currently in state closed
2021-10-05 14:51:11.725377 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:51:11.726901 (MainThread): On master: COMMIT
2021-10-05 14:51:11.728145 (MainThread): Using postgres connection "master".
2021-10-05 14:51:11.729564 (MainThread): On master: COMMIT
2021-10-05 14:51:11.731241 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:51:11.732376 (MainThread): On master: Close
2021-10-05 14:51:11.733819 (MainThread): 14:51:11 | 
2021-10-05 14:51:11.734965 (MainThread): 14:51:11 | Finished running 1 table model in 0.31s.
2021-10-05 14:51:11.736615 (MainThread): Connection 'master' was properly closed.
2021-10-05 14:51:11.738634 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 14:51:11.776458 (MainThread): 
2021-10-05 14:51:11.777857 (MainThread): Completed successfully
2021-10-05 14:51:11.779207 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 14:51:11.780911 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8875b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e887cfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e887b0220>]}
2021-10-05 14:51:11.782941 (MainThread): Flushing usage events
2021-10-05 14:52:42.329748 (MainThread): Running with dbt=0.19.0
2021-10-05 14:52:42.473911 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 14:52:42.480653 (MainThread): Tracking: tracking
2021-10-05 14:52:42.484252 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1649d69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f164d3703a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1649d7b070>]}
2021-10-05 14:52:42.513716 (MainThread): Partial parsing not enabled
2021-10-05 14:52:42.517197 (MainThread): Parsing macros/adapters.sql
2021-10-05 14:52:42.550786 (MainThread): Parsing macros/catalog.sql
2021-10-05 14:52:42.556128 (MainThread): Parsing macros/relations.sql
2021-10-05 14:52:42.560405 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 14:52:42.565616 (MainThread): Parsing macros/core.sql
2021-10-05 14:52:42.572431 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 14:52:42.586852 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 14:52:42.597703 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 14:52:42.630361 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 14:52:42.640741 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 14:52:42.648870 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 14:52:42.677421 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 14:52:42.687056 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 14:52:42.690713 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 14:52:42.716588 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 14:52:42.720417 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 14:52:42.773239 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 14:52:42.845517 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 14:52:42.849670 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 14:52:42.853723 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 14:52:42.856970 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 14:52:42.861864 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 14:52:42.865075 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 14:52:42.867500 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 14:52:42.870805 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 14:52:42.886287 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 14:52:42.890389 (MainThread): Parsing macros/etc/query.sql
2021-10-05 14:52:42.901425 (MainThread): Partial parsing not enabled
2021-10-05 14:52:42.948039 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:52:43.140238 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 14:52:43.146507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3affdbdd-9fbf-4c18-95e4-0bb8f4e39397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1649b8bbb0>]}
2021-10-05 14:52:43.189697 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 14:52:43.191885 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 8 sources, 0 exposures
2021-10-05 14:52:43.194016 (MainThread): 
2021-10-05 14:52:43.196249 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:52:43.199201 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 14:52:43.212375 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 14:52:43.214053 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 14:52:43.216525 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 14:52:43.224058 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 14:52:43.227984 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 14:52:43.231371 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 14:52:43.238748 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:52:43.240223 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 14:52:43.241710 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 14:52:43.247658 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:52:43.249246 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:52:43.250588 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:52:43.253806 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 14:52:43.262427 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 14:52:43.264105 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 14:52:43.270945 (MainThread): Using postgres connection "master".
2021-10-05 14:52:43.272319 (MainThread): On master: BEGIN
2021-10-05 14:52:43.273332 (MainThread): Opening a new connection, currently in state init
2021-10-05 14:52:43.278712 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:52:43.280137 (MainThread): Using postgres connection "master".
2021-10-05 14:52:43.281447 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 14:52:43.288357 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 14:52:43.290071 (MainThread): On master: ROLLBACK
2021-10-05 14:52:43.291441 (MainThread): Using postgres connection "master".
2021-10-05 14:52:43.292684 (MainThread): On master: BEGIN
2021-10-05 14:52:43.294461 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:52:43.295554 (MainThread): On master: COMMIT
2021-10-05 14:52:43.296868 (MainThread): Using postgres connection "master".
2021-10-05 14:52:43.298185 (MainThread): On master: COMMIT
2021-10-05 14:52:43.299795 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:52:43.301128 (MainThread): On master: Close
2021-10-05 14:52:43.302732 (MainThread): 14:52:43 | Concurrency: 2 threads (target='dev')
2021-10-05 14:52:43.304292 (MainThread): 14:52:43 | 
2021-10-05 14:52:43.308379 (Thread-1): Began running node model.my_new_project.first_name_count_price
2021-10-05 14:52:43.311365 (Thread-1): 14:52:43 | 1 of 1 START table model public.first_name_count_price............... [RUN]
2021-10-05 14:52:43.312969 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:52:43.314230 (Thread-1): Compiling model.my_new_project.first_name_count_price
2021-10-05 14:52:43.332843 (Thread-1): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:52:43.337047 (Thread-1): finished collecting timing info
2021-10-05 14:52:43.362650 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:52:43.364530 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 14:52:43.365708 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 14:52:43.370933 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 14:52:43.374536 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:52:43.375691 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 14:52:43.377317 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 14:52:43.389407 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:52:43.394241 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:52:43.395475 (Thread-1): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 14:52:43.396990 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:52:43.398129 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:52:43.399201 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM source("movie_dataset", "products") GROUP BY firstname
  );
2021-10-05 14:52:43.400771 (Thread-1): Postgres error: column "movie_dataset" does not exist
LINE 8: ...me, sum(price), count(*) no_of_movies FROM source("movie_dat...
                                                             ^

2021-10-05 14:52:43.402682 (Thread-1): On model.my_new_project.first_name_count_price: ROLLBACK
2021-10-05 14:52:43.404211 (Thread-1): finished collecting timing info
2021-10-05 14:52:43.405616 (Thread-1): On model.my_new_project.first_name_count_price: Close
2021-10-05 14:52:43.407075 (Thread-1): Database Error in model first_name_count_price (models/first_name_count_price.sql)
  column "movie_dataset" does not exist
  LINE 8: ...me, sum(price), count(*) no_of_movies FROM source("movie_dat...
                                                               ^
  compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "movie_dataset" does not exist
LINE 8: ...me, sum(price), count(*) no_of_movies FROM source("movie_dat...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model first_name_count_price (models/first_name_count_price.sql)
  column "movie_dataset" does not exist
  LINE 8: ...me, sum(price), count(*) no_of_movies FROM source("movie_dat...
                                                               ^
  compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
2021-10-05 14:52:43.410292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3affdbdd-9fbf-4c18-95e4-0bb8f4e39397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1649be3eb0>]}
2021-10-05 14:52:43.412590 (Thread-1): 14:52:43 | 1 of 1 ERROR creating table model public.first_name_count_price...... [ERROR in 0.10s]
2021-10-05 14:52:43.413754 (Thread-1): Finished running node model.my_new_project.first_name_count_price
2021-10-05 14:52:43.416504 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:52:43.417725 (MainThread): Using postgres connection "master".
2021-10-05 14:52:43.418948 (MainThread): On master: BEGIN
2021-10-05 14:52:43.420181 (MainThread): Opening a new connection, currently in state closed
2021-10-05 14:52:43.425938 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:52:43.427611 (MainThread): On master: COMMIT
2021-10-05 14:52:43.429021 (MainThread): Using postgres connection "master".
2021-10-05 14:52:43.430330 (MainThread): On master: COMMIT
2021-10-05 14:52:43.431729 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:52:43.433181 (MainThread): On master: Close
2021-10-05 14:52:43.435529 (MainThread): 14:52:43 | 
2021-10-05 14:52:43.436851 (MainThread): 14:52:43 | Finished running 1 table model in 0.24s.
2021-10-05 14:52:43.438205 (MainThread): Connection 'master' was properly closed.
2021-10-05 14:52:43.439639 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 14:52:43.477636 (MainThread): 
2021-10-05 14:52:43.479192 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 14:52:43.480862 (MainThread): 
2021-10-05 14:52:43.482638 (MainThread): Database Error in model first_name_count_price (models/first_name_count_price.sql)
2021-10-05 14:52:43.484538 (MainThread):   column "movie_dataset" does not exist
2021-10-05 14:52:43.486167 (MainThread):   LINE 8: ...me, sum(price), count(*) no_of_movies FROM source("movie_dat...
2021-10-05 14:52:43.487724 (MainThread):                                                                ^
2021-10-05 14:52:43.489150 (MainThread):   compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
2021-10-05 14:52:43.490653 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 14:52:43.492039 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1649c3a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1649cba5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1649be1760>]}
2021-10-05 14:52:43.493464 (MainThread): Flushing usage events
2021-10-05 14:53:24.958636 (MainThread): Running with dbt=0.19.0
2021-10-05 14:53:25.101002 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 14:53:25.107625 (MainThread): Tracking: tracking
2021-10-05 14:53:25.112576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cde1d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cf8482b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cde2f190>]}
2021-10-05 14:53:25.147361 (MainThread): Partial parsing not enabled
2021-10-05 14:53:25.150371 (MainThread): Parsing macros/adapters.sql
2021-10-05 14:53:25.187056 (MainThread): Parsing macros/catalog.sql
2021-10-05 14:53:25.192309 (MainThread): Parsing macros/relations.sql
2021-10-05 14:53:25.195967 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 14:53:25.200576 (MainThread): Parsing macros/core.sql
2021-10-05 14:53:25.207166 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 14:53:25.221422 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 14:53:25.232470 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 14:53:25.265365 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 14:53:25.276147 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 14:53:25.289100 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 14:53:25.312603 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 14:53:25.322321 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 14:53:25.325979 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 14:53:25.353015 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 14:53:25.357138 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 14:53:25.411093 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 14:53:25.483019 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 14:53:25.487235 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 14:53:25.491165 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 14:53:25.494559 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 14:53:25.499513 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 14:53:25.503070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 14:53:25.505724 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 14:53:25.509372 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 14:53:25.523767 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 14:53:25.527691 (MainThread): Parsing macros/etc/query.sql
2021-10-05 14:53:25.538721 (MainThread): Partial parsing not enabled
2021-10-05 14:53:25.585580 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:53:25.775271 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 14:53:25.781508 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f22ed19-3aaa-4b6e-a130-da8568d9ada7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cdc93730>]}
2021-10-05 14:53:25.823372 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 14:53:25.825329 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 8 sources, 0 exposures
2021-10-05 14:53:25.827420 (MainThread): 
2021-10-05 14:53:25.828918 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:53:25.831793 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 14:53:25.843519 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 14:53:25.845218 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 14:53:25.847161 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 14:53:25.854101 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 14:53:25.858694 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 14:53:25.862285 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 14:53:25.869877 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:53:25.871394 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 14:53:25.872856 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 14:53:25.878874 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:53:25.880726 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:53:25.881774 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:53:25.886781 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 14:53:25.895492 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 14:53:25.897276 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 14:53:25.904403 (MainThread): Using postgres connection "master".
2021-10-05 14:53:25.905791 (MainThread): On master: BEGIN
2021-10-05 14:53:25.907378 (MainThread): Opening a new connection, currently in state init
2021-10-05 14:53:25.912559 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:53:25.913793 (MainThread): Using postgres connection "master".
2021-10-05 14:53:25.915202 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 14:53:25.921629 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 14:53:25.923273 (MainThread): On master: ROLLBACK
2021-10-05 14:53:25.924661 (MainThread): Using postgres connection "master".
2021-10-05 14:53:25.925719 (MainThread): On master: BEGIN
2021-10-05 14:53:25.927533 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:53:25.928801 (MainThread): On master: COMMIT
2021-10-05 14:53:25.930042 (MainThread): Using postgres connection "master".
2021-10-05 14:53:25.931299 (MainThread): On master: COMMIT
2021-10-05 14:53:25.932731 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:53:25.933949 (MainThread): On master: Close
2021-10-05 14:53:25.935632 (MainThread): 14:53:25 | Concurrency: 2 threads (target='dev')
2021-10-05 14:53:25.937017 (MainThread): 14:53:25 | 
2021-10-05 14:53:25.940838 (Thread-1): Began running node model.my_new_project.first_name_count_price
2021-10-05 14:53:25.943728 (Thread-1): 14:53:25 | 1 of 1 START table model public.first_name_count_price............... [RUN]
2021-10-05 14:53:25.945202 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:53:25.946340 (Thread-1): Compiling model.my_new_project.first_name_count_price
2021-10-05 14:53:25.964647 (Thread-1): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:53:25.969670 (Thread-1): finished collecting timing info
2021-10-05 14:53:25.998166 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:53:26.000086 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 14:53:26.001610 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 14:53:26.007306 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 14:53:26.010916 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:53:26.012172 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 14:53:26.013861 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 14:53:26.025865 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:53:26.030621 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:53:26.032437 (Thread-1): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 14:53:26.034026 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:53:26.035196 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:53:26.036508 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM sources("movie_dataset", "products") GROUP BY firstname
  );
2021-10-05 14:53:26.038098 (Thread-1): Postgres error: column "movie_dataset" does not exist
LINE 8: ...e, sum(price), count(*) no_of_movies FROM sources("movie_dat...
                                                             ^

2021-10-05 14:53:26.039941 (Thread-1): On model.my_new_project.first_name_count_price: ROLLBACK
2021-10-05 14:53:26.041539 (Thread-1): finished collecting timing info
2021-10-05 14:53:26.042968 (Thread-1): On model.my_new_project.first_name_count_price: Close
2021-10-05 14:53:26.044467 (Thread-1): Database Error in model first_name_count_price (models/first_name_count_price.sql)
  column "movie_dataset" does not exist
  LINE 8: ...e, sum(price), count(*) no_of_movies FROM sources("movie_dat...
                                                               ^
  compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "movie_dataset" does not exist
LINE 8: ...e, sum(price), count(*) no_of_movies FROM sources("movie_dat...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model first_name_count_price (models/first_name_count_price.sql)
  column "movie_dataset" does not exist
  LINE 8: ...e, sum(price), count(*) no_of_movies FROM sources("movie_dat...
                                                               ^
  compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
2021-10-05 14:53:26.047710 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f22ed19-3aaa-4b6e-a130-da8568d9ada7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cdd20ee0>]}
2021-10-05 14:53:26.050083 (Thread-1): 14:53:26 | 1 of 1 ERROR creating table model public.first_name_count_price...... [ERROR in 0.10s]
2021-10-05 14:53:26.051369 (Thread-1): Finished running node model.my_new_project.first_name_count_price
2021-10-05 14:53:26.054028 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:53:26.055241 (MainThread): Using postgres connection "master".
2021-10-05 14:53:26.056286 (MainThread): On master: BEGIN
2021-10-05 14:53:26.057332 (MainThread): Opening a new connection, currently in state closed
2021-10-05 14:53:26.062406 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:53:26.063925 (MainThread): On master: COMMIT
2021-10-05 14:53:26.065280 (MainThread): Using postgres connection "master".
2021-10-05 14:53:26.066535 (MainThread): On master: COMMIT
2021-10-05 14:53:26.068107 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:53:26.069386 (MainThread): On master: Close
2021-10-05 14:53:26.070826 (MainThread): 14:53:26 | 
2021-10-05 14:53:26.072122 (MainThread): 14:53:26 | Finished running 1 table model in 0.24s.
2021-10-05 14:53:26.073621 (MainThread): Connection 'master' was properly closed.
2021-10-05 14:53:26.075160 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 14:53:26.116377 (MainThread): 
2021-10-05 14:53:26.118082 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 14:53:26.119940 (MainThread): 
2021-10-05 14:53:26.121887 (MainThread): Database Error in model first_name_count_price (models/first_name_count_price.sql)
2021-10-05 14:53:26.123772 (MainThread):   column "movie_dataset" does not exist
2021-10-05 14:53:26.125413 (MainThread):   LINE 8: ...e, sum(price), count(*) no_of_movies FROM sources("movie_dat...
2021-10-05 14:53:26.127194 (MainThread):                                                                ^
2021-10-05 14:53:26.128955 (MainThread):   compiled SQL at target/run/my_new_project/models/first_name_count_price.sql
2021-10-05 14:53:26.131331 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 14:53:26.135915 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cdca3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cdcddc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cdcbea60>]}
2021-10-05 14:53:26.138296 (MainThread): Flushing usage events
2021-10-05 14:53:59.795325 (MainThread): Running with dbt=0.19.0
2021-10-05 14:53:59.935899 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 14:53:59.940385 (MainThread): Tracking: tracking
2021-10-05 14:53:59.945097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3b82c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3d258280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3b83d160>]}
2021-10-05 14:53:59.972466 (MainThread): Partial parsing not enabled
2021-10-05 14:53:59.974855 (MainThread): Parsing macros/adapters.sql
2021-10-05 14:54:00.007010 (MainThread): Parsing macros/catalog.sql
2021-10-05 14:54:00.011803 (MainThread): Parsing macros/relations.sql
2021-10-05 14:54:00.015392 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 14:54:00.020511 (MainThread): Parsing macros/core.sql
2021-10-05 14:54:00.027479 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 14:54:00.041686 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 14:54:00.052931 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 14:54:00.085834 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 14:54:00.096027 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 14:54:00.104018 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 14:54:00.129170 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 14:54:00.140054 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 14:54:00.144319 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 14:54:00.172319 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 14:54:00.176414 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 14:54:00.230657 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 14:54:00.303128 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 14:54:00.307072 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 14:54:00.310832 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 14:54:00.313940 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 14:54:00.318832 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 14:54:00.322534 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 14:54:00.325289 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 14:54:00.329056 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 14:54:00.343391 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 14:54:00.347445 (MainThread): Parsing macros/etc/query.sql
2021-10-05 14:54:00.359715 (MainThread): Partial parsing not enabled
2021-10-05 14:54:00.408501 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:00.603235 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 14:54:00.613870 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c52fca9-527b-4a47-a045-79326f93e5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3b6a45e0>]}
2021-10-05 14:54:00.656023 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 14:54:00.658153 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 8 sources, 0 exposures
2021-10-05 14:54:00.660642 (MainThread): 
2021-10-05 14:54:00.662973 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:54:00.667876 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 14:54:00.679976 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 14:54:00.681827 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 14:54:00.683730 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 14:54:00.689773 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 14:54:00.693689 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 14:54:00.697329 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 14:54:00.704882 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:54:00.706102 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 14:54:00.707441 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 14:54:00.712831 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:54:00.714307 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:54:00.715409 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:54:00.718550 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 14:54:00.727372 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 14:54:00.729131 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 14:54:00.736212 (MainThread): Using postgres connection "master".
2021-10-05 14:54:00.737746 (MainThread): On master: BEGIN
2021-10-05 14:54:00.739148 (MainThread): Opening a new connection, currently in state init
2021-10-05 14:54:00.744988 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:54:00.746495 (MainThread): Using postgres connection "master".
2021-10-05 14:54:00.747773 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 14:54:00.754417 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 14:54:00.756050 (MainThread): On master: ROLLBACK
2021-10-05 14:54:00.757736 (MainThread): Using postgres connection "master".
2021-10-05 14:54:00.758992 (MainThread): On master: BEGIN
2021-10-05 14:54:00.760727 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:54:00.762006 (MainThread): On master: COMMIT
2021-10-05 14:54:00.763171 (MainThread): Using postgres connection "master".
2021-10-05 14:54:00.764370 (MainThread): On master: COMMIT
2021-10-05 14:54:00.765870 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:54:00.767087 (MainThread): On master: Close
2021-10-05 14:54:00.768599 (MainThread): 14:54:00 | Concurrency: 2 threads (target='dev')
2021-10-05 14:54:00.770421 (MainThread): 14:54:00 | 
2021-10-05 14:54:00.774158 (Thread-1): Began running node model.my_new_project.first_name_count_price
2021-10-05 14:54:00.777246 (Thread-1): 14:54:00 | 1 of 1 START table model public.first_name_count_price............... [RUN]
2021-10-05 14:54:00.779085 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:00.780353 (Thread-1): Compiling model.my_new_project.first_name_count_price
2021-10-05 14:54:00.798916 (Thread-1): finished collecting timing info
2021-10-05 14:54:00.801008 (Thread-1): Compilation Error in model first_name_count_price (models/first_name_count_price.sql)
  'sources' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 5, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'sources' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model first_name_count_price (models/first_name_count_price.sql)
  'sources' is undefined
2021-10-05 14:54:00.806831 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c52fca9-527b-4a47-a045-79326f93e5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3b689dc0>]}
2021-10-05 14:54:00.809202 (Thread-1): 14:54:00 | 1 of 1 ERROR creating table model public.first_name_count_price...... [ERROR in 0.03s]
2021-10-05 14:54:00.810565 (Thread-1): Finished running node model.my_new_project.first_name_count_price
2021-10-05 14:54:00.813608 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:54:00.814934 (MainThread): Using postgres connection "master".
2021-10-05 14:54:00.816046 (MainThread): On master: BEGIN
2021-10-05 14:54:00.817147 (MainThread): Opening a new connection, currently in state closed
2021-10-05 14:54:00.823494 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:54:00.825139 (MainThread): On master: COMMIT
2021-10-05 14:54:00.826691 (MainThread): Using postgres connection "master".
2021-10-05 14:54:00.828165 (MainThread): On master: COMMIT
2021-10-05 14:54:00.830058 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:54:00.831467 (MainThread): On master: Close
2021-10-05 14:54:00.833336 (MainThread): 14:54:00 | 
2021-10-05 14:54:00.834839 (MainThread): 14:54:00 | Finished running 1 table model in 0.17s.
2021-10-05 14:54:00.836186 (MainThread): Connection 'master' was properly closed.
2021-10-05 14:54:00.837691 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 14:54:00.879545 (MainThread): 
2021-10-05 14:54:00.881175 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 14:54:00.882791 (MainThread): 
2021-10-05 14:54:00.884558 (MainThread): Compilation Error in model first_name_count_price (models/first_name_count_price.sql)
2021-10-05 14:54:00.886322 (MainThread):   'sources' is undefined
2021-10-05 14:54:00.888433 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 14:54:00.890147 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3b665250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3b6a49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3b6cd1c0>]}
2021-10-05 14:54:00.891955 (MainThread): Flushing usage events
2021-10-05 14:54:16.418662 (MainThread): Running with dbt=0.19.0
2021-10-05 14:54:16.560642 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 14:54:16.565289 (MainThread): Tracking: tracking
2021-10-05 14:54:16.569061 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0721d0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa073c7b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0721e21f0>]}
2021-10-05 14:54:16.597535 (MainThread): Partial parsing not enabled
2021-10-05 14:54:16.601094 (MainThread): Parsing macros/adapters.sql
2021-10-05 14:54:16.634078 (MainThread): Parsing macros/catalog.sql
2021-10-05 14:54:16.639524 (MainThread): Parsing macros/relations.sql
2021-10-05 14:54:16.643447 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 14:54:16.648825 (MainThread): Parsing macros/core.sql
2021-10-05 14:54:16.656030 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 14:54:16.670807 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 14:54:16.682737 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 14:54:16.716277 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 14:54:16.727238 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 14:54:16.735702 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 14:54:16.760193 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 14:54:16.770111 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 14:54:16.773963 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 14:54:16.799542 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 14:54:16.803325 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 14:54:16.856120 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 14:54:16.927918 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 14:54:16.931759 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 14:54:16.935612 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 14:54:16.938799 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 14:54:16.944046 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 14:54:16.948464 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 14:54:16.951067 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 14:54:16.954536 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 14:54:16.968939 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 14:54:16.972774 (MainThread): Parsing macros/etc/query.sql
2021-10-05 14:54:16.983060 (MainThread): Partial parsing not enabled
2021-10-05 14:54:17.029646 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.238137 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 14:54:17.244689 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47467987-cbfd-4549-afde-ad141b4bc370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07200b5e0>]}
2021-10-05 14:54:17.286183 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 14:54:17.288387 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 8 sources, 0 exposures
2021-10-05 14:54:17.290618 (MainThread): 
2021-10-05 14:54:17.292166 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:54:17.295124 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 14:54:17.307122 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 14:54:17.308792 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 14:54:17.310558 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 14:54:17.319150 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 14:54:17.322990 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 14:54:17.327433 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 14:54:17.335481 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:54:17.337025 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 14:54:17.338384 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 14:54:17.343773 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:54:17.345221 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 14:54:17.346503 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 14:54:17.349693 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 14:54:17.358732 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 14:54:17.360434 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 14:54:17.367368 (MainThread): Using postgres connection "master".
2021-10-05 14:54:17.368760 (MainThread): On master: BEGIN
2021-10-05 14:54:17.370013 (MainThread): Opening a new connection, currently in state init
2021-10-05 14:54:17.375943 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:54:17.377369 (MainThread): Using postgres connection "master".
2021-10-05 14:54:17.378657 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 14:54:17.385342 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-05 14:54:17.387000 (MainThread): On master: ROLLBACK
2021-10-05 14:54:17.388658 (MainThread): Using postgres connection "master".
2021-10-05 14:54:17.389814 (MainThread): On master: BEGIN
2021-10-05 14:54:17.391677 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:54:17.393032 (MainThread): On master: COMMIT
2021-10-05 14:54:17.394265 (MainThread): Using postgres connection "master".
2021-10-05 14:54:17.395462 (MainThread): On master: COMMIT
2021-10-05 14:54:17.396988 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:54:17.398260 (MainThread): On master: Close
2021-10-05 14:54:17.399850 (MainThread): 14:54:17 | Concurrency: 2 threads (target='dev')
2021-10-05 14:54:17.401164 (MainThread): 14:54:17 | 
2021-10-05 14:54:17.405069 (Thread-1): Began running node model.my_new_project.first_name_count_price
2021-10-05 14:54:17.408235 (Thread-1): 14:54:17 | 1 of 1 START table model public.first_name_count_price............... [RUN]
2021-10-05 14:54:17.410248 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.411704 (Thread-1): Compiling model.my_new_project.first_name_count_price
2021-10-05 14:54:17.431584 (Thread-1): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:54:17.436030 (Thread-1): finished collecting timing info
2021-10-05 14:54:17.461889 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.463764 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 14:54:17.465205 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 14:54:17.471334 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 14:54:17.475126 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.476449 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 14:54:17.478137 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 14:54:17.490352 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 14:54:17.494833 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.496147 (Thread-1): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 14:54:17.497946 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 14:54:17.499146 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.500369 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM "dellstore"."public"."products" GROUP BY firstname
  );
2021-10-05 14:54:17.512227 (Thread-1): SQL status: SELECT 200 in 0.01 seconds
2021-10-05 14:54:17.521533 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.522992 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price" rename to "first_name_count_price__dbt_backup"
2021-10-05 14:54:17.525479 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 14:54:17.529278 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.530770 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price__dbt_tmp" rename to "first_name_count_price"
2021-10-05 14:54:17.532720 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 14:54:17.540967 (Thread-1): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 14:54:17.542421 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.543700 (Thread-1): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 14:54:17.546087 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:54:17.550606 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 14:54:17.552199 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 14:54:17.558422 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 14:54:17.562372 (Thread-1): finished collecting timing info
2021-10-05 14:54:17.563820 (Thread-1): On model.my_new_project.first_name_count_price: Close
2021-10-05 14:54:17.565729 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47467987-cbfd-4549-afde-ad141b4bc370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa072049ca0>]}
2021-10-05 14:54:17.568245 (Thread-1): 14:54:17 | 1 of 1 OK created table model public.first_name_count_price.......... [SELECT 200 in 0.16s]
2021-10-05 14:54:17.571855 (Thread-1): Finished running node model.my_new_project.first_name_count_price
2021-10-05 14:54:17.577474 (MainThread): Acquiring new postgres connection "master".
2021-10-05 14:54:17.581121 (MainThread): Using postgres connection "master".
2021-10-05 14:54:17.583823 (MainThread): On master: BEGIN
2021-10-05 14:54:17.585521 (MainThread): Opening a new connection, currently in state closed
2021-10-05 14:54:17.591509 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 14:54:17.593318 (MainThread): On master: COMMIT
2021-10-05 14:54:17.594620 (MainThread): Using postgres connection "master".
2021-10-05 14:54:17.595781 (MainThread): On master: COMMIT
2021-10-05 14:54:17.597186 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 14:54:17.598286 (MainThread): On master: Close
2021-10-05 14:54:17.599833 (MainThread): 14:54:17 | 
2021-10-05 14:54:17.601168 (MainThread): 14:54:17 | Finished running 1 table model in 0.31s.
2021-10-05 14:54:17.602649 (MainThread): Connection 'master' was properly closed.
2021-10-05 14:54:17.604291 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 14:54:17.642787 (MainThread): 
2021-10-05 14:54:17.644152 (MainThread): Completed successfully
2021-10-05 14:54:17.645562 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 14:54:17.647328 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0720c2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0720b6d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0720b6340>]}
2021-10-05 14:54:17.649323 (MainThread): Flushing usage events
2021-10-05 15:02:55.660929 (MainThread): Running with dbt=0.19.0
2021-10-05 15:02:55.806803 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 15:02:55.814381 (MainThread): Tracking: tracking
2021-10-05 15:02:55.818290 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a5153820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a875b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a5165250>]}
2021-10-05 15:02:55.846286 (MainThread): Partial parsing not enabled
2021-10-05 15:02:55.848895 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:02:55.883540 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:02:55.888632 (MainThread): Parsing macros/relations.sql
2021-10-05 15:02:55.892290 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:02:55.897262 (MainThread): Parsing macros/core.sql
2021-10-05 15:02:55.903870 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:02:55.919458 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:02:55.930948 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:02:55.964849 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:02:55.975934 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:02:55.985321 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:02:56.009520 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:02:56.020601 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:02:56.024683 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:02:56.051262 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:02:56.055424 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:02:56.109482 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:02:56.186644 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:02:56.190870 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:02:56.194852 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:02:56.198166 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:02:56.203054 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:02:56.206491 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:02:56.209021 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:02:56.215265 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:02:56.229417 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:02:56.233586 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:02:56.245165 (MainThread): Partial parsing not enabled
2021-10-05 15:02:56.293661 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:02:56.322710 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a50b8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a4fe8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a4fe86a0>]}
2021-10-05 15:02:56.324459 (MainThread): Flushing usage events
2021-10-05 15:02:56.904206 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 15:02:56.906929 (MainThread): Encountered an error:
2021-10-05 15:02:56.909629 (MainThread): Compilation Error in snapshots/first_name_count_price.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)
2021-10-05 15:02:56.917272 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 81, in parse_file
    for block in blocks:
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 124, in __iter__
    for block in self.extract_blocks(entry):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 107, in extract_blocks
    blocks = extract_toplevel_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 603, in extract_toplevel_blocks
    return BlockIterator(data).lex_for_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 392, in lex_for_blocks
    return list(self.find_blocks(allowed_blocks=allowed_blocks,
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 381, in find_blocks
    dbt.exceptions.raise_compiler_error((
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in snapshots/first_name_count_price.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)

2021-10-05 15:03:27.288648 (MainThread): Running with dbt=0.19.0
2021-10-05 15:03:27.429498 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 15:03:27.435035 (MainThread): Tracking: tracking
2021-10-05 15:03:27.438437 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd03b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9400640400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd04b220>]}
2021-10-05 15:03:27.467510 (MainThread): Partial parsing not enabled
2021-10-05 15:03:27.470187 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:03:27.504721 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:03:27.509671 (MainThread): Parsing macros/relations.sql
2021-10-05 15:03:27.513157 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:03:27.517875 (MainThread): Parsing macros/core.sql
2021-10-05 15:03:27.525233 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:03:27.540037 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:03:27.551410 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:03:27.585905 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:03:27.597181 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:03:27.605612 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:03:27.630180 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:03:27.640267 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:03:27.644255 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:03:27.676870 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:03:27.681392 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:03:27.736129 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:03:27.810723 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:03:27.815037 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:03:27.819495 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:03:27.823826 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:03:27.829286 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:03:27.832839 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:03:27.835684 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:03:27.839242 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:03:27.854186 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:03:27.858702 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:03:27.869260 (MainThread): Partial parsing not enabled
2021-10-05 15:03:27.915941 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:03:27.944311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fcfb6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fcecad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fceca670>]}
2021-10-05 15:03:27.946219 (MainThread): Flushing usage events
2021-10-05 15:03:28.493573 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 15:03:28.496363 (MainThread): Encountered an error:
2021-10-05 15:03:28.498507 (MainThread): Compilation Error in snapshots/first_name_count_price.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)
2021-10-05 15:03:28.502491 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 81, in parse_file
    for block in blocks:
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 124, in __iter__
    for block in self.extract_blocks(entry):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 107, in extract_blocks
    blocks = extract_toplevel_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 603, in extract_toplevel_blocks
    return BlockIterator(data).lex_for_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 392, in lex_for_blocks
    return list(self.find_blocks(allowed_blocks=allowed_blocks,
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 381, in find_blocks
    dbt.exceptions.raise_compiler_error((
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in snapshots/first_name_count_price.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)

2021-10-05 15:03:41.358905 (MainThread): Running with dbt=0.19.0
2021-10-05 15:03:41.508730 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 15:03:41.513317 (MainThread): Tracking: tracking
2021-10-05 15:03:41.516965 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790a18820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff79401d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790a28250>]}
2021-10-05 15:03:41.546859 (MainThread): Partial parsing not enabled
2021-10-05 15:03:41.549596 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:03:41.583701 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:03:41.588727 (MainThread): Parsing macros/relations.sql
2021-10-05 15:03:41.592108 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:03:41.596753 (MainThread): Parsing macros/core.sql
2021-10-05 15:03:41.603506 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:03:41.619202 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:03:41.631397 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:03:41.664779 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:03:41.675809 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:03:41.684448 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:03:41.709501 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:03:41.719936 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:03:41.723963 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:03:41.750707 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:03:41.754759 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:03:41.809590 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:03:41.882646 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:03:41.886636 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:03:41.890702 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:03:41.894023 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:03:41.899385 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:03:41.903237 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:03:41.906297 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:03:41.910190 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:03:41.924553 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:03:41.928816 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:03:41.942701 (MainThread): Partial parsing not enabled
2021-10-05 15:03:41.988955 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:03:42.029969 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:42.035334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff79097aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7908aad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790836220>]}
2021-10-05 15:03:42.037059 (MainThread): Flushing usage events
2021-10-05 15:03:42.594732 (MainThread): Connection 'snapshot.my_new_project.first_name_count_price_snapshot' was properly closed.
2021-10-05 15:03:42.598227 (MainThread): Encountered an error:
2021-10-05 15:03:42.600712 (MainThread): Compilation Error in snapshot first_name_count_price_snapshot (snapshots/first_name_count_price.sql)
  expected token ',', got 'check_cols'
    line 9
      check_cols=['sum', 'no_of_movies']
2021-10-05 15:03:42.605104 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 9, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'check_cols'
  line 9
    check_cols=['sum', 'no_of_movies']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 82, in parse_file
    self.parse_node(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in snapshot first_name_count_price_snapshot (snapshots/first_name_count_price.sql)
  expected token ',', got 'check_cols'
    line 9
      check_cols=['sum', 'no_of_movies']

2021-10-05 15:03:55.020939 (MainThread): Running with dbt=0.19.0
2021-10-05 15:03:55.170336 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 15:03:55.175307 (MainThread): Tracking: tracking
2021-10-05 15:03:55.178724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e7a86850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7eb08e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e7a98280>]}
2021-10-05 15:03:55.205935 (MainThread): Partial parsing not enabled
2021-10-05 15:03:55.208380 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:03:55.241877 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:03:55.246968 (MainThread): Parsing macros/relations.sql
2021-10-05 15:03:55.250597 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:03:55.255222 (MainThread): Parsing macros/core.sql
2021-10-05 15:03:55.262015 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:03:55.277177 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:03:55.288013 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:03:55.326174 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:03:55.336661 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:03:55.344596 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:03:55.368049 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:03:55.377712 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:03:55.381361 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:03:55.407372 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:03:55.411465 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:03:55.464600 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:03:55.536689 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:03:55.540572 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:03:55.544648 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:03:55.548052 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:03:55.552901 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:03:55.556501 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:03:55.559504 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:03:55.563041 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:03:55.577452 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:03:55.581379 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:03:55.592276 (MainThread): Partial parsing not enabled
2021-10-05 15:03:55.636210 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:03:55.675694 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:55.890220 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:03:55.898485 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ab2aa8a-2287-4c89-be42-7701c13cf754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e78aed30>]}
2021-10-05 15:03:55.946877 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:03:55.948932 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:03:55.951434 (MainThread): 
2021-10-05 15:03:55.953296 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:03:55.956357 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:03:55.968608 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:03:55.970470 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:03:55.972797 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:03:55.979219 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 15:03:55.982983 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:03:55.988089 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:03:55.996344 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:03:55.998182 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:03:55.999597 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:03:56.005038 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:03:56.006584 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:03:56.007771 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:03:56.011056 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 15:03:56.020096 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:03:56.021985 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:03:56.030654 (MainThread): Using postgres connection "master".
2021-10-05 15:03:56.032186 (MainThread): On master: BEGIN
2021-10-05 15:03:56.033391 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:03:56.038567 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:03:56.040360 (MainThread): Using postgres connection "master".
2021-10-05 15:03:56.041596 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:03:56.048207 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:03:56.049900 (MainThread): On master: ROLLBACK
2021-10-05 15:03:56.051544 (MainThread): Using postgres connection "master".
2021-10-05 15:03:56.052770 (MainThread): On master: BEGIN
2021-10-05 15:03:56.054645 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:03:56.055989 (MainThread): On master: COMMIT
2021-10-05 15:03:56.057253 (MainThread): Using postgres connection "master".
2021-10-05 15:03:56.058399 (MainThread): On master: COMMIT
2021-10-05 15:03:56.059903 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:03:56.061197 (MainThread): On master: Close
2021-10-05 15:03:56.062716 (MainThread): 15:03:56 | Concurrency: 2 threads (target='dev')
2021-10-05 15:03:56.064075 (MainThread): 15:03:56 | 
2021-10-05 15:03:56.070300 (Thread-1): Began running node snapshot.my_new_project.first_name_count_price_snapshot
2021-10-05 15:03:56.072774 (Thread-1): 15:03:56 | 1 of 1 START snapshot public.first_name_count_price_snapshot......... [RUN]
2021-10-05 15:03:56.074549 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:56.076098 (Thread-1): Compiling snapshot.my_new_project.first_name_count_price_snapshot
2021-10-05 15:03:56.093303 (Thread-1): finished collecting timing info
2021-10-05 15:03:56.132269 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:56.134349 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-05 15:03:56.136053 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 15:03:56.142156 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 15:03:56.183070 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:56.184984 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-05 15:03:56.187498 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 15:03:56.202715 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.first_name_count_price_snapshot"
2021-10-05 15:03:56.209364 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:56.210660 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: BEGIN
2021-10-05 15:03:56.212277 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:03:56.213637 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:56.214893 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      

  create  table "dellstore"."public"."first_name_count_price_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(firstname as varchar ), '')
         || '|' || coalesce(cast('2021-10-05 15:03:56.141268'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        '2021-10-05 15:03:56.141268'::timestamp without time zone as dbt_updated_at,
        '2021-10-05 15:03:56.141268'::timestamp without time zone as dbt_valid_from,
        nullif('2021-10-05 15:03:56.141268'::timestamp without time zone, '2021-10-05 15:03:56.141268'::timestamp without time zone) as dbt_valid_to
    from (
        



select * from "dellstore"."public"."first_name_count_price"

    ) sbq


  );
  
2021-10-05 15:03:56.222403 (Thread-1): SQL status: SELECT 200 in 0.01 seconds
2021-10-05 15:03:56.231042 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: COMMIT
2021-10-05 15:03:56.232407 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:03:56.233580 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: COMMIT
2021-10-05 15:03:56.236666 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:03:56.239865 (Thread-1): finished collecting timing info
2021-10-05 15:03:56.241850 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: Close
2021-10-05 15:03:56.243760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab2aa8a-2287-4c89-be42-7701c13cf754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e7aac0a0>]}
2021-10-05 15:03:56.246380 (Thread-1): 15:03:56 | 1 of 1 OK snapshotted public.first_name_count_price_snapshot......... [SELECT 200 in 0.17s]
2021-10-05 15:03:56.247686 (Thread-1): Finished running node snapshot.my_new_project.first_name_count_price_snapshot
2021-10-05 15:03:56.250687 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:03:56.251857 (MainThread): Using postgres connection "master".
2021-10-05 15:03:56.252980 (MainThread): On master: BEGIN
2021-10-05 15:03:56.253955 (MainThread): Opening a new connection, currently in state closed
2021-10-05 15:03:56.258925 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:03:56.260374 (MainThread): On master: COMMIT
2021-10-05 15:03:56.261470 (MainThread): Using postgres connection "master".
2021-10-05 15:03:56.262761 (MainThread): On master: COMMIT
2021-10-05 15:03:56.264376 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:03:56.265559 (MainThread): On master: Close
2021-10-05 15:03:56.266943 (MainThread): 15:03:56 | 
2021-10-05 15:03:56.268147 (MainThread): 15:03:56 | Finished running 1 snapshot in 0.31s.
2021-10-05 15:03:56.269524 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:03:56.270831 (MainThread): Connection 'snapshot.my_new_project.first_name_count_price_snapshot' was properly closed.
2021-10-05 15:03:56.313538 (MainThread): 
2021-10-05 15:03:56.315323 (MainThread): Completed successfully
2021-10-05 15:03:56.316906 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 15:03:56.318664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e79eb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e793df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e79e22e0>]}
2021-10-05 15:03:56.320075 (MainThread): Flushing usage events
2021-10-05 15:12:18.863917 (MainThread): Running with dbt=0.19.0
2021-10-05 15:12:19.021433 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 15:12:19.026983 (MainThread): Tracking: tracking
2021-10-05 15:12:19.031747 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8595277f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe85cb2d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe859537220>]}
2021-10-05 15:12:19.061117 (MainThread): Partial parsing not enabled
2021-10-05 15:12:19.064293 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:12:19.097766 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:12:19.103254 (MainThread): Parsing macros/relations.sql
2021-10-05 15:12:19.106906 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:12:19.112207 (MainThread): Parsing macros/core.sql
2021-10-05 15:12:19.119093 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:12:19.133554 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:12:19.144508 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:12:19.178209 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:12:19.193709 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:12:19.203208 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:12:19.227330 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:12:19.237503 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:12:19.241481 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:12:19.267457 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:12:19.271526 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:12:19.324397 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:12:19.395568 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:12:19.399432 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:12:19.403738 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:12:19.407397 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:12:19.412429 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:12:19.415861 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:12:19.418658 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:12:19.422205 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:12:19.436294 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:12:19.440404 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:12:19.450803 (MainThread): Partial parsing not enabled
2021-10-05 15:12:19.494337 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:19.530838 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:19.742421 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:12:19.750307 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60c47788-9c00-4af1-b255-5af7ba4649d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe85934de20>]}
2021-10-05 15:12:19.796609 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:12:19.798749 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:12:19.801064 (MainThread): 
2021-10-05 15:12:19.803002 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:12:19.805908 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:12:19.818544 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:12:19.820325 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:12:19.822354 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:12:19.828463 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 15:12:19.832106 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:12:19.837039 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:12:19.844746 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:12:19.846072 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:12:19.847512 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:12:19.852796 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:12:19.854186 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:12:19.855254 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:12:19.858494 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:12:19.868134 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:12:19.870215 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:12:19.878559 (MainThread): Using postgres connection "master".
2021-10-05 15:12:19.880102 (MainThread): On master: BEGIN
2021-10-05 15:12:19.881444 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:12:19.886592 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:12:19.887935 (MainThread): Using postgres connection "master".
2021-10-05 15:12:19.889190 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:12:19.895620 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:12:19.897348 (MainThread): On master: ROLLBACK
2021-10-05 15:12:19.898833 (MainThread): Using postgres connection "master".
2021-10-05 15:12:19.899941 (MainThread): On master: BEGIN
2021-10-05 15:12:19.901672 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:12:19.902729 (MainThread): On master: COMMIT
2021-10-05 15:12:19.903865 (MainThread): Using postgres connection "master".
2021-10-05 15:12:19.905095 (MainThread): On master: COMMIT
2021-10-05 15:12:19.906443 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:12:19.907615 (MainThread): On master: Close
2021-10-05 15:12:19.909227 (MainThread): 15:12:19 | Concurrency: 2 threads (target='dev')
2021-10-05 15:12:19.910513 (MainThread): 15:12:19 | 
2021-10-05 15:12:19.914933 (Thread-1): Began running node snapshot.my_new_project.first_name_count_price_snapshot
2021-10-05 15:12:19.917640 (Thread-1): 15:12:19 | 1 of 1 START snapshot public.first_name_count_price_snapshot......... [RUN]
2021-10-05 15:12:19.918982 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:19.920509 (Thread-1): Compiling snapshot.my_new_project.first_name_count_price_snapshot
2021-10-05 15:12:19.936966 (Thread-1): finished collecting timing info
2021-10-05 15:12:19.975289 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:19.977356 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-05 15:12:19.978811 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 15:12:19.984609 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 15:12:20.021693 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.023530 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-05 15:12:20.025503 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 15:12:20.041085 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.042941 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: BEGIN
2021-10-05 15:12:20.044993 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:12:20.046400 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.047805 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'first_name_count_price_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-05 15:12:20.061821 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-10-05 15:12:20.090026 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.092430 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

        

  create temporary table "first_name_count_price_snapshot__dbt_tmp151220077898"
  as (
    with snapshot_query as (

        



select * from "dellstore"."public"."first_name_count_price"


    ),

    snapshotted_data as (

        select *,
            firstname as dbt_unique_key

        from "dellstore"."public"."first_name_count_price_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            firstname as dbt_unique_key,
            '2021-10-05 15:12:19.983700'::timestamp without time zone as dbt_updated_at,
            '2021-10-05 15:12:19.983700'::timestamp without time zone as dbt_valid_from,
            nullif('2021-10-05 15:12:19.983700'::timestamp without time zone, '2021-10-05 15:12:19.983700'::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(firstname as varchar ), '')
         || '|' || coalesce(cast('2021-10-05 15:12:19.983700'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            firstname as dbt_unique_key,
            '2021-10-05 15:12:19.983700'::timestamp without time zone as dbt_updated_at,
            '2021-10-05 15:12:19.983700'::timestamp without time zone as dbt_valid_from,
            '2021-10-05 15:12:19.983700'::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.sum != source_data.sum
        or
        (
            ((snapshotted_data.sum is null) and not (source_data.sum is null))
            or
            ((not snapshotted_data.sum is null) and (source_data.sum is null))
        ) or snapshotted_data.no_of_movies != source_data.no_of_movies
        or
        (
            ((snapshotted_data.no_of_movies is null) and not (source_data.no_of_movies is null))
            or
            ((not snapshotted_data.no_of_movies is null) and (source_data.no_of_movies is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.sum != source_data.sum
        or
        (
            ((snapshotted_data.sum is null) and not (source_data.sum is null))
            or
            ((not snapshotted_data.sum is null) and (source_data.sum is null))
        ) or snapshotted_data.no_of_movies != source_data.no_of_movies
        or
        (
            ((snapshotted_data.no_of_movies is null) and not (source_data.no_of_movies is null))
            or
            ((not snapshotted_data.no_of_movies is null) and (source_data.no_of_movies is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2021-10-05 15:12:20.098436 (Thread-1): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:12:20.103761 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.105216 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'first_name_count_price_snapshot__dbt_tmp151220077898'
        
      order by ordinal_position

  
2021-10-05 15:12:20.110041 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 15:12:20.115268 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.116906 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'first_name_count_price_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-05 15:12:20.123927 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-10-05 15:12:20.130054 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.131734 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'first_name_count_price_snapshot__dbt_tmp151220077898'
        
      order by ordinal_position

  
2021-10-05 15:12:20.136326 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 15:12:20.141590 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.143232 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'first_name_count_price_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-05 15:12:20.148673 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-10-05 15:12:20.157877 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.159399 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'first_name_count_price_snapshot__dbt_tmp151220077898'
        
      order by ordinal_position

  
2021-10-05 15:12:20.166350 (Thread-1): SQL status: SELECT 9 in 0.01 seconds
2021-10-05 15:12:20.173874 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.first_name_count_price_snapshot"
2021-10-05 15:12:20.180616 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.181835 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.first_name_count_price_snapshot"} */

      update "dellstore"."public"."first_name_count_price_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "first_name_count_price_snapshot__dbt_tmp151220077898" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dellstore"."public"."first_name_count_price_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dellstore"."public"."first_name_count_price_snapshot".dbt_valid_to is null;

    insert into "dellstore"."public"."first_name_count_price_snapshot" ("firstname", "sum", "no_of_movies", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."firstname",DBT_INTERNAL_SOURCE."sum",DBT_INTERNAL_SOURCE."no_of_movies",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "first_name_count_price_snapshot__dbt_tmp151220077898" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2021-10-05 15:12:20.184358 (Thread-1): SQL status: INSERT 0 0 in 0.00 seconds
2021-10-05 15:12:20.192711 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: COMMIT
2021-10-05 15:12:20.194316 (Thread-1): Using postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:20.195715 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: COMMIT
2021-10-05 15:12:20.200197 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:12:20.205904 (Thread-1): finished collecting timing info
2021-10-05 15:12:20.207417 (Thread-1): On snapshot.my_new_project.first_name_count_price_snapshot: Close
2021-10-05 15:12:20.211432 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60c47788-9c00-4af1-b255-5af7ba4649d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8594a0e20>]}
2021-10-05 15:12:20.214307 (Thread-1): 15:12:20 | 1 of 1 OK snapshotted public.first_name_count_price_snapshot......... [INSERT 0 0 in 0.29s]
2021-10-05 15:12:20.215883 (Thread-1): Finished running node snapshot.my_new_project.first_name_count_price_snapshot
2021-10-05 15:12:20.219978 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:12:20.221485 (MainThread): Using postgres connection "master".
2021-10-05 15:12:20.222918 (MainThread): On master: BEGIN
2021-10-05 15:12:20.224474 (MainThread): Opening a new connection, currently in state closed
2021-10-05 15:12:20.230395 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:12:20.231891 (MainThread): On master: COMMIT
2021-10-05 15:12:20.233219 (MainThread): Using postgres connection "master".
2021-10-05 15:12:20.234591 (MainThread): On master: COMMIT
2021-10-05 15:12:20.236087 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:12:20.237254 (MainThread): On master: Close
2021-10-05 15:12:20.239695 (MainThread): 15:12:20 | 
2021-10-05 15:12:20.240972 (MainThread): 15:12:20 | Finished running 1 snapshot in 0.44s.
2021-10-05 15:12:20.242320 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:12:20.243571 (MainThread): Connection 'snapshot.my_new_project.first_name_count_price_snapshot' was properly closed.
2021-10-05 15:12:20.290932 (MainThread): 
2021-10-05 15:12:20.292132 (MainThread): Completed successfully
2021-10-05 15:12:20.293745 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 15:12:20.295352 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe859587d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8594851f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe859485700>]}
2021-10-05 15:12:20.296975 (MainThread): Flushing usage events
2021-10-05 15:12:57.481043 (MainThread): Running with dbt=0.19.0
2021-10-05 15:12:57.628955 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:12:57.634821 (MainThread): Tracking: tracking
2021-10-05 15:12:57.639094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886b664bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869bbcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869bbcfd0>]}
2021-10-05 15:12:57.668938 (MainThread): Partial parsing not enabled
2021-10-05 15:12:57.671942 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:12:57.707979 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:12:57.713961 (MainThread): Parsing macros/relations.sql
2021-10-05 15:12:57.718227 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:12:57.723682 (MainThread): Parsing macros/core.sql
2021-10-05 15:12:57.730768 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:12:57.744876 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:12:57.755764 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:12:57.788706 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:12:57.799506 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:12:57.807645 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:12:57.831190 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:12:57.840911 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:12:57.844947 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:12:57.871166 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:12:57.875100 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:12:57.927597 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:12:57.999101 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:12:58.002979 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:12:58.006907 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:12:58.010087 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:12:58.014924 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:12:58.018474 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:12:58.021319 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:12:58.024769 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:12:58.039278 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:12:58.043265 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:12:58.053660 (MainThread): Partial parsing not enabled
2021-10-05 15:12:58.097230 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.132960 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:12:58.344951 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:12:58.352889 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e9e5735-00f4-4b69-843a-ebfded266e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88699e3940>]}
2021-10-05 15:12:58.400941 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:12:58.403184 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:12:58.405813 (MainThread): 
2021-10-05 15:12:58.407975 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:12:58.411092 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:12:58.423682 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:12:58.425419 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:12:58.426844 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:12:58.433292 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 15:12:58.437093 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:12:58.442040 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:12:58.449813 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:12:58.451664 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:12:58.453300 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:12:58.458930 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:12:58.460693 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:12:58.462240 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:12:58.467198 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:12:58.476886 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:12:58.478588 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:12:58.487070 (MainThread): Using postgres connection "master".
2021-10-05 15:12:58.488281 (MainThread): On master: BEGIN
2021-10-05 15:12:58.489473 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:12:58.495083 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:12:58.496244 (MainThread): Using postgres connection "master".
2021-10-05 15:12:58.497543 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:12:58.503725 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:12:58.505183 (MainThread): On master: ROLLBACK
2021-10-05 15:12:58.506495 (MainThread): Using postgres connection "master".
2021-10-05 15:12:58.507512 (MainThread): On master: BEGIN
2021-10-05 15:12:58.509234 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:12:58.510257 (MainThread): On master: COMMIT
2021-10-05 15:12:58.511201 (MainThread): Using postgres connection "master".
2021-10-05 15:12:58.512187 (MainThread): On master: COMMIT
2021-10-05 15:12:58.513445 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:12:58.514542 (MainThread): On master: Close
2021-10-05 15:12:58.515804 (MainThread): 15:12:58 | Concurrency: 2 threads (target='dev')
2021-10-05 15:12:58.517069 (MainThread): 15:12:58 | 
2021-10-05 15:12:58.520875 (Thread-1): Began running node model.my_new_project.first_name_count_price
2021-10-05 15:12:58.523136 (Thread-1): 15:12:58 | 1 of 1 START table model public.first_name_count_price............... [RUN]
2021-10-05 15:12:58.524775 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.525978 (Thread-1): Compiling model.my_new_project.first_name_count_price
2021-10-05 15:12:58.540885 (Thread-1): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 15:12:58.546074 (Thread-1): finished collecting timing info
2021-10-05 15:12:58.571910 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.573473 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 15:12:58.574718 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 15:12:58.580380 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 15:12:58.584177 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.585317 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 15:12:58.586881 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:12:58.598941 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 15:12:58.602794 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.604223 (Thread-1): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 15:12:58.605711 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:12:58.606767 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.607746 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM "dellstore"."public"."products" GROUP BY firstname
  );
2021-10-05 15:12:58.620326 (Thread-1): SQL status: SELECT 200 in 0.01 seconds
2021-10-05 15:12:58.629940 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.631584 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price" rename to "first_name_count_price__dbt_backup"
2021-10-05 15:12:58.633501 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 15:12:58.636919 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.638331 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price__dbt_tmp" rename to "first_name_count_price"
2021-10-05 15:12:58.640180 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 15:12:58.648603 (Thread-1): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 15:12:58.650115 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.651574 (Thread-1): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 15:12:58.654695 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:12:58.659495 (Thread-1): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:12:58.661019 (Thread-1): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 15:12:58.663859 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:12:58.667443 (Thread-1): finished collecting timing info
2021-10-05 15:12:58.668691 (Thread-1): On model.my_new_project.first_name_count_price: Close
2021-10-05 15:12:58.670347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9e5735-00f4-4b69-843a-ebfded266e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88699adc40>]}
2021-10-05 15:12:58.672551 (Thread-1): 15:12:58 | 1 of 1 OK created table model public.first_name_count_price.......... [SELECT 200 in 0.15s]
2021-10-05 15:12:58.673762 (Thread-1): Finished running node model.my_new_project.first_name_count_price
2021-10-05 15:12:58.676679 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:12:58.677655 (MainThread): Using postgres connection "master".
2021-10-05 15:12:58.678625 (MainThread): On master: BEGIN
2021-10-05 15:12:58.679558 (MainThread): Opening a new connection, currently in state closed
2021-10-05 15:12:58.684536 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:12:58.686008 (MainThread): On master: COMMIT
2021-10-05 15:12:58.687172 (MainThread): Using postgres connection "master".
2021-10-05 15:12:58.688539 (MainThread): On master: COMMIT
2021-10-05 15:12:58.690460 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:12:58.691470 (MainThread): On master: Close
2021-10-05 15:12:58.692741 (MainThread): 15:12:58 | 
2021-10-05 15:12:58.693831 (MainThread): 15:12:58 | Finished running 1 table model in 0.29s.
2021-10-05 15:12:58.695037 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:12:58.696356 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 15:12:58.738908 (MainThread): 
2021-10-05 15:12:58.740193 (MainThread): Completed successfully
2021-10-05 15:12:58.741591 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 15:12:58.743014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869b06130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869b3a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869b3a0d0>]}
2021-10-05 15:12:58.744792 (MainThread): Flushing usage events
2021-10-05 15:43:12.748247 (MainThread): Running with dbt=0.19.0
2021-10-05 15:43:12.898530 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:43:12.905295 (MainThread): Tracking: tracking
2021-10-05 15:43:12.909550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4aff0f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b19ba310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4aff211c0>]}
2021-10-05 15:43:12.939489 (MainThread): Partial parsing not enabled
2021-10-05 15:43:12.942649 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:43:12.976251 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:43:12.982091 (MainThread): Parsing macros/relations.sql
2021-10-05 15:43:12.985759 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:43:12.990607 (MainThread): Parsing macros/core.sql
2021-10-05 15:43:12.998006 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:43:13.012587 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:43:13.023656 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:43:13.056146 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:43:13.066653 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:43:13.074942 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:43:13.098535 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:43:13.108250 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:43:13.111994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:43:13.138266 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:43:13.141871 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:43:13.194146 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:43:13.274860 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:43:13.278877 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:43:13.282476 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:43:13.285640 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:43:13.291025 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:43:13.294393 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:43:13.296974 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:43:13.300246 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:43:13.314595 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:43:13.318722 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:43:13.330181 (MainThread): Partial parsing not enabled
2021-10-05 15:43:13.377931 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:43:13.404663 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:13.429221 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:43:13.641688 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:43:13.650127 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '218ccf4c-4064-4c42-9586-553860bf8167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4afe22dc0>]}
2021-10-05 15:43:13.700566 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:43:13.703417 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:43:13.706349 (MainThread): 
2021-10-05 15:43:13.708098 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:43:13.713222 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:43:13.725492 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:43:13.727049 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:43:13.728364 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:43:13.735113 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 15:43:13.738699 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:43:13.745297 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:43:13.753153 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:43:13.754663 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:43:13.755913 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:43:13.761527 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:43:13.762959 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:43:13.764290 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:43:13.767590 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:43:13.777371 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:43:13.779419 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:43:13.789492 (MainThread): Using postgres connection "master".
2021-10-05 15:43:13.790979 (MainThread): On master: BEGIN
2021-10-05 15:43:13.792954 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:43:13.798579 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:43:13.799969 (MainThread): Using postgres connection "master".
2021-10-05 15:43:13.801224 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:43:13.806984 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:43:13.808667 (MainThread): On master: ROLLBACK
2021-10-05 15:43:13.810269 (MainThread): Using postgres connection "master".
2021-10-05 15:43:13.811522 (MainThread): On master: BEGIN
2021-10-05 15:43:13.813353 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:43:13.814427 (MainThread): On master: COMMIT
2021-10-05 15:43:13.815731 (MainThread): Using postgres connection "master".
2021-10-05 15:43:13.816921 (MainThread): On master: COMMIT
2021-10-05 15:43:13.818420 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:43:13.819571 (MainThread): On master: Close
2021-10-05 15:43:13.820980 (MainThread): 15:43:13 | Concurrency: 2 threads (target='dev')
2021-10-05 15:43:13.822470 (MainThread): 15:43:13 | 
2021-10-05 15:43:13.826394 (Thread-1): Began running node model.my_new_project.daily_losses
2021-10-05 15:43:13.826612 (Thread-2): Began running node model.my_new_project.first_name_count_price
2021-10-05 15:43:13.830224 (Thread-1): 15:43:13 | 1 of 2 START table model public.daily_losses......................... [RUN]
2021-10-05 15:43:13.832559 (Thread-2): 15:43:13 | 2 of 2 START table model public.first_name_count_price............... [RUN]
2021-10-05 15:43:13.834459 (Thread-1): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:43:13.835490 (Thread-2): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:13.836754 (Thread-1): Compiling model.my_new_project.daily_losses
2021-10-05 15:43:13.838578 (Thread-2): Compiling model.my_new_project.first_name_count_price
2021-10-05 15:43:13.853501 (Thread-1): Writing injected SQL for node "model.my_new_project.daily_losses"
2021-10-05 15:43:13.861784 (Thread-2): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 15:43:13.866274 (Thread-1): finished collecting timing info
2021-10-05 15:43:13.889342 (Thread-2): finished collecting timing info
2021-10-05 15:43:13.894061 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:43:13.901912 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:13.902844 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */
drop table if exists "dellstore"."public"."daily_losses__dbt_tmp" cascade
2021-10-05 15:43:13.904200 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 15:43:13.905749 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 15:43:13.907274 (Thread-2): Opening a new connection, currently in state init
2021-10-05 15:43:13.913123 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 15:43:13.917184 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:43:13.917355 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 15:43:13.918586 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */
drop table if exists "dellstore"."public"."daily_losses__dbt_backup" cascade
2021-10-05 15:43:13.923290 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:13.925594 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:43:13.926411 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 15:43:13.948266 (Thread-1): Writing runtime SQL for node "model.my_new_project.daily_losses"
2021-10-05 15:43:13.948507 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:43:13.953091 (Thread-2): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 15:43:13.954359 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:43:13.955904 (Thread-1): On model.my_new_project.daily_losses: BEGIN
2021-10-05 15:43:13.957610 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:43:13.958952 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:43:13.960222 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */


  create  table "dellstore"."public"."daily_losses__dbt_tmp"
  as (
    

CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits;

$$ LANGUAGE sql
IMMUTABLE
STRICT;

select * from orders

SELECT orderdate, sum(netamount) from (select customerid, creditcard from customers WHERE luhn_verify(creditcard::int8)) cust
JOIN (select customerid,orderdate, netamount from orders) ord ON cust.customerid = ord.customerid
GROUP BY orderdate
  );
2021-10-05 15:43:13.959230 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:13.963753 (Thread-2): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 15:43:13.962940 (Thread-1): Postgres error: syntax error at or near "CREATE"
LINE 8: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
        ^

2021-10-05 15:43:13.966273 (Thread-1): On model.my_new_project.daily_losses: ROLLBACK
2021-10-05 15:43:13.965293 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:43:13.968933 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:13.967907 (Thread-1): finished collecting timing info
2021-10-05 15:43:13.970256 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM "dellstore"."public"."products" GROUP BY firstname
  );
2021-10-05 15:43:13.971616 (Thread-1): On model.my_new_project.daily_losses: Close
2021-10-05 15:43:13.975139 (Thread-1): Database Error in model daily_losses (models/daily_losses.sql)
  syntax error at or near "CREATE"
  LINE 8: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
          ^
  compiled SQL at target/run/my_new_project/models/daily_losses.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 8: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model daily_losses (models/daily_losses.sql)
  syntax error at or near "CREATE"
  LINE 8: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
          ^
  compiled SQL at target/run/my_new_project/models/daily_losses.sql
2021-10-05 15:43:13.978935 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '218ccf4c-4064-4c42-9586-553860bf8167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ad4214c0>]}
2021-10-05 15:43:13.981570 (Thread-1): 15:43:13 | 1 of 2 ERROR creating table model public.daily_losses................ [ERROR in 0.14s]
2021-10-05 15:43:13.983223 (Thread-1): Finished running node model.my_new_project.daily_losses
2021-10-05 15:43:13.987738 (Thread-2): SQL status: SELECT 200 in 0.01 seconds
2021-10-05 15:43:13.998627 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:14.000338 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price" rename to "first_name_count_price__dbt_backup"
2021-10-05 15:43:14.001992 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 15:43:14.005562 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:14.007132 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price__dbt_tmp" rename to "first_name_count_price"
2021-10-05 15:43:14.009219 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 15:43:14.017904 (Thread-2): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 15:43:14.019981 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:14.021607 (Thread-2): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 15:43:14.024590 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:43:14.029581 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:43:14.031341 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 15:43:14.034793 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:43:14.039104 (Thread-2): finished collecting timing info
2021-10-05 15:43:14.040774 (Thread-2): On model.my_new_project.first_name_count_price: Close
2021-10-05 15:43:14.042781 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '218ccf4c-4064-4c42-9586-553860bf8167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4afcb7610>]}
2021-10-05 15:43:14.045831 (Thread-2): 15:43:14 | 2 of 2 OK created table model public.first_name_count_price.......... [SELECT 200 in 0.21s]
2021-10-05 15:43:14.047147 (Thread-2): Finished running node model.my_new_project.first_name_count_price
2021-10-05 15:43:14.050129 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:43:14.051472 (MainThread): Using postgres connection "master".
2021-10-05 15:43:14.052767 (MainThread): On master: BEGIN
2021-10-05 15:43:14.053934 (MainThread): Opening a new connection, currently in state closed
2021-10-05 15:43:14.059270 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:43:14.060821 (MainThread): On master: COMMIT
2021-10-05 15:43:14.062158 (MainThread): Using postgres connection "master".
2021-10-05 15:43:14.063391 (MainThread): On master: COMMIT
2021-10-05 15:43:14.065049 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:43:14.066297 (MainThread): On master: Close
2021-10-05 15:43:14.067855 (MainThread): 15:43:14 | 
2021-10-05 15:43:14.069261 (MainThread): 15:43:14 | Finished running 2 table models in 0.36s.
2021-10-05 15:43:14.070815 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:43:14.072352 (MainThread): Connection 'model.my_new_project.daily_losses' was properly closed.
2021-10-05 15:43:14.073807 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 15:43:14.119161 (MainThread): 
2021-10-05 15:43:14.120780 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 15:43:14.122276 (MainThread): 
2021-10-05 15:43:14.123922 (MainThread): Database Error in model daily_losses (models/daily_losses.sql)
2021-10-05 15:43:14.125839 (MainThread):   syntax error at or near "CREATE"
2021-10-05 15:43:14.127465 (MainThread):   LINE 8: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
2021-10-05 15:43:14.129102 (MainThread):           ^
2021-10-05 15:43:14.130511 (MainThread):   compiled SQL at target/run/my_new_project/models/daily_losses.sql
2021-10-05 15:43:14.132146 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-05 15:43:14.133599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ad4034c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4afdac280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4afd666d0>]}
2021-10-05 15:43:14.135083 (MainThread): Flushing usage events
2021-10-05 15:50:05.555279 (MainThread): Running with dbt=0.19.0
2021-10-05 15:50:05.708456 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:50:05.714262 (MainThread): Tracking: tracking
2021-10-05 15:50:05.717710 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a48dbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a7ee23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a48ec070>]}
2021-10-05 15:50:05.745630 (MainThread): Partial parsing not enabled
2021-10-05 15:50:05.751654 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 15:50:05.753960 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:50:05.787277 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:50:05.792439 (MainThread): Parsing macros/relations.sql
2021-10-05 15:50:05.795777 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:50:05.800365 (MainThread): Parsing macros/core.sql
2021-10-05 15:50:05.806933 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:50:05.821105 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:50:05.831947 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:50:05.865328 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:50:05.876149 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:50:05.884540 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:50:05.908305 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:50:05.918298 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:50:05.922537 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:50:05.948785 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:50:05.952686 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:50:06.004875 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:50:06.077154 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:50:06.081802 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:50:06.085713 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:50:06.089450 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:50:06.094736 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:50:06.098405 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:50:06.101402 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:50:06.105204 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:50:06.120286 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:50:06.124711 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:50:06.138211 (MainThread): Partial parsing not enabled
2021-10-05 15:50:06.185328 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:06.194659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a48b2220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a475c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a4762f40>]}
2021-10-05 15:50:06.196397 (MainThread): Flushing usage events
2021-10-05 15:50:06.802680 (MainThread): Connection 'model.my_new_project.daily_losses' was properly closed.
2021-10-05 15:50:06.805878 (MainThread): Encountered an error:
2021-10-05 15:50:06.807858 (MainThread): Compilation Error in model daily_losses (models/daily_losses.sql)
  expected token ',', got ':'
    line 6
      from customers WHERE {{ luhn_verify(creditcard::int8)) }} cust
2021-10-05 15:50:06.812800 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 6, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 6
    from customers WHERE {{ luhn_verify(creditcard::int8)) }} cust

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model daily_losses (models/daily_losses.sql)
  expected token ',', got ':'
    line 6
      from customers WHERE {{ luhn_verify(creditcard::int8)) }} cust

2021-10-05 15:50:26.559821 (MainThread): Running with dbt=0.19.0
2021-10-05 15:50:26.717284 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:50:26.722978 (MainThread): Tracking: tracking
2021-10-05 15:50:26.727026 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd797d8e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799839280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd797da0160>]}
2021-10-05 15:50:26.758279 (MainThread): Partial parsing not enabled
2021-10-05 15:50:26.763854 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 15:50:26.766424 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:50:26.800349 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:50:26.805537 (MainThread): Parsing macros/relations.sql
2021-10-05 15:50:26.809210 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:50:26.814121 (MainThread): Parsing macros/core.sql
2021-10-05 15:50:26.821129 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:50:26.835631 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:50:26.846775 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:50:26.880121 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:50:26.891050 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:50:26.899644 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:50:26.923915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:50:26.934544 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:50:26.938713 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:50:26.965422 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:50:26.969480 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:50:27.023327 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:50:27.098616 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:50:27.102935 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:50:27.107492 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:50:27.111218 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:50:27.116833 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:50:27.120834 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:50:27.124261 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:50:27.128630 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:50:27.146609 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:50:27.152194 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:50:27.166384 (MainThread): Partial parsing not enabled
2021-10-05 15:50:27.225232 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:27.238718 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd797cf22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd797c0d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd797c16f70>]}
2021-10-05 15:50:27.240934 (MainThread): Flushing usage events
2021-10-05 15:50:27.810776 (MainThread): Connection 'model.my_new_project.daily_losses' was properly closed.
2021-10-05 15:50:27.814149 (MainThread): Encountered an error:
2021-10-05 15:50:27.816226 (MainThread): Compilation Error in model daily_losses (models/daily_losses.sql)
  unexpected ')'
    line 6
      from customers WHERE {{ luhn_verify(creditcard)) }} cust
2021-10-05 15:50:27.820906 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 6, in template
jinja2.exceptions.TemplateSyntaxError: unexpected ')'
  line 6
    from customers WHERE {{ luhn_verify(creditcard)) }} cust

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model daily_losses (models/daily_losses.sql)
  unexpected ')'
    line 6
      from customers WHERE {{ luhn_verify(creditcard)) }} cust

2021-10-05 15:50:39.601254 (MainThread): Running with dbt=0.19.0
2021-10-05 15:50:39.751341 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:50:39.756412 (MainThread): Tracking: tracking
2021-10-05 15:50:39.760043 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff056d10d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a317400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff056d210d0>]}
2021-10-05 15:50:39.787280 (MainThread): Partial parsing not enabled
2021-10-05 15:50:39.790361 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 15:50:39.792501 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:50:39.824441 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:50:39.829064 (MainThread): Parsing macros/relations.sql
2021-10-05 15:50:39.832197 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:50:39.836644 (MainThread): Parsing macros/core.sql
2021-10-05 15:50:39.843232 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:50:39.857439 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:50:39.868209 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:50:39.902096 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:50:39.913119 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:50:39.921621 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:50:39.944988 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:50:39.954561 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:50:39.958481 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:50:39.983759 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:50:39.987589 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:50:40.039534 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:50:40.110229 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:50:40.113988 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:50:40.117907 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:50:40.121371 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:50:40.126384 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:50:40.129510 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:50:40.131847 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:50:40.135195 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:50:40.149574 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:50:40.153672 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:50:40.165139 (MainThread): Partial parsing not enabled
2021-10-05 15:50:40.211790 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:40.239241 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.263543 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:50:40.474025 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:50:40.482439 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a42cdee-cd71-4c16-9bfa-2241dae43f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff056b60d30>]}
2021-10-05 15:50:40.535172 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:50:40.538085 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:50:40.540820 (MainThread): 
2021-10-05 15:50:40.542609 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:50:40.547545 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:50:40.559537 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:50:40.561338 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:50:40.562896 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:50:40.569534 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 15:50:40.573503 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:50:40.579742 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:50:40.587415 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:50:40.588932 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:50:40.590370 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:50:40.595824 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:50:40.597270 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:50:40.598650 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:50:40.601969 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:50:40.611816 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:50:40.613611 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:50:40.623480 (MainThread): Using postgres connection "master".
2021-10-05 15:50:40.625122 (MainThread): On master: BEGIN
2021-10-05 15:50:40.626432 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:50:40.631733 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:50:40.633109 (MainThread): Using postgres connection "master".
2021-10-05 15:50:40.634495 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:50:40.641437 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-05 15:50:40.643167 (MainThread): On master: ROLLBACK
2021-10-05 15:50:40.644487 (MainThread): Using postgres connection "master".
2021-10-05 15:50:40.646544 (MainThread): On master: BEGIN
2021-10-05 15:50:40.648280 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:50:40.649526 (MainThread): On master: COMMIT
2021-10-05 15:50:40.650685 (MainThread): Using postgres connection "master".
2021-10-05 15:50:40.651696 (MainThread): On master: COMMIT
2021-10-05 15:50:40.653211 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:50:40.654436 (MainThread): On master: Close
2021-10-05 15:50:40.655888 (MainThread): 15:50:40 | Concurrency: 2 threads (target='dev')
2021-10-05 15:50:40.657069 (MainThread): 15:50:40 | 
2021-10-05 15:50:40.661106 (Thread-1): Began running node model.my_new_project.daily_losses
2021-10-05 15:50:40.661323 (Thread-2): Began running node model.my_new_project.first_name_count_price
2021-10-05 15:50:40.663542 (Thread-1): 15:50:40 | 1 of 2 START table model public.daily_losses......................... [RUN]
2021-10-05 15:50:40.665616 (Thread-2): 15:50:40 | 2 of 2 START table model public.first_name_count_price............... [RUN]
2021-10-05 15:50:40.667823 (Thread-1): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:40.669208 (Thread-2): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.670983 (Thread-1): Compiling model.my_new_project.daily_losses
2021-10-05 15:50:40.672313 (Thread-2): Compiling model.my_new_project.first_name_count_price
2021-10-05 15:50:40.687855 (Thread-1): Writing injected SQL for node "model.my_new_project.daily_losses"
2021-10-05 15:50:40.696006 (Thread-2): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 15:50:40.702016 (Thread-1): finished collecting timing info
2021-10-05 15:50:40.709251 (Thread-2): finished collecting timing info
2021-10-05 15:50:40.735854 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.737481 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:40.738506 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 15:50:40.739999 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */
drop table if exists "dellstore"."public"."daily_losses__dbt_tmp" cascade
2021-10-05 15:50:40.741520 (Thread-2): Opening a new connection, currently in state init
2021-10-05 15:50:40.743292 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 15:50:40.749491 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 15:50:40.750640 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 15:50:40.755618 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.759200 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:40.760560 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 15:50:40.762076 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */
drop table if exists "dellstore"."public"."daily_losses__dbt_backup" cascade
2021-10-05 15:50:40.763881 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:50:40.764698 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:50:40.776603 (Thread-2): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 15:50:40.778495 (Thread-1): Writing runtime SQL for node "model.my_new_project.daily_losses"
2021-10-05 15:50:40.785195 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:40.786271 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.786440 (Thread-1): On model.my_new_project.daily_losses: BEGIN
2021-10-05 15:50:40.787818 (Thread-2): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 15:50:40.789627 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:50:40.790966 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:50:40.791824 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:50:40.792961 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.794189 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */


  create  table "dellstore"."public"."daily_losses__dbt_tmp"
  as (
    

SELECT orderdate, sum(netamount) from (select customerid, creditcard
from customers WHERE 

CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits;

$$ LANGUAGE sql
IMMUTABLE
STRICT;

 cust
JOIN (select customerid,orderdate, netamount from orders) ord
ON cust.customerid = ord.customerid
GROUP BY orderdate
  );
2021-10-05 15:50:40.795336 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM "dellstore"."public"."products" GROUP BY firstname
  );
2021-10-05 15:50:40.797143 (Thread-1): Postgres error: syntax error at or near "CREATE"
LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
         ^

2021-10-05 15:50:40.800319 (Thread-1): On model.my_new_project.daily_losses: ROLLBACK
2021-10-05 15:50:40.802189 (Thread-1): finished collecting timing info
2021-10-05 15:50:40.804379 (Thread-1): On model.my_new_project.daily_losses: Close
2021-10-05 15:50:40.806047 (Thread-1): Database Error in model daily_losses (models/daily_losses.sql)
  syntax error at or near "CREATE"
  LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
           ^
  compiled SQL at target/run/my_new_project/models/daily_losses.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model daily_losses (models/daily_losses.sql)
  syntax error at or near "CREATE"
  LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
           ^
  compiled SQL at target/run/my_new_project/models/daily_losses.sql
2021-10-05 15:50:40.809380 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a42cdee-cd71-4c16-9bfa-2241dae43f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff056bb2d00>]}
2021-10-05 15:50:40.811920 (Thread-1): 15:50:40 | 1 of 2 ERROR creating table model public.daily_losses................ [ERROR in 0.14s]
2021-10-05 15:50:40.812143 (Thread-2): SQL status: SELECT 200 in 0.01 seconds
2021-10-05 15:50:40.813412 (Thread-1): Finished running node model.my_new_project.daily_losses
2021-10-05 15:50:40.822944 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.825047 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price" rename to "first_name_count_price__dbt_backup"
2021-10-05 15:50:40.826683 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 15:50:40.830235 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.831694 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price__dbt_tmp" rename to "first_name_count_price"
2021-10-05 15:50:40.833360 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 15:50:40.841932 (Thread-2): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 15:50:40.843517 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.845016 (Thread-2): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 15:50:40.847493 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:50:40.852553 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:50:40.853936 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 15:50:40.857547 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 15:50:40.861197 (Thread-2): finished collecting timing info
2021-10-05 15:50:40.862713 (Thread-2): On model.my_new_project.first_name_count_price: Close
2021-10-05 15:50:40.864628 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a42cdee-cd71-4c16-9bfa-2241dae43f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff056bb0ee0>]}
2021-10-05 15:50:40.867200 (Thread-2): 15:50:40 | 2 of 2 OK created table model public.first_name_count_price.......... [SELECT 200 in 0.20s]
2021-10-05 15:50:40.868586 (Thread-2): Finished running node model.my_new_project.first_name_count_price
2021-10-05 15:50:40.871185 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:50:40.872319 (MainThread): Using postgres connection "master".
2021-10-05 15:50:40.873418 (MainThread): On master: BEGIN
2021-10-05 15:50:40.874400 (MainThread): Opening a new connection, currently in state closed
2021-10-05 15:50:40.879575 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:50:40.881175 (MainThread): On master: COMMIT
2021-10-05 15:50:40.882501 (MainThread): Using postgres connection "master".
2021-10-05 15:50:40.883672 (MainThread): On master: COMMIT
2021-10-05 15:50:40.885050 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:50:40.886066 (MainThread): On master: Close
2021-10-05 15:50:40.887534 (MainThread): 15:50:40 | 
2021-10-05 15:50:40.889269 (MainThread): 15:50:40 | Finished running 2 table models in 0.35s.
2021-10-05 15:50:40.891468 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:50:40.892958 (MainThread): Connection 'model.my_new_project.daily_losses' was properly closed.
2021-10-05 15:50:40.894414 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 15:50:40.941328 (MainThread): 
2021-10-05 15:50:40.942933 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 15:50:40.944548 (MainThread): 
2021-10-05 15:50:40.946204 (MainThread): Database Error in model daily_losses (models/daily_losses.sql)
2021-10-05 15:50:40.948077 (MainThread):   syntax error at or near "CREATE"
2021-10-05 15:50:40.950141 (MainThread):   LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
2021-10-05 15:50:40.951618 (MainThread):            ^
2021-10-05 15:50:40.953099 (MainThread):   compiled SQL at target/run/my_new_project/models/daily_losses.sql
2021-10-05 15:50:40.954598 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-05 15:50:40.956126 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff056bf4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff056c14670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05623fa90>]}
2021-10-05 15:50:40.957891 (MainThread): Flushing usage events
2021-10-05 15:58:55.533738 (MainThread): Running with dbt=0.19.0
2021-10-05 15:58:55.686437 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:58:55.693023 (MainThread): Tracking: tracking
2021-10-05 15:58:55.697276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b590cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b8f113d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b591d0a0>]}
2021-10-05 15:58:55.728315 (MainThread): Partial parsing not enabled
2021-10-05 15:58:55.734668 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 15:58:55.737133 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:58:55.773867 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:58:55.779107 (MainThread): Parsing macros/relations.sql
2021-10-05 15:58:55.782573 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:58:55.787182 (MainThread): Parsing macros/core.sql
2021-10-05 15:58:55.793835 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:58:55.808196 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:58:55.819028 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:58:55.851798 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:58:55.862245 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:58:55.870292 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:58:55.894427 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:58:55.904765 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:58:55.908900 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:58:55.935142 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:58:55.939021 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:58:55.991854 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:58:56.063082 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:58:56.066954 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:58:56.070874 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:58:56.074101 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:58:56.078949 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:58:56.082378 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:58:56.084875 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:58:56.088181 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:58:56.102280 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:58:56.106134 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:58:56.116583 (MainThread): Partial parsing not enabled
2021-10-05 15:58:56.161240 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:58:56.189008 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:58:56.213293 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:58:56.258313 (MainThread): Acquiring new postgres connection "operation.my_new_project.my_new_project-on-run-start-0".
2021-10-05 15:58:56.438708 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:58:56.448374 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53d442e6-0828-4e4e-8a37-039a12d70540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b575baf0>]}
2021-10-05 15:58:56.501784 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:58:56.503992 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 1 operation, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:58:56.506377 (MainThread): 
2021-10-05 15:58:56.508208 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:58:56.512753 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:58:56.524752 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:58:56.526635 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:58:56.528224 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:58:56.534324 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 15:58:56.538086 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:58:56.545760 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:58:56.553633 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:58:56.555219 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:58:56.556806 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:58:56.562211 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:58:56.563754 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:58:56.565224 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:58:56.569037 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:58:56.578789 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:58:56.580528 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:58:56.591721 (MainThread): Using postgres connection "master".
2021-10-05 15:58:56.593344 (MainThread): On master: BEGIN
2021-10-05 15:58:56.594582 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:58:56.600090 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:58:56.601512 (MainThread): Using postgres connection "master".
2021-10-05 15:58:56.602839 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:58:56.608693 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:58:56.610091 (MainThread): On master: ROLLBACK
2021-10-05 15:58:56.611800 (MainThread): Using postgres connection "master".
2021-10-05 15:58:56.612787 (MainThread): On master: BEGIN
2021-10-05 15:58:56.614567 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:58:56.615752 (MainThread): On master: COMMIT
2021-10-05 15:58:56.616723 (MainThread): Using postgres connection "master".
2021-10-05 15:58:56.617629 (MainThread): On master: COMMIT
2021-10-05 15:58:56.618849 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:58:56.619961 (MainThread): 15:58:56 | 
2021-10-05 15:58:56.621051 (MainThread): 15:58:56 | Running 1 on-run-start hook
2021-10-05 15:58:56.622296 (MainThread): Compiling operation.my_new_project.my_new_project-on-run-start-0
2021-10-05 15:58:56.633771 (MainThread): Writing injected SQL for node "operation.my_new_project.my_new_project-on-run-start-0"
2021-10-05 15:58:56.645337 (MainThread): 15:58:56 | 1 of 1 START hook: my_new_project.on-run-start.0..................... [RUN]
2021-10-05 15:58:56.646685 (MainThread): Using postgres connection "master".
2021-10-05 15:58:56.647814 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
dbt_practice/macros/luhn_check.sql
2021-10-05 15:58:56.649548 (MainThread): Postgres error: syntax error at or near "dbt_practice"
LINE 2: dbt_practice/macros/luhn_check.sql
        ^

2021-10-05 15:58:56.650671 (MainThread): Database error while running on-run-start
2021-10-05 15:58:56.651784 (MainThread): On master: Close
2021-10-05 15:58:56.653300 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:58:56.655360 (MainThread): Connection 'list_dellstore_public' was properly closed.
2021-10-05 15:58:56.656593 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b563f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b565ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b56ef670>]}
2021-10-05 15:58:56.657730 (MainThread): Flushing usage events
2021-10-05 15:58:57.261834 (MainThread): Encountered an error:
2021-10-05 15:58:57.264694 (MainThread): Database Error
  syntax error at or near "dbt_practice"
  LINE 2: dbt_practice/macros/luhn_check.sql
          ^
2021-10-05 15:58:57.270706 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "dbt_practice"
LINE 2: dbt_practice/macros/luhn_check.sql
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 411, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 351, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 333, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near "dbt_practice"
  LINE 2: dbt_practice/macros/luhn_check.sql
          ^

2021-10-05 15:59:15.633080 (MainThread): Running with dbt=0.19.0
2021-10-05 15:59:15.779269 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:59:15.784013 (MainThread): Tracking: tracking
2021-10-05 15:59:15.787944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf4d50910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf8356430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf4d61100>]}
2021-10-05 15:59:15.816894 (MainThread): Partial parsing not enabled
2021-10-05 15:59:15.821268 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 15:59:15.823852 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:59:15.857021 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:59:15.862111 (MainThread): Parsing macros/relations.sql
2021-10-05 15:59:15.865712 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:59:15.870471 (MainThread): Parsing macros/core.sql
2021-10-05 15:59:15.877320 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:59:15.891780 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:59:15.903251 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:59:15.935955 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:59:15.946389 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:59:15.954623 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:59:15.978304 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:59:15.988262 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:59:15.992261 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:59:16.017994 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:59:16.022032 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:59:16.075317 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:59:16.145917 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:59:16.149791 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:59:16.153499 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:59:16.156811 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:59:16.162018 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:59:16.165741 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:59:16.168304 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:59:16.171921 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:59:16.186476 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:59:16.191012 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:59:16.201812 (MainThread): Partial parsing not enabled
2021-10-05 15:59:16.245782 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:59:16.273145 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:59:16.297409 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:59:16.342511 (MainThread): Acquiring new postgres connection "operation.my_new_project.my_new_project-on-run-start-0".
2021-10-05 15:59:16.526932 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:59:16.537829 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '227d727f-5023-48e8-b6fc-9c28cb8f6b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf4b773d0>]}
2021-10-05 15:59:16.592330 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:59:16.594719 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 1 operation, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:59:16.597736 (MainThread): 
2021-10-05 15:59:16.599886 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:59:16.607134 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:59:16.619417 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:59:16.621192 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:59:16.622778 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:59:16.629000 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 15:59:16.633064 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:59:16.640898 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:59:16.648884 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:59:16.650673 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:59:16.652402 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:59:16.658016 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:59:16.659591 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:59:16.661078 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:59:16.664318 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:59:16.674570 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:59:16.676805 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:59:16.688209 (MainThread): Using postgres connection "master".
2021-10-05 15:59:16.689851 (MainThread): On master: BEGIN
2021-10-05 15:59:16.691025 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:59:16.696327 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:59:16.697717 (MainThread): Using postgres connection "master".
2021-10-05 15:59:16.698728 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:59:16.705020 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:59:16.706650 (MainThread): On master: ROLLBACK
2021-10-05 15:59:16.708373 (MainThread): Using postgres connection "master".
2021-10-05 15:59:16.709596 (MainThread): On master: BEGIN
2021-10-05 15:59:16.711485 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:59:16.712997 (MainThread): On master: COMMIT
2021-10-05 15:59:16.714217 (MainThread): Using postgres connection "master".
2021-10-05 15:59:16.715311 (MainThread): On master: COMMIT
2021-10-05 15:59:16.716836 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:59:16.718269 (MainThread): 15:59:16 | 
2021-10-05 15:59:16.719345 (MainThread): 15:59:16 | Running 1 on-run-start hook
2021-10-05 15:59:16.720796 (MainThread): Compiling operation.my_new_project.my_new_project-on-run-start-0
2021-10-05 15:59:16.732204 (MainThread): Writing injected SQL for node "operation.my_new_project.my_new_project-on-run-start-0"
2021-10-05 15:59:16.738847 (MainThread): 15:59:16 | 1 of 1 START hook: my_new_project.on-run-start.0..................... [RUN]
2021-10-05 15:59:16.740227 (MainThread): Using postgres connection "master".
2021-10-05 15:59:16.741829 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
/macros/luhn_check.sql
2021-10-05 15:59:16.743597 (MainThread): Postgres error: syntax error at or near "/"
LINE 2: /macros/luhn_check.sql
        ^

2021-10-05 15:59:16.744952 (MainThread): Database error while running on-run-start
2021-10-05 15:59:16.746292 (MainThread): On master: Close
2021-10-05 15:59:16.747954 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:59:16.749273 (MainThread): Connection 'list_dellstore_public' was properly closed.
2021-10-05 15:59:16.750499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf4cbd160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf4aa2a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf4ab0f40>]}
2021-10-05 15:59:16.751950 (MainThread): Flushing usage events
2021-10-05 15:59:17.322341 (MainThread): Encountered an error:
2021-10-05 15:59:17.325491 (MainThread): Database Error
  syntax error at or near "/"
  LINE 2: /macros/luhn_check.sql
          ^
2021-10-05 15:59:17.330067 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "/"
LINE 2: /macros/luhn_check.sql
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 411, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 351, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 333, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near "/"
  LINE 2: /macros/luhn_check.sql
          ^

2021-10-05 15:59:25.371242 (MainThread): Running with dbt=0.19.0
2021-10-05 15:59:25.518693 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:59:25.523630 (MainThread): Tracking: tracking
2021-10-05 15:59:25.527145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca09adde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca08036fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca08047130>]}
2021-10-05 15:59:25.556357 (MainThread): Partial parsing not enabled
2021-10-05 15:59:25.559884 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 15:59:25.562299 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:59:25.594784 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:59:25.600307 (MainThread): Parsing macros/relations.sql
2021-10-05 15:59:25.603809 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:59:25.609194 (MainThread): Parsing macros/core.sql
2021-10-05 15:59:25.616164 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:59:25.631085 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:59:25.642047 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:59:25.674764 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:59:25.685172 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:59:25.693264 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:59:25.716700 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:59:25.726477 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:59:25.730305 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:59:25.755847 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:59:25.759873 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:59:25.812367 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:59:25.883525 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:59:25.887875 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:59:25.892130 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:59:25.895842 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:59:25.901084 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:59:25.905375 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:59:25.908272 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:59:25.911973 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:59:25.928301 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:59:25.933061 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:59:25.944253 (MainThread): Partial parsing not enabled
2021-10-05 15:59:25.988648 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:59:26.015929 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:59:26.039963 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:59:26.085004 (MainThread): Acquiring new postgres connection "operation.my_new_project.my_new_project-on-run-start-0".
2021-10-05 15:59:26.262898 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:59:26.272198 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba871687-5675-4ff2-ac7b-a7613bb451bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca07e85ca0>]}
2021-10-05 15:59:26.324599 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:59:26.326906 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 1 operation, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:59:26.329373 (MainThread): 
2021-10-05 15:59:26.330837 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:59:26.335469 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:59:26.347633 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:59:26.349314 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:59:26.350794 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:59:26.357000 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 15:59:26.361510 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:59:26.369174 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:59:26.376999 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:59:26.378282 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:59:26.379569 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:59:26.384911 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:59:26.386178 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:59:26.387375 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:59:26.390540 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:59:26.400315 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:59:26.401793 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:59:26.416757 (MainThread): Using postgres connection "master".
2021-10-05 15:59:26.418593 (MainThread): On master: BEGIN
2021-10-05 15:59:26.420039 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:59:26.425841 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:59:26.427388 (MainThread): Using postgres connection "master".
2021-10-05 15:59:26.429076 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:59:26.435885 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:59:26.437598 (MainThread): On master: ROLLBACK
2021-10-05 15:59:26.439301 (MainThread): Using postgres connection "master".
2021-10-05 15:59:26.440621 (MainThread): On master: BEGIN
2021-10-05 15:59:26.442714 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:59:26.444022 (MainThread): On master: COMMIT
2021-10-05 15:59:26.445426 (MainThread): Using postgres connection "master".
2021-10-05 15:59:26.446765 (MainThread): On master: COMMIT
2021-10-05 15:59:26.448456 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:59:26.449894 (MainThread): 15:59:26 | 
2021-10-05 15:59:26.451426 (MainThread): 15:59:26 | Running 1 on-run-start hook
2021-10-05 15:59:26.452963 (MainThread): Compiling operation.my_new_project.my_new_project-on-run-start-0
2021-10-05 15:59:26.465234 (MainThread): Writing injected SQL for node "operation.my_new_project.my_new_project-on-run-start-0"
2021-10-05 15:59:26.472080 (MainThread): 15:59:26 | 1 of 1 START hook: my_new_project.on-run-start.0..................... [RUN]
2021-10-05 15:59:26.473774 (MainThread): Using postgres connection "master".
2021-10-05 15:59:26.475332 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
macros/luhn_check.sql
2021-10-05 15:59:26.477431 (MainThread): Postgres error: syntax error at or near "macros"
LINE 2: macros/luhn_check.sql
        ^

2021-10-05 15:59:26.478906 (MainThread): Database error while running on-run-start
2021-10-05 15:59:26.480221 (MainThread): On master: Close
2021-10-05 15:59:26.481994 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:59:26.483293 (MainThread): Connection 'list_dellstore_public' was properly closed.
2021-10-05 15:59:26.484724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca07d6b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca07d87430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca07e24af0>]}
2021-10-05 15:59:26.486196 (MainThread): Flushing usage events
2021-10-05 15:59:27.039160 (MainThread): Encountered an error:
2021-10-05 15:59:27.042705 (MainThread): Database Error
  syntax error at or near "macros"
  LINE 2: macros/luhn_check.sql
          ^
2021-10-05 15:59:27.046583 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "macros"
LINE 2: macros/luhn_check.sql
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 411, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 351, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 333, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near "macros"
  LINE 2: macros/luhn_check.sql
          ^

2021-10-05 15:59:42.783206 (MainThread): Running with dbt=0.19.0
2021-10-05 15:59:42.927554 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 15:59:42.932390 (MainThread): Tracking: tracking
2021-10-05 15:59:42.936061 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b40b1fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b44126400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b40b320d0>]}
2021-10-05 15:59:42.963514 (MainThread): Partial parsing not enabled
2021-10-05 15:59:42.966404 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 15:59:42.968854 (MainThread): Parsing macros/adapters.sql
2021-10-05 15:59:43.001243 (MainThread): Parsing macros/catalog.sql
2021-10-05 15:59:43.006133 (MainThread): Parsing macros/relations.sql
2021-10-05 15:59:43.009507 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 15:59:43.014312 (MainThread): Parsing macros/core.sql
2021-10-05 15:59:43.020945 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 15:59:43.035425 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 15:59:43.046948 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 15:59:43.079465 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 15:59:43.089976 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 15:59:43.098019 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 15:59:43.121375 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 15:59:43.131102 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 15:59:43.134935 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 15:59:43.160719 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 15:59:43.164749 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 15:59:43.217390 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 15:59:43.288155 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 15:59:43.292328 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 15:59:43.296439 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 15:59:43.299727 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 15:59:43.304687 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 15:59:43.309070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 15:59:43.311872 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 15:59:43.315262 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 15:59:43.329939 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 15:59:43.334111 (MainThread): Parsing macros/etc/query.sql
2021-10-05 15:59:43.344822 (MainThread): Partial parsing not enabled
2021-10-05 15:59:43.389014 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 15:59:43.416315 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 15:59:43.440072 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 15:59:43.484743 (MainThread): Acquiring new postgres connection "operation.my_new_project.my_new_project-on-run-start-0".
2021-10-05 15:59:43.663607 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 15:59:43.673709 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cde591d9-af88-48d2-86c7-38e16a27e699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b40952d60>]}
2021-10-05 15:59:43.727487 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 15:59:43.729737 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 1 operation, 0 seed files, 9 sources, 0 exposures
2021-10-05 15:59:43.732004 (MainThread): 
2021-10-05 15:59:43.733426 (MainThread): Acquiring new postgres connection "master".
2021-10-05 15:59:43.737838 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 15:59:43.749759 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 15:59:43.751317 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 15:59:43.752749 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 15:59:43.759040 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 15:59:43.762569 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 15:59:43.769896 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 15:59:43.777541 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:59:43.779001 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 15:59:43.780392 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 15:59:43.786199 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:59:43.787508 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 15:59:43.788548 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 15:59:43.791560 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 15:59:43.800976 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 15:59:43.802896 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 15:59:43.813983 (MainThread): Using postgres connection "master".
2021-10-05 15:59:43.816063 (MainThread): On master: BEGIN
2021-10-05 15:59:43.817293 (MainThread): Opening a new connection, currently in state init
2021-10-05 15:59:43.822545 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 15:59:43.823899 (MainThread): Using postgres connection "master".
2021-10-05 15:59:43.825074 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 15:59:43.830965 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 15:59:43.832477 (MainThread): On master: ROLLBACK
2021-10-05 15:59:43.834356 (MainThread): Using postgres connection "master".
2021-10-05 15:59:43.835819 (MainThread): On master: BEGIN
2021-10-05 15:59:43.837879 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 15:59:43.839369 (MainThread): On master: COMMIT
2021-10-05 15:59:43.840750 (MainThread): Using postgres connection "master".
2021-10-05 15:59:43.841897 (MainThread): On master: COMMIT
2021-10-05 15:59:43.843540 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 15:59:43.844813 (MainThread): 15:59:43 | 
2021-10-05 15:59:43.845995 (MainThread): 15:59:43 | Running 1 on-run-start hook
2021-10-05 15:59:43.847600 (MainThread): Compiling operation.my_new_project.my_new_project-on-run-start-0
2021-10-05 15:59:43.859434 (MainThread): Writing injected SQL for node "operation.my_new_project.my_new_project-on-run-start-0"
2021-10-05 15:59:43.865231 (MainThread): 15:59:43 | 1 of 1 START hook: my_new_project.on-run-start.0..................... [RUN]
2021-10-05 15:59:43.866948 (MainThread): Using postgres connection "master".
2021-10-05 15:59:43.868486 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
luhn_check.sql
2021-10-05 15:59:43.870603 (MainThread): Postgres error: syntax error at or near "luhn_check"
LINE 2: luhn_check.sql
        ^

2021-10-05 15:59:43.873057 (MainThread): Database error while running on-run-start
2021-10-05 15:59:43.874711 (MainThread): On master: Close
2021-10-05 15:59:43.876581 (MainThread): Connection 'master' was properly closed.
2021-10-05 15:59:43.878851 (MainThread): Connection 'list_dellstore_public' was properly closed.
2021-10-05 15:59:43.880084 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b40852f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b40872a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b40904b50>]}
2021-10-05 15:59:43.881476 (MainThread): Flushing usage events
2021-10-05 15:59:44.441626 (MainThread): Encountered an error:
2021-10-05 15:59:44.445069 (MainThread): Database Error
  syntax error at or near "luhn_check"
  LINE 2: luhn_check.sql
          ^
2021-10-05 15:59:44.448923 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "luhn_check"
LINE 2: luhn_check.sql
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 411, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 351, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 333, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near "luhn_check"
  LINE 2: luhn_check.sql
          ^

2021-10-05 16:00:04.301143 (MainThread): Running with dbt=0.19.0
2021-10-05 16:00:04.452567 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 16:00:04.459374 (MainThread): Tracking: tracking
2021-10-05 16:00:04.463600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af702d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af8ad82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af703e190>]}
2021-10-05 16:00:04.492201 (MainThread): Partial parsing not enabled
2021-10-05 16:00:04.495298 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 16:00:04.497566 (MainThread): Parsing macros/adapters.sql
2021-10-05 16:00:04.529831 (MainThread): Parsing macros/catalog.sql
2021-10-05 16:00:04.534755 (MainThread): Parsing macros/relations.sql
2021-10-05 16:00:04.538297 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 16:00:04.542767 (MainThread): Parsing macros/core.sql
2021-10-05 16:00:04.549263 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 16:00:04.563327 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 16:00:04.574446 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 16:00:04.610215 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 16:00:04.621379 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 16:00:04.629868 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 16:00:04.654594 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 16:00:04.664557 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 16:00:04.668458 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 16:00:04.694458 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 16:00:04.698354 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 16:00:04.750614 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 16:00:04.821420 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 16:00:04.825394 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 16:00:04.829004 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 16:00:04.832041 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 16:00:04.837180 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 16:00:04.840515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 16:00:04.842903 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 16:00:04.846500 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 16:00:04.861014 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 16:00:04.865113 (MainThread): Parsing macros/etc/query.sql
2021-10-05 16:00:04.876234 (MainThread): Partial parsing not enabled
2021-10-05 16:00:04.920766 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:00:04.948086 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:00:04.972253 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 16:00:05.017308 (MainThread): Acquiring new postgres connection "operation.my_new_project.my_new_project-on-run-start-0".
2021-10-05 16:00:05.194714 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 16:00:05.204285 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da5d8a3c-f670-4d1f-bd0b-23969fc3a96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af6e692b0>]}
2021-10-05 16:00:05.256425 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 16:00:05.259249 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 1 operation, 0 seed files, 9 sources, 0 exposures
2021-10-05 16:00:05.261770 (MainThread): 
2021-10-05 16:00:05.263431 (MainThread): Acquiring new postgres connection "master".
2021-10-05 16:00:05.267835 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 16:00:05.279522 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 16:00:05.281118 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 16:00:05.282349 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 16:00:05.288504 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 16:00:05.292247 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 16:00:05.300760 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 16:00:05.308917 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 16:00:05.310251 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 16:00:05.311765 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 16:00:05.316820 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 16:00:05.318089 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 16:00:05.319181 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 16:00:05.322449 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 16:00:05.332111 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 16:00:05.333847 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 16:00:05.345046 (MainThread): Using postgres connection "master".
2021-10-05 16:00:05.346603 (MainThread): On master: BEGIN
2021-10-05 16:00:05.347888 (MainThread): Opening a new connection, currently in state init
2021-10-05 16:00:05.353111 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 16:00:05.354517 (MainThread): Using postgres connection "master".
2021-10-05 16:00:05.355821 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 16:00:05.362388 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 16:00:05.363945 (MainThread): On master: ROLLBACK
2021-10-05 16:00:05.365522 (MainThread): Using postgres connection "master".
2021-10-05 16:00:05.366802 (MainThread): On master: BEGIN
2021-10-05 16:00:05.368650 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 16:00:05.370101 (MainThread): On master: COMMIT
2021-10-05 16:00:05.371416 (MainThread): Using postgres connection "master".
2021-10-05 16:00:05.372623 (MainThread): On master: COMMIT
2021-10-05 16:00:05.374166 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 16:00:05.375398 (MainThread): 16:00:05 | 
2021-10-05 16:00:05.376669 (MainThread): 16:00:05 | Running 1 on-run-start hook
2021-10-05 16:00:05.378197 (MainThread): Compiling operation.my_new_project.my_new_project-on-run-start-0
2021-10-05 16:00:05.389960 (MainThread): Writing injected SQL for node "operation.my_new_project.my_new_project-on-run-start-0"
2021-10-05 16:00:05.395419 (MainThread): 16:00:05 | 1 of 1 START hook: my_new_project.on-run-start.0..................... [RUN]
2021-10-05 16:00:05.396762 (MainThread): Using postgres connection "master".
2021-10-05 16:00:05.398133 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
luhn_check.sql
2021-10-05 16:00:05.399618 (MainThread): Postgres error: syntax error at or near "luhn_check"
LINE 2: luhn_check.sql
        ^

2021-10-05 16:00:05.400904 (MainThread): Database error while running on-run-start
2021-10-05 16:00:05.402197 (MainThread): On master: Close
2021-10-05 16:00:05.404971 (MainThread): Connection 'master' was properly closed.
2021-10-05 16:00:05.406635 (MainThread): Connection 'list_dellstore_public' was properly closed.
2021-10-05 16:00:05.408291 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af6ff8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af6d8be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af6d680d0>]}
2021-10-05 16:00:05.409806 (MainThread): Flushing usage events
2021-10-05 16:00:06.119557 (MainThread): Encountered an error:
2021-10-05 16:00:06.123422 (MainThread): Database Error
  syntax error at or near "luhn_check"
  LINE 2: luhn_check.sql
          ^
2021-10-05 16:00:06.127801 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "luhn_check"
LINE 2: luhn_check.sql
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 411, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 351, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 333, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near "luhn_check"
  LINE 2: luhn_check.sql
          ^

2021-10-05 16:02:05.623758 (MainThread): Running with dbt=0.19.0
2021-10-05 16:02:05.775488 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='{luhn_check}', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-05 16:02:05.781313 (MainThread): Tracking: tracking
2021-10-05 16:02:05.785085 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96582b2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659d59d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96582c3490>]}
2021-10-05 16:02:05.812770 (MainThread): Partial parsing not enabled
2021-10-05 16:02:05.815770 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 16:02:05.818227 (MainThread): Parsing macros/adapters.sql
2021-10-05 16:02:05.850151 (MainThread): Parsing macros/catalog.sql
2021-10-05 16:02:05.855012 (MainThread): Parsing macros/relations.sql
2021-10-05 16:02:05.858395 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 16:02:05.863171 (MainThread): Parsing macros/core.sql
2021-10-05 16:02:05.869607 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 16:02:05.883612 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 16:02:05.894408 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 16:02:05.926921 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 16:02:05.938084 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 16:02:05.946228 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 16:02:05.969987 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 16:02:05.979829 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 16:02:05.983657 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 16:02:06.009321 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 16:02:06.013060 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 16:02:06.065293 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 16:02:06.135676 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 16:02:06.139264 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 16:02:06.143066 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 16:02:06.146375 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 16:02:06.151323 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 16:02:06.154878 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 16:02:06.157313 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 16:02:06.160518 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 16:02:06.174484 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 16:02:06.178431 (MainThread): Parsing macros/etc/query.sql
2021-10-05 16:02:06.189082 (MainThread): Partial parsing not enabled
2021-10-05 16:02:06.233244 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:02:06.260681 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:02:06.284713 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 16:02:06.329338 (MainThread): Acquiring new postgres connection "operation.my_new_project.my_new_project-on-run-start-0".
2021-10-05 16:02:06.507620 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 16:02:06.517427 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cea0d344-2d60-469c-b43c-e84ad43faabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96580d1100>]}
2021-10-05 16:02:06.561958 (MainThread): Acquiring new postgres connection "macro_{luhn_check}".
2021-10-05 16:02:06.563724 (MainThread): Using postgres connection "macro_{luhn_check}".
2021-10-05 16:02:06.564949 (MainThread): On macro_{luhn_check}: BEGIN
2021-10-05 16:02:06.566263 (MainThread): Opening a new connection, currently in state init
2021-10-05 16:02:06.573943 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 16:02:06.575297 (MainThread): On macro_{luhn_check}: COMMIT
2021-10-05 16:02:06.576566 (MainThread): Using postgres connection "macro_{luhn_check}".
2021-10-05 16:02:06.577773 (MainThread): On macro_{luhn_check}: COMMIT
2021-10-05 16:02:06.579178 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 16:02:06.580446 (MainThread): On macro_{luhn_check}: Close
2021-10-05 16:02:06.582067 (MainThread): Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "{luhn_check}" in any package
2021-10-05 16:02:06.583408 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 984, in execute_macro
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  dbt could not find a macro with the name "{luhn_check}" in any package
2021-10-05 16:02:06.585803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96582b2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965810e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965810eca0>]}
2021-10-05 16:02:06.587649 (MainThread): Flushing usage events
2021-10-05 16:02:07.190116 (MainThread): Connection 'macro_{luhn_check}' was properly closed.
2021-10-05 16:02:16.612766 (MainThread): Running with dbt=0.19.0
2021-10-05 16:02:16.757498 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_check', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-05 16:02:16.762267 (MainThread): Tracking: tracking
2021-10-05 16:02:16.765540 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d98058c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d99b00e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d9806a370>]}
2021-10-05 16:02:16.791881 (MainThread): Partial parsing not enabled
2021-10-05 16:02:16.794722 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 16:02:16.796819 (MainThread): Parsing macros/adapters.sql
2021-10-05 16:02:16.829307 (MainThread): Parsing macros/catalog.sql
2021-10-05 16:02:16.834215 (MainThread): Parsing macros/relations.sql
2021-10-05 16:02:16.837694 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 16:02:16.842101 (MainThread): Parsing macros/core.sql
2021-10-05 16:02:16.848641 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 16:02:16.863086 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 16:02:16.873889 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 16:02:16.906335 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 16:02:16.916760 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 16:02:16.924767 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 16:02:16.947925 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 16:02:16.957919 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 16:02:16.961758 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 16:02:16.987950 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 16:02:16.992070 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 16:02:17.045132 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 16:02:17.116357 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 16:02:17.119859 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 16:02:17.123686 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 16:02:17.126779 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 16:02:17.131659 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 16:02:17.135247 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 16:02:17.137921 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 16:02:17.141335 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 16:02:17.155882 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 16:02:17.159936 (MainThread): Parsing macros/etc/query.sql
2021-10-05 16:02:17.171827 (MainThread): Partial parsing not enabled
2021-10-05 16:02:17.215917 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:02:17.243735 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:02:17.268515 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 16:02:17.313373 (MainThread): Acquiring new postgres connection "operation.my_new_project.my_new_project-on-run-start-0".
2021-10-05 16:02:17.498932 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 16:02:17.508465 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dac2d8a-a117-4a21-a36a-7c221c20cba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d97ea6d00>]}
2021-10-05 16:02:17.553419 (MainThread): Acquiring new postgres connection "macro_luhn_check".
2021-10-05 16:02:17.554932 (MainThread): Using postgres connection "macro_luhn_check".
2021-10-05 16:02:17.556336 (MainThread): On macro_luhn_check: BEGIN
2021-10-05 16:02:17.557568 (MainThread): Opening a new connection, currently in state init
2021-10-05 16:02:17.563925 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 16:02:17.565707 (MainThread): On macro_luhn_check: COMMIT
2021-10-05 16:02:17.567220 (MainThread): Using postgres connection "macro_luhn_check".
2021-10-05 16:02:17.568431 (MainThread): On macro_luhn_check: COMMIT
2021-10-05 16:02:17.570100 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 16:02:17.571796 (MainThread): On macro_luhn_check: Close
2021-10-05 16:02:17.573469 (MainThread): Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "luhn_check" in any package
2021-10-05 16:02:17.574958 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 984, in execute_macro
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  dbt could not find a macro with the name "luhn_check" in any package
2021-10-05 16:02:17.577181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d98058c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d97e452e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d97e45e80>]}
2021-10-05 16:02:17.578665 (MainThread): Flushing usage events
2021-10-05 16:02:18.130286 (MainThread): Connection 'macro_luhn_check' was properly closed.
2021-10-05 16:05:15.929855 (MainThread): Running with dbt=0.19.0
2021-10-05 16:05:16.069660 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_check', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-05 16:05:16.076384 (MainThread): Tracking: tracking
2021-10-05 16:05:16.080155 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42061a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4207c51d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42061bb220>]}
2021-10-05 16:05:16.109280 (MainThread): Partial parsing not enabled
2021-10-05 16:05:16.112569 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 16:05:16.115696 (MainThread): Parsing macros/adapters.sql
2021-10-05 16:05:16.147632 (MainThread): Parsing macros/catalog.sql
2021-10-05 16:05:16.152990 (MainThread): Parsing macros/relations.sql
2021-10-05 16:05:16.156525 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 16:05:16.161291 (MainThread): Parsing macros/core.sql
2021-10-05 16:05:16.168019 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 16:05:16.182454 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 16:05:16.193454 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 16:05:16.226459 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 16:05:16.236950 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 16:05:16.244989 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 16:05:16.267999 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 16:05:16.277788 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 16:05:16.281277 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 16:05:16.307141 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 16:05:16.311137 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 16:05:16.363988 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 16:05:16.435336 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 16:05:16.439303 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 16:05:16.443124 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 16:05:16.446452 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 16:05:16.451532 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 16:05:16.454875 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 16:05:16.457428 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 16:05:16.461056 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 16:05:16.475437 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 16:05:16.479513 (MainThread): Parsing macros/etc/query.sql
2021-10-05 16:05:16.490398 (MainThread): Partial parsing not enabled
2021-10-05 16:05:16.539220 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:05:16.567551 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:16.592593 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 16:05:16.800181 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 16:05:16.808672 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c1a7161-b8ec-4717-804c-228a7af4424b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4205fdbbb0>]}
2021-10-05 16:05:16.850950 (MainThread): Acquiring new postgres connection "macro_luhn_check".
2021-10-05 16:05:16.852707 (MainThread): Using postgres connection "macro_luhn_check".
2021-10-05 16:05:16.854103 (MainThread): On macro_luhn_check: BEGIN
2021-10-05 16:05:16.855734 (MainThread): Opening a new connection, currently in state init
2021-10-05 16:05:16.861854 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 16:05:16.863533 (MainThread): On macro_luhn_check: COMMIT
2021-10-05 16:05:16.864969 (MainThread): Using postgres connection "macro_luhn_check".
2021-10-05 16:05:16.866442 (MainThread): On macro_luhn_check: COMMIT
2021-10-05 16:05:16.868136 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 16:05:16.869690 (MainThread): On macro_luhn_check: Close
2021-10-05 16:05:16.871284 (MainThread): Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "luhn_check" in any package
2021-10-05 16:05:16.873316 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 984, in execute_macro
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  dbt could not find a macro with the name "luhn_check" in any package
2021-10-05 16:05:16.876279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42060b4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42060b40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42060be400>]}
2021-10-05 16:05:16.877998 (MainThread): Flushing usage events
2021-10-05 16:05:17.459515 (MainThread): Connection 'macro_luhn_check' was properly closed.
2021-10-05 16:05:21.494897 (MainThread): Running with dbt=0.19.0
2021-10-05 16:05:21.640202 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 16:05:21.645234 (MainThread): Tracking: tracking
2021-10-05 16:05:21.648962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329729efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329a8a33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32972ae070>]}
2021-10-05 16:05:21.676328 (MainThread): Partial parsing not enabled
2021-10-05 16:05:21.679783 (MainThread): Parsing macros/luhn_check.sql
2021-10-05 16:05:21.682195 (MainThread): Parsing macros/adapters.sql
2021-10-05 16:05:21.714885 (MainThread): Parsing macros/catalog.sql
2021-10-05 16:05:21.719871 (MainThread): Parsing macros/relations.sql
2021-10-05 16:05:21.723325 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 16:05:21.728116 (MainThread): Parsing macros/core.sql
2021-10-05 16:05:21.734882 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 16:05:21.749359 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 16:05:21.760418 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 16:05:21.793176 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 16:05:21.803998 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 16:05:21.812068 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 16:05:21.835624 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 16:05:21.845691 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 16:05:21.849335 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 16:05:21.875299 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 16:05:21.878925 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 16:05:21.931790 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 16:05:22.005134 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 16:05:22.009174 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 16:05:22.013250 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 16:05:22.017542 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 16:05:22.022756 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 16:05:22.026139 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 16:05:22.028752 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 16:05:22.032130 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 16:05:22.047180 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 16:05:22.051176 (MainThread): Parsing macros/etc/query.sql
2021-10-05 16:05:22.062011 (MainThread): Partial parsing not enabled
2021-10-05 16:05:22.105769 (MainThread): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:05:22.132788 (MainThread): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.158019 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.first_name_count_price_snapshot".
2021-10-05 16:05:22.369573 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 16:05:22.378875 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db32bced-6f9e-469f-a015-3f6c526ab2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32970ece20>]}
2021-10-05 16:05:22.430424 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 16:05:22.433081 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 9 sources, 0 exposures
2021-10-05 16:05:22.435280 (MainThread): 
2021-10-05 16:05:22.436802 (MainThread): Acquiring new postgres connection "master".
2021-10-05 16:05:22.441422 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 16:05:22.453558 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 16:05:22.455374 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 16:05:22.456506 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 16:05:22.462939 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 16:05:22.466581 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 16:05:22.472631 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 16:05:22.480463 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 16:05:22.482064 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 16:05:22.483384 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 16:05:22.488633 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 16:05:22.489809 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 16:05:22.490929 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 16:05:22.494176 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 16:05:22.503966 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 16:05:22.506525 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 16:05:22.516515 (MainThread): Using postgres connection "master".
2021-10-05 16:05:22.518408 (MainThread): On master: BEGIN
2021-10-05 16:05:22.519744 (MainThread): Opening a new connection, currently in state init
2021-10-05 16:05:22.524813 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 16:05:22.526186 (MainThread): Using postgres connection "master".
2021-10-05 16:05:22.527355 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 16:05:22.533185 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 16:05:22.534730 (MainThread): On master: ROLLBACK
2021-10-05 16:05:22.536385 (MainThread): Using postgres connection "master".
2021-10-05 16:05:22.537791 (MainThread): On master: BEGIN
2021-10-05 16:05:22.539877 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 16:05:22.541082 (MainThread): On master: COMMIT
2021-10-05 16:05:22.542381 (MainThread): Using postgres connection "master".
2021-10-05 16:05:22.543543 (MainThread): On master: COMMIT
2021-10-05 16:05:22.545000 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 16:05:22.546085 (MainThread): On master: Close
2021-10-05 16:05:22.547490 (MainThread): 16:05:22 | Concurrency: 2 threads (target='dev')
2021-10-05 16:05:22.549439 (MainThread): 16:05:22 | 
2021-10-05 16:05:22.553506 (Thread-1): Began running node model.my_new_project.daily_losses
2021-10-05 16:05:22.553786 (Thread-2): Began running node model.my_new_project.first_name_count_price
2021-10-05 16:05:22.556202 (Thread-1): 16:05:22 | 1 of 2 START table model public.daily_losses......................... [RUN]
2021-10-05 16:05:22.559474 (Thread-2): 16:05:22 | 2 of 2 START table model public.first_name_count_price............... [RUN]
2021-10-05 16:05:22.561042 (Thread-1): Acquiring new postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:05:22.562658 (Thread-2): Acquiring new postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.563961 (Thread-1): Compiling model.my_new_project.daily_losses
2021-10-05 16:05:22.565238 (Thread-2): Compiling model.my_new_project.first_name_count_price
2021-10-05 16:05:22.581492 (Thread-1): Writing injected SQL for node "model.my_new_project.daily_losses"
2021-10-05 16:05:22.590259 (Thread-2): Writing injected SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 16:05:22.594990 (Thread-2): finished collecting timing info
2021-10-05 16:05:22.595299 (Thread-1): finished collecting timing info
2021-10-05 16:05:22.631708 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.642547 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:05:22.642798 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_tmp" cascade
2021-10-05 16:05:22.645427 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */
drop table if exists "dellstore"."public"."daily_losses__dbt_tmp" cascade
2021-10-05 16:05:22.646823 (Thread-2): Opening a new connection, currently in state init
2021-10-05 16:05:22.648976 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 16:05:22.655240 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 16:05:22.655823 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 16:05:22.659014 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.662467 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:05:22.663853 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 16:05:22.665191 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */
drop table if exists "dellstore"."public"."daily_losses__dbt_backup" cascade
2021-10-05 16:05:22.667174 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 16:05:22.668333 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 16:05:22.680179 (Thread-2): Writing runtime SQL for node "model.my_new_project.first_name_count_price"
2021-10-05 16:05:22.682179 (Thread-1): Writing runtime SQL for node "model.my_new_project.daily_losses"
2021-10-05 16:05:22.686483 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.687283 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:05:22.688059 (Thread-2): On model.my_new_project.first_name_count_price: BEGIN
2021-10-05 16:05:22.689316 (Thread-1): On model.my_new_project.daily_losses: BEGIN
2021-10-05 16:05:22.691271 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-05 16:05:22.692256 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 16:05:22.693103 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.694170 (Thread-1): Using postgres connection "model.my_new_project.daily_losses".
2021-10-05 16:05:22.696539 (Thread-1): On model.my_new_project.daily_losses: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.daily_losses"} */


  create  table "dellstore"."public"."daily_losses__dbt_tmp"
  as (
    

SELECT orderdate, sum(netamount) from (select customerid, creditcard
from customers WHERE 

CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits;

$$ LANGUAGE sql
IMMUTABLE
STRICT;

 cust
JOIN (select customerid,orderdate, netamount from orders) ord
ON cust.customerid = ord.customerid
GROUP BY orderdate
  );
2021-10-05 16:05:22.695296 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */


  create  table "dellstore"."public"."first_name_count_price__dbt_tmp"
  as (
    

select substring(actor, 1, strpos(actor, ' ')) as firstname, sum(price), count(*) no_of_movies FROM "dellstore"."public"."products" GROUP BY firstname
  );
2021-10-05 16:05:22.698666 (Thread-1): Postgres error: syntax error at or near "CREATE"
LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
         ^

2021-10-05 16:05:22.701496 (Thread-1): On model.my_new_project.daily_losses: ROLLBACK
2021-10-05 16:05:22.703028 (Thread-1): finished collecting timing info
2021-10-05 16:05:22.705496 (Thread-1): On model.my_new_project.daily_losses: Close
2021-10-05 16:05:22.706819 (Thread-1): Database Error in model daily_losses (models/daily_losses.sql)
  syntax error at or near "CREATE"
  LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
           ^
  compiled SQL at target/run/my_new_project/models/daily_losses.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model daily_losses (models/daily_losses.sql)
  syntax error at or near "CREATE"
  LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
           ^
  compiled SQL at target/run/my_new_project/models/daily_losses.sql
2021-10-05 16:05:22.710365 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db32bced-6f9e-469f-a015-3f6c526ab2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329703cc40>]}
2021-10-05 16:05:22.710586 (Thread-2): SQL status: SELECT 200 in 0.01 seconds
2021-10-05 16:05:22.713118 (Thread-1): 16:05:22 | 1 of 2 ERROR creating table model public.daily_losses................ [ERROR in 0.15s]
2021-10-05 16:05:22.722591 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.723374 (Thread-1): Finished running node model.my_new_project.daily_losses
2021-10-05 16:05:22.724882 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price" rename to "first_name_count_price__dbt_backup"
2021-10-05 16:05:22.728698 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 16:05:22.732292 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.733586 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
alter table "dellstore"."public"."first_name_count_price__dbt_tmp" rename to "first_name_count_price"
2021-10-05 16:05:22.735242 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 16:05:22.743410 (Thread-2): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 16:05:22.744911 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.746333 (Thread-2): On model.my_new_project.first_name_count_price: COMMIT
2021-10-05 16:05:22.748987 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-05 16:05:22.754123 (Thread-2): Using postgres connection "model.my_new_project.first_name_count_price".
2021-10-05 16:05:22.755671 (Thread-2): On model.my_new_project.first_name_count_price: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_name_count_price"} */
drop table if exists "dellstore"."public"."first_name_count_price__dbt_backup" cascade
2021-10-05 16:05:22.759089 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 16:05:22.762810 (Thread-2): finished collecting timing info
2021-10-05 16:05:22.764179 (Thread-2): On model.my_new_project.first_name_count_price: Close
2021-10-05 16:05:22.766390 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db32bced-6f9e-469f-a015-3f6c526ab2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3297152d60>]}
2021-10-05 16:05:22.768711 (Thread-2): 16:05:22 | 2 of 2 OK created table model public.first_name_count_price.......... [SELECT 200 in 0.20s]
2021-10-05 16:05:22.769846 (Thread-2): Finished running node model.my_new_project.first_name_count_price
2021-10-05 16:05:22.772786 (MainThread): Acquiring new postgres connection "master".
2021-10-05 16:05:22.774029 (MainThread): Using postgres connection "master".
2021-10-05 16:05:22.775001 (MainThread): On master: BEGIN
2021-10-05 16:05:22.776029 (MainThread): Opening a new connection, currently in state closed
2021-10-05 16:05:22.780778 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 16:05:22.782666 (MainThread): On master: COMMIT
2021-10-05 16:05:22.783792 (MainThread): Using postgres connection "master".
2021-10-05 16:05:22.784996 (MainThread): On master: COMMIT
2021-10-05 16:05:22.786408 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 16:05:22.787659 (MainThread): On master: Close
2021-10-05 16:05:22.789214 (MainThread): 16:05:22 | 
2021-10-05 16:05:22.790717 (MainThread): 16:05:22 | Finished running 2 table models in 0.35s.
2021-10-05 16:05:22.792239 (MainThread): Connection 'master' was properly closed.
2021-10-05 16:05:22.793537 (MainThread): Connection 'model.my_new_project.daily_losses' was properly closed.
2021-10-05 16:05:22.794681 (MainThread): Connection 'model.my_new_project.first_name_count_price' was properly closed.
2021-10-05 16:05:22.838802 (MainThread): 
2021-10-05 16:05:22.839947 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 16:05:22.841306 (MainThread): 
2021-10-05 16:05:22.842798 (MainThread): Database Error in model daily_losses (models/daily_losses.sql)
2021-10-05 16:05:22.844218 (MainThread):   syntax error at or near "CREATE"
2021-10-05 16:05:22.845900 (MainThread):   LINE 11: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
2021-10-05 16:05:22.847409 (MainThread):            ^
2021-10-05 16:05:22.848720 (MainThread):   compiled SQL at target/run/my_new_project/models/daily_losses.sql
2021-10-05 16:05:22.850025 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-05 16:05:22.851668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32947b0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329713de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32971924f0>]}
2021-10-05 16:05:22.853285 (MainThread): Flushing usage events
